<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2014-10-03T10:34:30+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    <email><![CDATA[leetschau@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Clojure Web Development]]></title>
    <link href="http://leetschau.github.io/blog/2014/10/02/005047/"/>
    <updated>2014-10-02T00:50:47+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/10/02/005047</id>
    <content type="html"><![CDATA[<h1>Paredit</h1>

<p><a href="http://www.emacswiki.org/ParEdit">ParEdit</a>, a.k.a. &ldquo;structured editing&rdquo;, is some special editing operations for S-expression coding, like Lisp or Clojure. Mainstream IDEs all have support for paredit.</p>

<h2>Eclipse</h2>

<p>Install clojure IDE plugin <a href="https://code.google.com/p/counterclockwise/">counterclockwise</a>. It&rsquo;s default shortcuts is listed in <a href="http://doc.ccw-ide.org/keyboard-shortcuts.html">Editor Keyboard Shortcuts</a>;</p>

<h2>Cursive</h2>

<ul>
<li>Cursive: install IntelliJ and Cursive plugin, see default shortcuts definition at <a href="https://cursiveclojure.com/userguide/paredit.html">Structural editing</a>;</li>
</ul>


<h1>REPL for Ring Application</h1>

<p>Say the application name is &ldquo;guestbook&rdquo; (based on &ldquo;Web Development with Clojure&rdquo; by Dmitri Sotnikov).</p>

<h2>Eclipse</h2>

<p>The counterclockwise plugin need to be installed beforehand.</p>

<ol>
<li><p>Build a new &ldquo;Clojure Project&rdquo; with name &ldquo;guestbook&rdquo;, set &ldquo;Leiningen template&rdquo; as &ldquo;compojure-app&rdquo;;</p></li>
<li><p>Open guestbook.routes.home.clj, and run menu item [Clojure -> Load file in REPL];</p></li>
<li><p>In REPL window (the window title is &ldquo;REPL @ nrepl://127.0.0.1:xxxx(guestbook.routes.home)&rdquo;, run (use &lsquo;guestbook.repl) and (start-server), you can use Ctrl+Up/Down to navigate in command history;</p></li>
<li><p>See homepage with url &ldquo;<a href="http://localhost:8080">http://localhost:8080</a>&rdquo;;</p></li>
<li><p>Modify codes, refresh web page to see the result. If this doesn&rsquo;t work, close the REPL window and restart server;</p></li>
</ol>


<h2>Cursive</h2>

<ol>
<li><p>In terminal: <code>lein new compojure-app mybook</code>;</p></li>
<li><p>In Cursive, import &ldquo;mybook&rdquo; via &ldquo;Import Project&rdquo;, choose &ldquo;Leiningen&rdquo; for &ldquo;Import project from external model&rdquo;;</p></li>
<li><p>Open &ldquo;Terminal&rdquo; window in Cursive, run <code>lein repl</code>, (use &lsquo;guestbook.repl) and (start-server);</p></li>
<li><p>See homepage with url &ldquo;<a href="http://localhost:8080">http://localhost:8080</a>&rdquo;;</p></li>
<li><p>Modify codes, refresh web page to see the result. If this doesn&rsquo;t work, restart server in &ldquo;Terminal&rdquo; window;</p></li>
</ol>


<p>Note: I&rsquo;ve tried <a href="http://www.lighttable.com/">Light Table</a>. It can open the guestbook project created by leiningen, but can&rsquo;t connect to it. So I give it up, and use Eclipse instead.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dmenu Notes]]></title>
    <link href="http://leetschau.github.io/blog/2014/10/01/210506/"/>
    <updated>2014-10-01T21:05:06+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/10/01/210506</id>
    <content type="html"><![CDATA[<ul>
<li>Add eclipse to dmenu path: <code>cd /usr/local/bin; sudo ln -s $HOME/apps/eclipse-java-luna-R-x86_64/eclipse eclipse</code>;</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Simple Ring Server]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/27/113819/"/>
    <updated>2014-09-27T11:38:19+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/27/113819</id>
    <content type="html"><![CDATA[<p>The simple web server is based on example 16-1 in &ldquo;Clojure Programming&rdquo; by Chas Emerick. I add it into a clojure project created by leiningen.</p>

<pre><code>$ lein new app ring-server
$ cd ring-server
// Add "[ring "1.0.0"]" into ":dependencies" of project.clj
$ vi src/ring-server/core.clj
$ cat src/ring-server/core.clj
(ns ring-server.core
  (:gen-class))

(use '[ring.adapter.jetty :only (run-jetty)])
(defn app
  [{:keys [uri query-string]}]
  {:body (format "You requested %s with query %s" uri query-string)})
(defn -main
  "this is a ring server"
  [port]
  (run-jetty #'app {:port (bigdec port) :join? false}))

$ lein run -m ring-server.core 8082
</code></pre>

<p>Now open <a href="http://localhost:8082/hello?at=china">http://localhost:8082/hello?at=china</a> in your browser, you can see &ldquo;You requested /hello with query at=china&rdquo;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Xen on CentOS 6]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/24/073009/"/>
    <updated>2014-09-24T07:30:09+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/24/073009</id>
    <content type="html"><![CDATA[<p>Ref: <a href="http://wiki.centos.org/HowTos/Xen/Xen4QuickStart">Xen4 CentOS6 QuickStart</a> &amp; <a href="http://wiki.centos.org/HowTos/Xen/Xen4QuickStart/Xen4Libvirt">Xen4 Libvirt for CentOS 6</a>.</p>

<h1>Build Xen Server</h1>

<p>The IP address of the Xen server (a Dell PC) is 10.32.1.112.
First install CentOS 6.4 via Minimal CD (or LiveDVD) and install Xen on the new OS;</p>

<pre><code>yum update
yum groupinstall Virtualization
yum install centos-release-xen   // unnecessary if install OS with LiveDVD
yum install xen bridge-utils
/usr/bin/grub-bootxen.sh
reboot
yum install libvirt python-virtinst libvirt-daemon-xen
yum install rsync wget vim-enhanced openssh-clients   // unnecessary if install OS with LiveDVD
reboot
uname -r  // the kernel should be 3.x
xm info
useradd -m chad
groupadd remote-libvirt
usermod -G remote-libvirt chad
cat &gt; /etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla &lt;&lt;EOF
[Remote libvirt SSH access]
Identity=unix-group:remote-libvirt
Action=org.libvirt.unix.manage
ResultAny=yes
ResultInactive=yes
ResultActive=yes
EOF
</code></pre>

<h2>Config network</h2>

<p>Modify dom0 host file /etc/xen/xend-config.sxp:</p>

<p>Comment out &ldquo;(network-script /bin/true)&rdquo; to &ldquo;(network-script &lsquo;network-bridge bridge=virbr0 netdev=eth0&rsquo;)&rdquo;.</p>

<h1>Build Xen Client</h1>

<p>We usually do not work on a Xen dom0 server. So here we install xen client on a Mint OS, and control Xen server with it:</p>

<h2>GUI Client</h2>

<p>First install with <code>sudo aptitude install virt-manager</code>, then run it with <code>virt-manager</code>. The &ldquo;Virtual Machine Manager&rdquo; window appears.</p>

<p>[Edit -> Connect Details -> Storage], Location: /var/lib/libvirt/images. So copy an OS image file (here it&rsquo;s CentOS-6.5-x86_64-minimal.iso) to this folder, and press the refresh button after &ldquo;Volumns&rdquo;, the ISO file appears.</p>

<p>Click &ldquo;New&rdquo; on toolbar, Name: Cloud21, check &ldquo;Local install media&rdquo; -> Use ISO image: /var/lib/libvirt/images/CentOS-6.5-x86_64-minimal.iso, OS type: Linux, Version: Red Hat Enterprise Linux 6 -> Memory: 1024 MB, CPUs: 1 -> Create a disk image &hellip;: 8.0 GB.</p>

<p>Now install CentOS with Minimal ISO file.</p>

<h2>Console Client</h2>

<pre><code>sudo aptitude install libvirt-bin
virsh -c xen+ssh://chad@10.32.1.112
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lightweight Web Browser Dwb]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/20/105816/"/>
    <updated>2014-09-20T10:58:16+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/20/105816</id>
    <content type="html"><![CDATA[<p>List all shortcuts: ga, then click &ldquo;Keys&rdquo;
Open homepage: ga
Open links of current page in current tab: f
Open links of current page in new tab: F
Open a url by input manually in current tab: o
Open a url by input manually in a new tab: O
Close tab: d
Save current page to bookmark: M
Show all Bookmarks: ga
Save current page to quickmark: m
Open quick mark: b
Zoom in: +
Zoom out: -
Yank web page title: yt
Yank web page url: yy
Go to next tab: J
Go to previous tab: K
Go to previous page (history): H
Go to next page: L
Insert text: i</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Set Time Synchronization on ArchLinux]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/20/103138/"/>
    <updated>2014-09-20T10:31:38+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/20/103138</id>
    <content type="html"><![CDATA[<p>Find out if current system time setup and services status is corrent: <code>timedatectl status</code>.
If not, run these commands as root to set correct timezne and sync time with Internet.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ln -s /usr/share/zoneinfo/Hongkong /etc/localtime
</span><span class='line'># hwclock --systohc --utc
</span><span class='line'># systemctl enable systemd-timesyncd.service
</span><span class='line'># systemctl start systemd-timesyncd.service </span></code></pre></td></tr></table></div></figure>


<p>Ref: <a href="https://wiki.archlinux.org/index.php/Time">Time - ArchWiki</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux From Scratch Notes]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/19/153017/"/>
    <updated>2014-09-19T15:30:17+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/19/153017</id>
    <content type="html"><![CDATA[<p>Linux from Scratch (LFS) version: 7.5.</p>

<p>Host: Dell PC, ArchLinux.</p>

<h1>Partition Scheme</h1>

<p>The host is GPT, so use <code>cgdisk</code> to create 2 new partitions (after 2 existing partitions): root 10GB, and swap 4GB.
When asked for partition type, input &ldquo;L&rdquo;, it will list all type code, where code of linux swap is 8200.
Reboot and build as root:</p>

<pre><code>mkfs.ext4 /dev/sda3
mkswap /dev/sda4
export LFS=/mnt/lfs
mkdir -pv $LFS
mount -v -t ext4 /dev/sda3 $LFS
swapon -v /dev/sda4
mkdir $LFS/sources
chmod -v a+wt $LFS/sources
mkdir -v $LFS/tools
groupadd lfs
useradd -s /bin/bash -g lfs -m -k /dev/null lfs
passwd lfs
chown -R lfs:lfs $LFS
chown -v lfs $LFS/tools
ln -sv $LFS/tools /
chown -v lfs $LFS/sources
su - lfs

cat &gt; ~/.bash_profile &lt;&lt; "EOF"
exec env -i HOME=$HOME TERM=$TERM PS1='\u:\w\$ ' /bin/bash
EOF
cat &gt; ~/.bashrc &lt;&lt; "EOF"
set +h
umask 022
LFS=/mnt/lfs
LC_ALL=POSIX
LFS_TGT=$(uname -m)-lfs-linux-gnu
PATH=/tools/bin:/bin:/usr/bin
export LFS LC_ALL LFS_TGT PATH
EOF

wget -O wget-list http://www.linuxfromscratch.org/lfs/downloads/stable/wget-list
wget -i wget-list -P $LFS/sources

cd $LFS
tar xf sources/binutils-2.24.tar.bz2
cd binutils-2.24
./configure --prefix=/tools --with-sysroot=$LFS --with-lib-path=/tools/lib --target=$LFS_TGT --disable-nls --disable-werror 
make
mkdir -v /tools/lib
ln -sv lib /tools/lib64
make install
cd $LFS
tar xf sources/gcc-4.8.2.tar.bz2
tar xf sources/mpfr-3.1.2.tar.xz
tar xf sources/gmp-5.1.3.tar.xz
tar xf sources/mpc-1.0.2.tar.xz
mv mpfr* mpfr
mv gmp* gmp
mv mpc* mpc
mv mpfr gmp mpc gcc-4.8.2
cd gcc-4.8.2
cat &gt; runme.sh &lt;&lt;EOF
for file in $(find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h)
do
    cp -uv $file{,.orig}
    sed -e 's@/lib\(64\)\?\(32\)\?/ld@/tools&amp;@g' \
        -e 's@/usr@/tools@g' $file.orig &gt; $file
    echo '
#undef STANDARD_STARTFILE_PREFIX_1
#undef STANDARD_STARTFILE_PREFIX_2
#define STANDARD_STARTFILE_PREFIX_1 "/tools/lib/"
#define STANDARD_STARTFILE_PREFIX_2 ""' &gt;&gt; $file
    touch $file.orig
done
EOF
chmod 755 runme.sh
./runme.sh
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Xen on ArchLinux]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/17/215227/"/>
    <updated>2014-09-17T21:52:27+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/17/215227</id>
    <content type="html"><![CDATA[<p>Today I bought a new hard disk, and tried to install xen on it.</p>

<h1>Install Base ArchLinux</h1>

<ol>
<li><p>Start computer with USB key, choose x86_64, NBD;</p></li>
<li><p>This is not UEFI boot: an error raised when <code>efivar -l</code>;</p></li>
<li><p>Install system:</p>

<p> # rmmod tg3
 # modprobe broadcom
 # modprobe tg3
 # systemctl stop dhcpcd.service
 # dhcpcd enp2s0
 # sgdisk &ndash;zap-all /dev/sda
 # cgdisk /dev/sda
 // choose GPT partitions type, /dev/sda1: 50G, /dev/sda2: 300G, 581G free
 # mkfs.ext4 /dev/sda1
 # mkfs.ext4 /dev/sda2
 # mount /dev/sda1 /mnt
 # mkdir /mnt/home
 # mount /dev/sda2 /mnt/home
 # vi /etc/pacman.d/mirrorlist
 # export http_proxy=<a href="http://10.32.1.154:8888">http://10.32.1.154:8888</a>
 # export https_proxy=<a href="http://10.32.1.154:8888">http://10.32.1.154:8888</a>   // add the ip into &ldquo;allow&rdquo; list tinyproxy.conf
 # pacstrap -i /mnt base base-devel
 # genfstab -U -p /mnt >> /mnt/etc/fstab
 # vi /etc/locale.gen
 # locale-gen
 # echo LANG=en_US.UTF-8 > /etc/locale.conf
 # export LANG=en_US.UTF-8
 # ln -s /usr/share/zoneinfo/Hongkong /etc/localtime
 # hwclock &ndash;systohc &ndash;utc
 # echo xenserver > /etc/hostname
 # vi /etc/hosts
 # systemctl enable <a href="&#x6d;&#x61;&#x69;&#108;&#116;&#x6f;&#x3a;&#100;&#104;&#x63;&#112;&#x63;&#x64;&#64;&#101;&#110;&#x70;&#50;&#x73;&#x30;&#46;&#115;&#101;&#114;&#118;&#x69;&#x63;&#x65;">&#100;&#104;&#x63;&#112;&#x63;&#100;&#64;&#x65;&#110;&#x70;&#x32;&#115;&#48;&#46;&#115;&#101;&#114;&#118;&#105;&#x63;&#101;</a>
 # passwd
 # export http_proxy=<a href="http://10.32.1.154:8888">http://10.32.1.154:8888</a>
 # export https_proxy=<a href="http://10.32.1.154:8888">http://10.32.1.154:8888</a>
 # pacman -S openssh
 # systemctl enable sshd.service
 # pacman -S gptfdisk            // use syslinux boot loader for GPT installed previously
 # pacman -S syslinux
 # syslinux-install_update -iam
 # vi /boot/syslinux/syslinux.cfg    // modify sda3 to sda1 in &ldquo;APPEND root=/dev/sda3&rdquo;
 # exit
 # reboot</p></li>
</ol>


<h1>Customize System</h1>

<p>After reboot, login as root and run:</p>

<pre><code># useradd -m chad
# passwd chad
# passwd -l root     // disable root login, use can remove this by `sudo passwd -u root`
# export http_proxy=http://10.32.1.154:8888
# export https_proxy=http://10.32.1.154:8888
# pacman -Syu
# pacman -S xorg-server xorg-server-utils xorg-xinit i3 dmenu xf86-video-intel terminator ttf-dejavu firefox
# su - chad
$ echo exec i3 &gt; ~/.xinitrc
$ startx
</code></pre>

<h1>Install Xen</h1>

<p>First make sure the host can access internet, then enable multilib repository, uncomment following lines in /etc/pacman.conf:</p>

<pre><code>[multilib]
Include = /etc/pacman.d/mirrorlist
</code></pre>

<p>Install yaourt, see note &ldquo;Yaourt Notes&rdquo; for details. Then run <code>yaourt -S xen</code>. If failed, install it manually:</p>

<p>Download xen.tar.gz, and run:</p>

<pre><code>tar xf xen.tar.gz
cd xen
makepkg
sudo pacman -U xen-4.4.1-1-x86_64.pkg.tar.xz
</code></pre>

<p>Config network:</p>

<pre><code># cd /etc/netctl
# cp examples/bridge xenbridge-dhcp
# vi xenbridge-dhcp
# netctl start xenbridge-dhcp
# brctl show
# netctl enable xenbridge-dhcp
</code></pre>

<p>Config services:</p>

<pre><code>sudo systemctl enable xenstored.service
sudo systemctl enable xenconsoled.service
sudo systemctl enable xendomains.service
</code></pre>

<p>Config boot loader. Add following stanza to /boot/syslinux/syslinux.cfg:</p>

<pre><code>LABEL xen
    MENU LABEL Xen
    KERNEL mboot.c32
    APPEND ../xen-4.4.1.gz --- ../vmlinuz-linux console=tty0 root=/dev/sda1 ro --- ../initramfs-linux.img
</code></pre>

<p>And make sure there is a &ldquo;mboot.c32&rdquo; file in folder /boot/syslinux, or you have to copy it:
<code>cp /usr/lib/syslinux/bios/mboot.c32 /boot/syslinux/</code>.</p>

<p>Note: If there is file conflicting errors, use <code>sudo pacman -U --force xen-4.4.1-1-x86_64.pkg.tar.xz</code> to install it.</p>

<p>Reboot, choose &ldquo;Xen&rdquo; at boot screen, then run <code>sudo xl list</code> (list all xen domains), you can see a &ldquo;Domain-0&rdquo; item.
If you boot with ArchLinux, run <code>sudo xl list</code> will report an error.</p>

<h1>Install Guest OS on Xen</h1>

<p>See <a href="http://wiki.xen.org/wiki/Xen_Configuration_File_Options#Disk_Devices">Xen Configuration File Options</a> for full syntax of xen domU config files.</p>

<h2>CentOS 6.5 minimal</h2>

<h3>PV</h3>

<p>Not succeed yet. Maybe we should use CentOS as dom0 system.</p>

<pre><code>$ mkdir ~/docs/cloud60
$ cd ~/docs/cloud60
$ dd if=/dev/zero of=cloud60.img bs=1M count=10240
$ mkfs.ext4 cloud60.img
$ sudo mount -o loop CentOS-6.5-x86_64-minimal.iso /mnt
$ cat cloud60.conf      // ???
$ sudo xl create -c cloud60.conf
</code></pre>

<h3>HVM</h3>

<pre><code>$ sudo pacman -S mesa-libgl bluez-libs tigervnc
$ mkdir ~/docs/cloud60
$ cd ~/docs/cloud60
$ dd if=/dev/zero of=cloud60.img bs=1M count=10240
$ mkfs.ext4 cloud60.img
$ sudo mount -o loop CentOS-6.5-x86_64-minimal.iso /mnt
$ cat cloud60.conf
name = "hvmcentos"
builder = "hvm"
memory = 1024
disk = [ "file:/home/chad/docs/cloud60/cloud60.img,xvda,w", "file:/home/chad/warez/CentOS-6.5-x86_64-minimal.iso,xvdb:cdrom,r" ]
vif = ["bridge=xenbr0"]
vnc = 1
vnclisten = "0.0.0.0"
vncdisplay = 1

$ sudo xl create cloud60.conf
$ sudo xl vncviewer hvmcentos
</code></pre>

<p>Or you can use <code>vncviewer localhost:5901</code> to connect to the guest OS, here the &ldquo;1&rdquo; in &ldquo;5901&rdquo; is determined by the value of &ldquo;vncdisplay&rdquo; in guest OS config file.
After connecting to the guest OS, install system, then reboot and connect it with vncviewer again.
You can use xl&rsquo;s subcommands &ldquo;list&rdquo;, &ldquo;top&rdquo; and &ldquo;info&rdquo; to probe domU systems.</p>

<h1>Using Xen</h1>

<p>Based on <a href="https://wiki.archlinux.org/index.php/Xen">Xen on Arch Wiki</a>.</p>

<p>Use Debian as dom0: <a href="http://wiki.xenproject.org/wiki/Xen_Project_Beginners_Guide#Installing_the_Xen_Project_Software">Xen Project Beginners Guide</a>;</p>

<p>Use CentOS as dom0: <a href="http://wiki.centos.org/HowTos/Xen/Xen4QuickStart">Xen4 CentOS6 QuickStart</a>;</p>

<p>Use Ubuntu as dom0: <a href="https://help.ubuntu.com/community/Xen">Xen in Ubuntu Community</a>;</p>

<p>Other patterns see <a href="http://wiki.xenproject.org/wiki/Category:Guest_Install">Guest Install</a>;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在Linux上播放带中文字幕的电影]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/17/094859/"/>
    <updated>2014-09-17T09:48:59+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/17/094859</id>
    <content type="html"><![CDATA[<p>今天从<a href="https://kickass.to/">Kickass</a>上下载了黄秋生1996年主演的电影“伊波拉病毒”(Ebola Syndrome)，粤语版听不懂，于是想下载中文字幕，Windows上的射手播放器可以自动下载字幕，Linux上貌似没有这么好用的播放器，于是从<a href="http://shooter.cn/">射手网</a>上下载了字幕文件，用<code>iconv -f gbk -t utf8 ebola_chs.srt</code>将编码转为utf8，然后<code>sudo aptitude install mplayer</code>安装了MPlayer，发现无法正常播放中文字幕，按照网络上的介绍将默认编码设为UTF-8仍然是乱码，于是<code>sudo aptitude install smplayer</code>，然后<code>smplayer</code>启动，在[Preferences -> Subtitles -> Subtitles -> Encodings]中，将&#8221;Default subtitle encoding&#8221;设为为&#8221;UTF-8 (UTF-8)&ldquo;，将&#8221;Autoload -> Autoload subtitle files&#8221;设置为&#8221;All subs containing movie names&#8221;，并勾选&#8221;Select first available subtitle&#8221;，现在视频文件名是Ebola_LKRG.avi，字幕是Ebola_LKRG_chs.srt，播放视频文件时能够自动加载中文字幕，无乱码，另外[Preferences -> Subtitles -> Subtitles -> Font and colors -> Font]默认值为Arial，在MPlayer中同样设为Arial，中文字幕仍为乱码，可见造成乱码的原因很可能是程序本身不支持UTF8编码的多字节字符。</p>

<p>调整字幕延时：
如果某句对白在字幕文件中的时间标记是13s，但在影片中应该在第32s出现，则在[SMPlayer -> Subtitles -> Set delay&hellip;]中的值应设为-19000，即字幕向后推迟19秒。</p>

<p>搜索字幕：
[SMPlayer -> Subtitles -> Find subtitles on Opensubtitles.org].
或者安装subdownloader: <code>sudo aptitude install subdownloader</code>，但这样软件连接服务器速度很慢，不是很好用。</p>

<p>使用amule(<code>sudo aptitude install amule</code>)也可以搜索到这部影片，但下载速度很慢。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Run Spark Tasks on ArchLinux]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/15/110702/"/>
    <updated>2014-09-15T11:07:02+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/15/110702</id>
    <content type="html"><![CDATA[<h1>Install</h1>

<ol>
<li><p>Install JDK: <code>sudo pacman -S jdk7-openjdk</code>;</p></li>
<li><p>Download pre-build package (spark-1.1.0-bin-hadoop2.4.tgz) from <a href="http://spark.apache.org/">Apache Spark website</a>;</p></li>
<li><p>Extract and add path: <code>tar xf spark-1.1.0-bin-hadoop2.4.tgz</code>;</p></li>
</ol>


<h1>Run Spark script</h1>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Two Java Building Tools]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/12/103608/"/>
    <updated>2014-09-12T10:36:08+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/12/103608</id>
    <content type="html"><![CDATA[<p>I need build a java project to compare performance of <a href="http://logging.apache.org/log4j/2.x/">apache log4j</a> and <a href="http://logback.qos.ch/">Logback</a>. The following codes are the building procedures based on [Gradle]<a href="http://www.gradle.org/">http://www.gradle.org/</a>) and <a href="http://www.scala-sbt.org/">sbt</a>.</p>

<h1>sbt</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir myproject
</span><span class='line'>cd myproject
</span><span class='line'>cat &lt;&lt;EOF &gt; build.sbt
</span><span class='line'>name := "MyProject"
</span><span class='line'>
</span><span class='line'>version := "0.1"
</span><span class='line'>EOF
</span><span class='line'>mkdir project
</span><span class='line'>echo 'addSbtPlugin("com.typesafe.sbteclipse" % "sbteclipse-plugin" % "2.5.0")' &gt; project/plugins.sbt
</span><span class='line'>sbt eclipse</span></code></pre></td></tr></table></div></figure>


<p>Note that the blank line between &ldquo;name&rdquo; &amp; &ldquo;version&rdquo; in build.sbt is mandatory for Scala syntax.
Now start eclipse, import this proect, create new packages (com.boco.logb) and Java files (LoggerOneThread.java) in &ldquo;src/main/java&rdquo; folder, and config files (log4j.properties and logback.xml) in src/resources folder.
slf4j looks for log implementations based on jars in classpath instead of conifg files, so we add both 2 config files into resource folder.</p>

<p>The LoggerOneThread.java file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>package com.boco.logb;
</span><span class='line'>
</span><span class='line'>import java.util.concurrent.TimeUnit;
</span><span class='line'>
</span><span class='line'>import org.slf4j.Logger;
</span><span class='line'>import org.slf4j.LoggerFactory;
</span><span class='line'>
</span><span class='line'>public class LoggerOneThread {
</span><span class='line'>    public static final long TOTAL_TIMES = 4000 * 1000;
</span><span class='line'>    private static final Logger logger = LoggerFactory
</span><span class='line'>            .getLogger(LoggerOneThread.class);
</span><span class='line'>
</span><span class='line'>    public static void main(String[] args) {
</span><span class='line'>        long start = System.nanoTime();
</span><span class='line'>        for (int i = 1; i &lt; TOTAL_TIMES; i++) {
</span><span class='line'>            logger.debug("This is a test message. This is another test message.");
</span><span class='line'>        }
</span><span class='line'>        long estimatedTime = TimeUnit.NANOSECONDS.toSeconds(System.nanoTime()
</span><span class='line'>                - start);
</span><span class='line'>        System.out.println("Write " + TOTAL_TIMES + " logs takes time "
</span><span class='line'>                + estimatedTime + " s.");
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Log4j config file log4j.properties:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>log4j.rootLogger = DEBUG, FILE
</span><span class='line'>
</span><span class='line'>log4j.appender.FILE=org.apache.log4j.RollingFileAppender
</span><span class='line'>log4j.appender.FILE.File=log4j.log
</span><span class='line'>log4j.appender.FILE.Append=true
</span><span class='line'>log4j.appender.FILE.MaxFileSize=50MB
</span><span class='line'>log4j.appender.FILE.MaxBackupIndex=10
</span><span class='line'>log4j.appender.FILE.layout=org.apache.log4j.PatternLayout
</span><span class='line'>log4j.appender.FILE.layout.ConversionPattern=%d{MM-dd HH:mm:ss.SSS} [%t] %p %c - %m%n</span></code></pre></td></tr></table></div></figure>


<p>Logback config file logback.xml:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;configuration&gt;
</span><span class='line'>
</span><span class='line'>    &lt;appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt;
</span><span class='line'>        &lt;file&gt;logback.log&lt;/file&gt;
</span><span class='line'>
</span><span class='line'>        &lt;rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy"&gt;
</span><span class='line'>            &lt;fileNamePattern&gt;logback.log.%i&lt;/fileNamePattern&gt;
</span><span class='line'>            &lt;minIndex&gt;1&lt;/minIndex&gt;
</span><span class='line'>            &lt;maxIndex&gt;11&lt;/maxIndex&gt;
</span><span class='line'>        &lt;/rollingPolicy&gt;
</span><span class='line'>
</span><span class='line'>        &lt;triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"&gt;
</span><span class='line'>            &lt;maxFileSize&gt;50MB&lt;/maxFileSize&gt;
</span><span class='line'>        &lt;/triggeringPolicy&gt;
</span><span class='line'>
</span><span class='line'>        &lt;encoder&gt;
</span><span class='line'>            &lt;pattern&gt;%date{MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger - %msg%n&lt;/pattern&gt;
</span><span class='line'>        &lt;/encoder&gt;
</span><span class='line'>    &lt;/appender&gt;
</span><span class='line'>
</span><span class='line'>    &lt;root level="DEBUG"&gt;
</span><span class='line'>        &lt;appender-ref ref="FILE" /&gt;
</span><span class='line'>    &lt;/root&gt;
</span><span class='line'>
</span><span class='line'>&lt;/configuration&gt;</span></code></pre></td></tr></table></div></figure>


<p>Add following dependencies into build.sbt.log4j:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>libraryDependencies ++= Seq(
</span><span class='line'>  "org.slf4j" % "slf4j-api" % "1.7.7",
</span><span class='line'>  "org.slf4j" % "slf4j-log4j12" % "1.7.7",
</span><span class='line'>  "log4j" % "log4j" % "1.2.17"
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure>


<p>And the following into build.sbt.logback:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>libraryDependencies ++= Seq(
</span><span class='line'>  "org.slf4j" % "slf4j-api" % "1.7.7",
</span><span class='line'>  "ch.qos.logback" % "logback-classic" % "1.1.2",
</span><span class='line'>  "ch.qos.logback" % "logback-core" % "1.1.2"
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure>


<p>Now delete .classpath file under project home folder, run <code>sbt eclipse</code> again to refresh classpath.</p>

<p>When coding completed, copy build.sbt.log4j (or build.sbt.logback) as build.sbt, run <code>sbt run</code> to run this project. Run <code>sbt package</code> to create jar file under target folder.</p>

<p>Some other settings in build.sbt:</p>

<pre><code>organization := "org.leechau"
</code></pre>

<h1>Gradle</h1>

<ol>
<li><p>Install gradle plugin for Eclipse, and create a Gradle Project &ldquo;MyProject&rdquo; in Eclipse, choose &ldquo;Java Quickstart&rdquo; as Sample project;</p></li>
<li><p>Add following lines into auto-created build.gradle file for log4j test:</p>

<pre><code> apply plugin: 'application'
 dependencies {
     compile 'org.slf4j:slf4j-api:1.7.7', 'log4j:log4j:1.2.17', 'org.slf4j:slf4j-log4j12:1.7.7'
 }
 mainClassName = "com.boco.logb.LoggerOneThread"
</code></pre></li>
<li><p>Refresh dependencies: [Gradle -> Refresh Dependencies] in context menu;</p></li>
<li><p>Run log4j test:</p>

<pre><code> cp build.gradle build.gradle.log4j
 gradle clean run
</code></pre></li>
<li><p>For logback test, create a new file build.gradle.logback based on build.gradle.log4j, but use the following dependencies:</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>compile 'org.slf4j:slf4j-api:1.7.7', 'ch.qos.logback:logback-classic:1.1.2', 'ch.qos.logback:logback-core:1.1.2'</span></code></pre></td></tr></table></div></figure>


<p>The config files log4j.properties and logback.xml, and Java file LoggerOneThread.java are identical to that in sbt section.</p>

<ol>
<li><p>Run logback test:</p>

<pre><code> cp build.gradle.logback build.gradle
 gradle clean run
</code></pre></li>
</ol>


<h1>Eclipse Interface</h1>

<p>How to creat Eclipse setting files (.classpath and .project) so that we can import this project into Eclipse, editing and debuging in it.</p>

<p>For gradle, add <code>apply plugin: 'eclipse'</code> into build.gradle and run <code>gradle cleanEclipse eclipse</code>;</p>

<p>For sbt, add <code>addSbtPlugin("com.typesafe.sbteclipse" % "sbteclipse-plugin" % "2.5.0")</code> (for sbt 0.13) into $PROJECT_HOME/project/plugins.sbt, and run <code>sbt eclipse</code>;</p>

<h1>Run Program</h1>

<h2>gradle</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// run log4j test
</span><span class='line'>cp build.gradle.log4j build.gradle
</span><span class='line'>gradle clean run
</span><span class='line'>// run logback test
</span><span class='line'>cp build.gradle.logback build.gradle
</span><span class='line'>gradle clean run</span></code></pre></td></tr></table></div></figure>


<h2>sbt</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// run log4j test
</span><span class='line'>cp build.sbt.log4j build.sbt
</span><span class='line'>sbt clean run
</span><span class='line'>// run logback test
</span><span class='line'>cp build.sbt.logback build.sbt
</span><span class='line'>sbt clean run</span></code></pre></td></tr></table></div></figure>


<p>If you have multiple main entry in source files, you can use &lsquo;runMain com.boco.logb.LoggerOneThread&rsquo; instead of &ldquo;run&rdquo; to run a specific program.</p>

<h1>Conclusion</h1>

<p>Gradle is mainly for building of Groovy and Java project, while sbt is mainly for building of Scala and Java project. So far Gradle has better support for building Java project.
For example, it&rsquo;s very convenient to build production zip or tar files with Gradle&rsquo;s application plugin (via the &ldquo;distZip&rdquo; task), while there&rsquo;s no corresponding plugin in sbt.
It&rsquo;s convenient to add or remove dependencies within Eclipse with the Gradle plugin of Eclipse (not the eclipse plugin of Gradle), while there&rsquo;s no sbt plugin of Eclipse (sbteclipse of typesafehub is a eclipse plugin of sbt). So we have to refresh build path of dependencies manually when developing a project in Eclipse created by sbt.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Package Repository Management on Ubuntu and Mint]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/09/163500/"/>
    <updated>2014-09-09T16:35:00+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/09/163500</id>
    <content type="html"><![CDATA[<ul>
<li><p>Add repository: &lsquo;sudo apt-add-repository ppa:kernel-ppa/ppa`</p></li>
<li><p>List all repositories: <code>ls /etc/apt/sources.list.d</code></p></li>
<li><p>Remove repository: <code>sudo apt-add-repository --remove ppa:kernel-ppa/ppa</code>.
If you can&rsquo;t get the ppa name, do it manually with <code>sudo rm /etc/apt/sources.list.d/theppa.list</code>.</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Build BVT System Based on Docker]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/03/150610/"/>
    <updated>2014-09-03T15:06:10+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/03/150610</id>
    <content type="html"><![CDATA[<p>System: ArchLinux 64bit, IP address: 10.32.1.18.</p>

<h1>Build</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo docker -p 8080:8080 --name myjenkins jenkins</span></code></pre></td></tr></table></div></figure>


<p>Now you can access <a href="http://10.32.1.18:8080">jenkins server</a> in browser.</p>

<p>List running containers: <code>sudo docker ps</code> (so you can get the container&rsquo;s name for stoping and restarting later);</p>

<p>Stop jenkins server: <code>sudo docker stop myjenkins</code>;</p>

<p>Restart this server: <code>sudo docker start myjenkins</code>;</p>

<h1>Backup and Restore</h1>

<p>Backup image: <code>sudo docker save -o jenkins-docker.tar jenkins</code>;</p>

<p>Restore image: <code>sudo docker load -i jenkins-docker.tar</code>;</p>

<p>Backup container:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(optional) sudo docker stop jenkins
</span><span class='line'>sudo docker export myjenkins &gt; mybvt-system.tar
</span><span class='line'>scp mybvt-system.tar chad@laptop:~/
</span><span class='line'>ssh chad@laptop
</span><span class='line'>cat mybvt-system.tar | sudo docker import - exampleimagelocal:new</span></code></pre></td></tr></table></div></figure>


<p>But where is the imported container?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automount USB Disk on ArchLinux]]></title>
    <link href="http://leetschau.github.io/blog/2014/09/03/111703/"/>
    <updated>2014-09-03T11:17:03+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/09/03/111703</id>
    <content type="html"><![CDATA[<h1>ArchLinux</h1>

<p>Install: <code>sudo pacman -S udiskie</code>;</p>

<p>Start service: run <code>udiskie &amp;</code> manually when system startup, or add &ldquo;udiskie &amp;&rdquo; into ~/.xinitrc;</p>

<p>Now when you plug USB key into computer, it will be automount to /media folder.</p>

<p>Use <code>udiskie-umount -a</code> to unmount it.</p>

<p>See <code>man udiskie</code> for more information.</p>

<h1>Mint</h1>

<p>Install: <code>sudo aptitude install udevil</code>;</p>

<p>Start service: run <code>devmon</code> in dmenu when system startup, or add &ldquo;devmon &amp;&rdquo; into ~/.xsession;</p>

<p>After plug USB key into computer, it will be automount to /media folder.
If you do not startup devmon in background, you can run <code>devmon -a</code> to mount the USB key.</p>

<p>Run <code>devmon -c</code> to unmount the USB key.</p>

<p>See <code>man devmon</code> for more information.</p>

<h1>Difference between .xinitrc and .xsession:</h1>

<p>If you startup your system with <a href="https://wiki.archlinux.org/index.php/display_manager">display manager</a>, where you get a graphical login screen, it will read ~/.xsession.
In case of you startup your system without display manager and login to shell, startup i3 (or other wm) with <code>startx</code>, then the <a href="http://en.wikipedia.org/wiki/Xinit">xinit</a> program will read ~/.xinitrc;</p>

<p>See <a href="https://unix.stackexchange.com/questions/47359/what-is-xsession-for">What is “.xsession” for?</a> for details.</p>

<p>See <a href="https://wiki.archlinux.org/index.php/Arch_boot_process">Arch boot process</a> for how Getty manage login process in system boot process.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Docker Notes]]></title>
    <link href="http://leetschau.github.io/blog/2014/08/30/104928/"/>
    <updated>2014-08-30T10:49:28+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/08/30/104928</id>
    <content type="html"><![CDATA[<h1>Mint</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># sudo aptitude update
</span><span class='line'># sudo aptitude install docker.io aufs-tools cgroup-lite apparmor-utils
</span><span class='line'># sudo ln -sf /usr/bin/docker.io /usr/local/bin/docker
</span><span class='line'># sudo sed -i '$acomplete -F _docker docker' /etc/bash_completion.d/docker.io
</span><span class='line'># docker run ubuntu:14.04 echo 'hello ubuntu'
</span><span class='line'># docker version
</span><span class='line'>Client version: 0.9.1
</span><span class='line'>Go version (client): go1.2.1
</span><span class='line'>Git commit (client): 3600720
</span><span class='line'>Server version: 0.9.1
</span><span class='line'>Git commit (server): 3600720
</span><span class='line'>Go version (server): go1.2.1
</span><span class='line'>Last stable version: 1.2.0, please update docker</span></code></pre></td></tr></table></div></figure>


<h1>ArchLinux</h1>

<p>Docker is only available on X86_64 repository so far.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># pacman -S docker
</span><span class='line'># systemctl enable docker
</span><span class='line'># systemctl start docker
</span><span class='line'># docker run ubuntu:14.04 echo 'hello world'
</span><span class='line'># docker run -i -t ubuntu:14.04 /bin/bash
</span><span class='line'># lsb_release -a
</span><span class='line'>Distributor ID: Ubuntu
</span><span class='line'>Description: Ubuntu 14.04.1 LTS
</span><span class='line'>Release: 14.04
</span><span class='line'>Codename: trusty
</span><span class='line'># exit
</span><span class='line'># docker version
</span><span class='line'>Client version: 1.2.0
</span><span class='line'>Go version (client): go1.3.1
</span><span class='line'>OS/Arch (client): linux/amd64
</span><span class='line'>Server version: 1.2.0
</span><span class='line'>Server API version: 1.14
</span><span class='line'>Go version (server): go1.3.1</span></code></pre></td></tr></table></div></figure>


<p>So you can see at least for now Docker is much newer and easy to use on Arch than on Mint (Ubuntu).
If you install &ldquo;tree&rdquo; with apt-get in the container, logout and relogin, you will find the &ldquo;tree&rdquo; command disappeared.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spark Notes]]></title>
    <link href="http://leetschau.github.io/blog/2014/08/27/180124/"/>
    <updated>2014-08-27T18:01:24+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/08/27/180124</id>
    <content type="html"><![CDATA[<h1>Spark Shell</h1>

<h2>Shutdown info log in spark-shell:</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd $SPARK_HOME/conf    // here it's ~/apps/spark-1.0.2-bin-hadoop2/conf
</span><span class='line'>cp log4j.properties.template log4j.properties
</span><span class='line'>sed -i '2s/INFO/WARN/g' log4j.properties</span></code></pre></td></tr></table></div></figure>


<p>The sed command here replace &ldquo;INFO&rdquo; with &ldquo;WARN&rdquo; in the second line of log4j.properties.</p>

<h2>Customize shell parameters</h2>

<h3>master and memory</h3>

<p>spark-shell &ndash;master spark://cloud60:7077 &ndash;driver-memory 2g &ndash;executor-memory 2g -i wfp-spark.script</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Build Redis on CentOS 6]]></title>
    <link href="http://leetschau.github.io/blog/2014/08/26/100107/"/>
    <updated>2014-08-26T10:01:07+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/08/26/100107</id>
    <content type="html"><![CDATA[<p>This server can&rsquo;t access Internet. So we can only download source tarball (redis-2.8.2.tar.gz) and build from source.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tar xf redis-2.8.2.tar.gz
</span><span class='line'>cd redis-2.8.2
</span><span class='line'>// if you run "sudo make install" directly, it gives a "zmalloc.h:50:31: error: jemalloc/jemalloc.h: No such file or directory" error.
</span><span class='line'>cd deps
</span><span class='line'>sudo make hiredis jemalloc linenoise lua
</span><span class='line'>cd ..
</span><span class='line'>sudo make install</span></code></pre></td></tr></table></div></figure>


<p>Ref:
<a href="http://unix.stackexchange.com/questions/94479/jemalloc-and-other-errors-making-redis-on-centos-6-4">jemalloc and other errors making redis on centos 6.4</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Build Working Environment With I3 and Mint]]></title>
    <link href="http://leetschau.github.io/blog/2014/08/24/110909/"/>
    <updated>2014-08-24T11:09:09+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/08/24/110909</id>
    <content type="html"><![CDATA[<h1>Base System</h1>

<p>Install Linux Mint 17 Xfce with Live DVD (USB key created by YUMI 2.0.5) on Asus X84H laptop. The &ldquo;/&rdquo; partition is 30GB, while the &ldquo;/home&rdquo; partition is 50GB.</p>

<p>No need to install any hardware drivers. It simply works!</p>

<h1>Window Manager</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo aptitude install i3-wm dmenu i3status i3lock</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s it. Now you can logout. In login manager, you can find &ldquo;i3&rdquo;, choose it, and login i3 environment.</p>

<h2>Power Management in i3</h2>

<p>Check if &ldquo;pm-utils&rdquo; has been installed via <code>dpkg -l|grep pm-utils</code>. If not, install it with <code>sudo aptitude install pm-utils</code>;</p>

<ul>
<li><p>suspend: <code>sudo pm-suspend-hybrid</code>, it will suspend your system. When out of power, it will hibernate. See <code>man pm-actions</code> for details;</p></li>
<li><p>hibernate: <code>sudo pm-hibernate</code>, it will save current state into disk;</p></li>
<li><p>poweroff: <code>sudo poweroff</code>;</p></li>
<li><p>restart: <code>sudo restart</code>;</p></li>
<li><p>exit i3: <code>i3-msg exit</code> or Mod+Shift+E;</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Install New Locale on Linux Mint]]></title>
    <link href="http://leetschau.github.io/blog/2014/08/24/103023/"/>
    <updated>2014-08-24T10:30:23+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/08/24/103023</id>
    <content type="html"><![CDATA[<p>After installing a new Linux (Mint 17, xfce), I need to install Chinese input method, so I have to install Chinese locale at first.</p>

<ol>
<li><p>List all installed locales: <code>locale -a</code>;</p></li>
<li><p>View all supported locales on your system: <code>less /usr/share/i18n/SUPPORTED</code>, and &ldquo;zh_CN.UTF-8 UTF-8&rdquo; is what I want to install;</p></li>
<li><p>Add this locale into locale list file: `echo &ldquo;zh_CN.UTF-8 UTF-8&rdquo; >> /var/lib/locales/supported.d/local&#8221;;</p></li>
<li><p>Regenerate locale list: <code>sudo dpkg-reconfigure locales</code>;</p></li>
</ol>


<p>Ref:</p>

<p><a href="http://askubuntu.com/questions/76013/how-do-i-add-locale-to-ubuntu-server">How do I add locale to ubuntu server?</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Qtile on ArchLinux]]></title>
    <link href="http://leetschau.github.io/blog/2014/08/21/113949/"/>
    <updated>2014-08-21T11:39:49+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/08/21/113949</id>
    <content type="html"><![CDATA[<h1>Install</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Before install qtile, you need download python2-setuptools manually, and install it:
</span><span class='line'>$ sudo pacman -U python2-setuptools-1_5.7-1-any.pkg.tar.xz
</span><span class='line'>$ yaourt -S qtile-git
</span><span class='line'>$ mkdir ~/.config/qtile
</span><span class='line'>$ cp /usr/share/doc/qtile-git/default_config.py ~/.config/qtile/config.py
</span><span class='line'>$ echo "exec qtile" &gt; ~/.xinitrc
</span><span class='line'>$ python2 -m py_compile ~/.config/qtile/config.py    // check syntax for config.py
</span><span class='line'>$ qsh
</span><span class='line'>&gt; restart
</span><span class='line'>&gt; quit
</span><span class='line'>$ </span></code></pre></td></tr></table></div></figure>


<h1>Configuration</h1>

<p>Something import in config.py:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mod = "mod4"    # the Win key as mod key
</span><span class='line'>Key([mod], "Return", lazy.spawn("xterm")),   # start a shell, you can modify it as another virtual terminal, such as "xfce4-terminal"
</span><span class='line'>Key([mod], "w", lazy.window.kill()),         # close a application
</span><span class='line'>Key([mod, "control"], "r", lazy.restart()),  # reload Qtile after modify config.py
</span><span class='line'>Key([mod, "control"], "q", lazy.shutdown()), # quit Qtile</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
</feed>
