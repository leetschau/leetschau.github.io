<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="clojure, Vim, fireplace, Tech, " />

<meta property="og:title" content="Use vim as Clojure Development Environment"/>
<meta property="og:url" content="http://leetschau.github.io/use-vim-as-clojure-development-environment.html" />
<meta property="og:description" content="REPL in vim Install leiningen 2.x; verify: lein repl produces something like &#34;nREPL server started on port...&#34;; Add [cider/cider-nrepl &#34;0.12.0&#34;] into ~/.lein/profiles.clj, Now ~/.lein/profiles.clj is: {:user {:plugins [ [lein-try &#34;0.4.3&#34;] [cider/cider-nrepl &#34;0.12.0&#34;] ] } } Install clojure plugins with vundle: add …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2013-09-22T17:53:55+08:00" />
<meta property="" content="2013-09-22T17:53:55+08:00" />
<meta name="twitter:title" content="Use vim as Clojure Development Environment">
<meta name="twitter:description" content="REPL in vim Install leiningen 2.x; verify: lein repl produces something like &#34;nREPL server started on port...&#34;; Add [cider/cider-nrepl &#34;0.12.0&#34;] into ~/.lein/profiles.clj, Now ~/.lein/profiles.clj is: {:user {:plugins [ [lein-try &#34;0.4.3&#34;] [cider/cider-nrepl &#34;0.12.0&#34;] ] } } Install clojure plugins with vundle: add …">

        <title>Use vim as Clojure Development Environment · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://leetschau.github.io/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://leetschau.github.io">Home</a></li>
                            <li ><a href="http://leetschau.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://leetschau.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://leetschau.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://leetschau.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://leetschau.github.io/use-vim-as-clojure-development-environment.html"> Use vim as Clojure Development Environment </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>REPL in vim</h1>
<ol>
<li>
<p>Install leiningen 2.x;</p>
<p>verify: <code>lein repl</code> produces something like "nREPL server started on port..."; </p>
</li>
<li>
<p>Add <code>[cider/cider-nrepl "0.12.0"]</code> into ~/.lein/profiles.clj,
   Now ~/.lein/profiles.clj is:
   <code>{:user {:plugins [ [lein-try "0.4.3"] [cider/cider-nrepl "0.12.0"] ] } }</code></p>
</li>
<li>
<p>Install clojure plugins with vundle: add the following into ~/.vimrc:</p>
<div class="highlight"><pre><span></span><code><span class="err">Plugin &#39;tpope/vim-fireplace&#39;</span>
<span class="err">Plugin &#39;tpope/vim-classpath&#39;</span>
<span class="err">Plugin &#39;guns/vim-clojure-static&#39;</span>
</code></pre></div>


</li>
<li>
<p>Create a new clojure project: <code>lein new myproj</code>;</p>
</li>
<li>
<p>Run "lein repl" under myproj (to download necessary jar files);</p>
</li>
<li>
<p>edit a clojure file (xxx.clj) with vi, using ":Eval" to evaluate
   the expression under cursor, using ":%Eval" to evaluate current namespace;</p>
</li>
<li>
<p><code>K</code> to show doc of the function under cursor, <code>[d</code> show source codes;</p>
</li>
<li>
<p><code>[&lt;C-D&gt;</code> (press <code>[</code>, followed by Ctrl-d) jump to source code of the function
   under cursor, <code>Ctrl-o</code> to jump back.</p>
</li>
</ol>
<p>Note: the clj file must be one of the source files
(under "src" folder) of the clojure project created by leiningen.
And the first line of this file (a clojure module actually) must be
<code>(ns project-name.module-name)</code>;</p>
<p>Ref:</p>
<p><a href="https://github.com/clojure-emacs/cider-nrepl">CIDER nREPL</a></p>
<p>http://clojure-doc.org/articles/tutorials/vim_fireplace.html</p>
<p>http://www.boxuk.com/blog/unboxing-vim-fireplace/</p>
<h2>Define Shortcuts for Efficiency</h2>
<p>Add the following codes into .vimrc (before "filetype on");</p>
<div class="highlight"><pre><span></span><code><span class="err">autocmd FileType clojure nnoremap &lt;buffer&gt; &lt;F5&gt; :Eval&lt;CR&gt;</span>
<span class="err">autocmd FileType clojure nnoremap &lt;buffer&gt; &lt;F6&gt; :%Eval&lt;CR&gt;</span>
</code></pre></div>


<p>Explanation: "autocmd <event> <command>" means when <event> happens,
run <command>. Here <event> is "FileType clojure",
<command> is "nnoremap <buffer> <F5> :Eval<CR>".
The <buffer> options here is "buffer local map",
which means this keymapping only take effect on the current buffer.
See <a href="http://learnvimscriptthehardway.stevelosh.com/chapters/11.html">Buffer-Local Options and Mappings in Learn Vimscript the Hard Way</a>
for explanations.</p>
<p>To determine FileType name (here is clojure), you should open a target file
(here is any file with ".clj" extension) in vi, then run ":set filetype".</p>
<h2>Discussion</h2>
<p>Install clojure plugins with pathogen:</p>
<div class="highlight"><pre><span></span><code><span class="err">cd ~/.vim/bundle</span>
<span class="err">git clone git://github.com/tpope/vim-fireplace.git </span>
<span class="err">git clone git://github.com/tpope/vim-classpath.git </span>
<span class="err">git clone git://github.com/guns/vim-clojure-static.git</span>
</code></pre></div>


<h1>S-expression Text Manipulation</h1>
<p>Add the following into ~/.vimrc:</p>
<div class="highlight"><pre><span></span><code><span class="err">let maplocalleader = &quot;,&quot;</span>
<span class="err">Plugin &#39;tpope/vim-repeat&#39;</span>
<span class="err">Plugin &#39;guns/vim-sexp&#39;</span>
<span class="err">Plugin &#39;tpope/vim-surround&#39;</span>
<span class="err">Plugin &#39;tpope/vim-sexp-mappings-for-regular-people&#39;</span>
</code></pre></div>


<p>See <a href="https://github.com/guns/vim-sexp#definitions">Definitions in vim-sexp</a>
for the definitions of FORM and ELEMENT.</p>
<h2>Moving</h2>
<p><code>(</code> and <code>)</code> move the cursor to the nearest paired structural bracket.
<code>[[</code> and <code>]]</code> move the cursor to previous/next top-level ELEMENT.</p>
<h2>Editing</h2>
<p>Now you can use <action>[ai][fFse] to manipulate s-exp style text blocks,
<action> can be [d]elete, [c]hange, [v]isual, [y]ank,
"f" means current form, "F" means top-level FORM.
"s" means string, "e" means ELEMENT.
For example: daf, dif, daF, diF, das, dae, vaf, vif, caf, cif.</p>
<p>Meta key used in key definitions of "guns/vim-sexp" doesn't work
on Ubuntu laptop, use "tpope/vim-sexp-mappings-for-regular-people" instead:</p>
<p><code>&gt;f</code>/<code>&lt;f</code>/<code>&gt;e</code>/<code>&lt;e</code> swap current FORM/ELEMENT with the next/previous FORM.
For example, when cursor in <code>(str "baz" "bar")</code>,
<code>&lt;f</code> convert <code>(foo (str "baz" "bar"))</code> to <code>((str "baz" "bar") foo)</code>.
When cursor on "foo", use <code>&lt;e</code> to move back.</p>
<p>To demonstrate "Slurpage", say there is a code snippet <code>(foo "bar")</code>,
we need convert it to <code>(foo (str "baz" "bar"))</code>,
here underscore is used as the cursor:</p>
<div class="highlight"><pre><span></span><code><span class="err">(foo_ &quot;bar&quot;)</span>
</code></pre></div>


<p>Insert "(baz)" and press <ESC>, move cursor to ")":</p>
<div class="highlight"><pre><span></span><code><span class="err">(foo (str &quot;baz&quot;) &quot;bar&quot;)</span>
</code></pre></div>


<p>Press <code>&gt;)</code> to include "bar" in the current FORM:</p>
<div class="highlight"><pre><span></span><code><span class="err">(foo (str &quot;baz&quot; &quot;bar&quot;))</span>
</code></pre></div>


<p>Use <code>&lt;)</code> to move back.</p>
            
            
            <hr/>
            <script src="https://utteranc.es/client.js"
                    repo="leetschau/leetschau.github.io"
                    issue-term="pathname"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>
            </script>
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2013-09-22T17:53:55+08:00">Sep 22, 2013</time>

<h4>Last Updated</h4>
<time datetime="2013-09-22T17:53:55+08:00">Sep 22, 2013</time>

            <h4>Category</h4>
            <a class="category-link" href="http://leetschau.github.io/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://leetschau.github.io/tags.html#clojure-ref">clojure
                    <span>26</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#fireplace-ref">fireplace
                    <span>1</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#vim-ref">Vim
                    <span>92</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>