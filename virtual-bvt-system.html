<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="sonarqube, jenkins, jdk, ant, java, subversion, vagrant, vm, Tech, " />

<meta property="og:title" content="Virtual BVT System "/>
<meta property="og:url" content="http://leetschau.github.io/virtual-bvt-system.html" />
<meta property="og:description" content="Prerequisites The host server of the environment is 10.0.2.47; Install vagrant on server 47; Add vagrant box of precise x86_64: vagrant box add ...; Create a directory named &#34;bvt-package&#34; under ~/warez, which contains: apache-ant-1.9.3-bin.tar.bz2 cobertura.jar hamcrest-core-1.3.jar jdk-6u45-linux-x64.bin jenkins-1.544.war …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2014-06-23T13:48:47+08:00" />
<meta property="" content="2014-06-23T13:48:47+08:00" />
<meta name="twitter:title" content="Virtual BVT System ">
<meta name="twitter:description" content="Prerequisites The host server of the environment is 10.0.2.47; Install vagrant on server 47; Add vagrant box of precise x86_64: vagrant box add ...; Create a directory named &#34;bvt-package&#34; under ~/warez, which contains: apache-ant-1.9.3-bin.tar.bz2 cobertura.jar hamcrest-core-1.3.jar jdk-6u45-linux-x64.bin jenkins-1.544.war …">

        <title>Virtual BVT System  · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://leetschau.github.io/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://leetschau.github.io">Home</a></li>
                            <li ><a href="http://leetschau.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://leetschau.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://leetschau.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://leetschau.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://leetschau.github.io/virtual-bvt-system.html"> Virtual BVT System  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>Prerequisites</h1>
<ol>
<li>
<p>The host server of the environment is 10.0.2.47;</p>
</li>
<li>
<p>Install <a href="http://www.vagrantup.com/">vagrant</a> on server 47;</p>
</li>
<li>
<p>Add vagrant box of precise x86_64: <code>vagrant box add ...</code>;</p>
</li>
<li>
<p>Create a directory named "bvt-package" under ~/warez, which contains:
    apache-ant-1.9.3-bin.tar.bz2
    cobertura.jar
    hamcrest-core-1.3.jar
    jdk-6u45-linux-x64.bin
    jenkins-1.544.war
    junit-4.8.1.jar
    sonar-3.6.1.zip
    svn_amd64_ubuntu12.04
        libapr1_1.4.6-1_amd64.deb
        libaprutil1_1.3.12+dfsg-3_amd64.deb
        libdb4.8_4.8.30-11ubuntu1_amd64.deb
        libneon27-gnutls_0.29.6-1_amd64.deb
        libsvn1_1.6.17dfsg-3ubuntu3_amd64.deb
        subversion_1.6.17dfsg-3ubuntu3_amd64.deb
    unzip_6.0-4ubuntu1_amd64.deb
    zip_3.0-4_amd64.deb</p>
</li>
<li>
<p>The demo product codes in subversion repository is <a href="http://10.0.2.59:8118/svn/gcp/Development-Area/GNDP">GNDP</a>;</p>
</li>
</ol>
<h1>Build BVT Environment</h1>
<div class="highlight"><pre><span></span><span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bvt</span><span class="o">/</span><span class="n">docs</span>
<span class="err">$</span> <span class="n">take</span> <span class="n">mybvt</span>
<span class="err">$</span> <span class="n">vagrant</span> <span class="n">box</span> <span class="n">list</span>
<span class="err">$</span> <span class="n">vagrant</span> <span class="n">init</span> <span class="n">precise64</span>
<span class="c1">// Add the following texts into Vagrantfile after the line &#39;config.vm.box = &quot;precise64&quot;:&#39;</span>
  <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">define</span> <span class="s">&quot;bs&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">bvtserver</span><span class="o">|</span>
    <span class="n">bvtserver</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s">&quot;bvt-server&quot;</span>
    <span class="n">bvtserver</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">network</span> <span class="s">&quot;private_network&quot;</span><span class="p">,</span> <span class="nl">ip</span><span class="p">:</span> <span class="s">&quot;192.168.50.3&quot;</span><span class="p">,</span>
        <span class="nl">virtualbox__intnet</span><span class="p">:</span> <span class="s">&quot;testnet&quot;</span>
    <span class="n">bvtserver</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="nl">provider</span> <span class="p">:</span><span class="n">virtualbox</span> <span class="k">do</span> <span class="o">|</span><span class="n">vbox</span><span class="o">|</span>
      <span class="n">vbox</span><span class="p">.</span><span class="n">customize</span> <span class="p">[</span><span class="s">&quot;modifyvm&quot;</span><span class="p">,</span> <span class="o">:</span><span class="kt">id</span><span class="p">,</span> <span class="s">&quot;--natnet1&quot;</span><span class="p">,</span> <span class="s">&quot;10.3/16&quot;</span><span class="p">]</span>
      <span class="n">vbox</span><span class="p">.</span><span class="n">customize</span> <span class="p">[</span><span class="s">&quot;modifyvm&quot;</span><span class="p">,</span> <span class="o">:</span><span class="kt">id</span><span class="p">,</span> <span class="s">&quot;--memory&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
    <span class="n">end</span>
    <span class="n">bvtserver</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="nl">provision</span> <span class="p">:</span><span class="n">shell</span><span class="p">,</span> <span class="nl">path</span><span class="p">:</span> <span class="s">&quot;provision.sh&quot;</span><span class="p">,</span> <span class="nl">privileged</span><span class="p">:</span> <span class="nb">false</span>
    <span class="n">bvtserver</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">network</span> <span class="s">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="nl">guest</span><span class="p">:</span> <span class="mi">9000</span><span class="p">,</span> <span class="nl">host</span><span class="p">:</span> <span class="mi">9000</span>
    <span class="n">bvtserver</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">network</span> <span class="s">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="nl">guest</span><span class="p">:</span> <span class="mi">8088</span><span class="p">,</span> <span class="nl">host</span><span class="p">:</span> <span class="mi">8088</span>
  <span class="n">end</span>
<span class="err">$</span> <span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="n">bvt</span><span class="mf">@10.0.2.47</span><span class="o">:/</span><span class="n">home</span><span class="o">/</span><span class="n">bvt</span><span class="o">/</span><span class="n">warez</span><span class="o">/</span><span class="n">bvt</span><span class="o">-</span><span class="n">package</span> <span class="n">packages</span>
<span class="err">$</span> <span class="n">vagrant</span> <span class="n">up</span> <span class="n">bs</span>
</pre></div>


<h1>Use This Environment</h1>
<ol>
<li>
<p>Open <a href="http://10.0.2.47:9000">Sonarqube website</a>, login with "admin/admin", in Settings -&gt; Qualify Profiles, add rules "TongYong" with import "tyrules.xml" on local disk (the next section its content);;</p>
</li>
<li>
<p>Open <a href="http://10.0.2.47:8088/">Jenkins website</a>;</p>
</li>
<li>
<p>Create Jenkins project: create a project named "GNDP" and add a "shell" build step: "/vagrant/bvt-gndp.sh";</p>
</li>
<li>
<p>Build this project;</p>
</li>
<li>
<p>You get the build log on jenkins website and code analysis results on sonarqube website;</p>
</li>
</ol>
<h1>Needed Scripts</h1>
<h2>Vagrant provision script</h2>
<p>This is the environment building script executed during the vagrant provision period, so it's cited in Vagrantfile.</p>
<div class="highlight"><pre><span></span>$ cat /home/bvt/docs/mybvt/provision.sh
<span class="c1">#!/bin/sh</span>

sudo ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

sudo dpkg -i /vagrant/packages/svn_amd64_ubuntu12.04/*.deb
sudo dpkg -i /vagrant/packages/zip_3.0-4_amd64.deb
sudo dpkg -i /vagrant/packages/unzip_6.0-4ubuntu1_amd64.deb
<span class="nv">APP_HOME</span><span class="o">=</span>/home/vagrant/apps
mkdir <span class="nv">$APP_HOME</span>
<span class="nb">cd</span> <span class="nv">$APP_HOME</span>
chmod <span class="m">755</span> /vagrant/packages/jdk-6u45-linux-x64.bin
sh /vagrant/packages/jdk-6u45-linux-x64.bin
tar jxf /vagrant/packages/apache-ant-1.9.3-bin.tar.bz2
unzip /vagrant/packages/sonar-3.6.1.zip

<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/home/vagrant/apps/jdk1.6.0_45/bin:/home/vagrant/apps/apache-ant-1.9.3/bin
<span class="nb">export</span> <span class="nv">LC_ALL</span><span class="o">=</span>en_US.UTF-8
<span class="nb">export</span> <span class="nv">JENKINS_HOME</span><span class="o">=</span>/home/vagrant/jenkinshome
mkdir <span class="nv">$JENKINS_HOME</span>

sonar-3.6.1/bin/linux-x86-64/sonar.sh start
nohup java -jar /vagrant/packages/jenkins-1.544.war --httpPort<span class="o">=</span><span class="m">8088</span> <span class="m">1</span>&gt;jenkins.log <span class="m">2</span>&gt;jenkins-err.log <span class="p">&amp;</span>
</pre></div>


<h2>BVT shell script</h2>
<p>This script checkout the source code to be built, then invoke the Ant script. It's cited in Jenkins project definition.</p>
<div class="highlight"><pre><span></span>$ cat /home/bvt/docs/mybvt/bvt-gndp.sh
<span class="c1">#!/bin/sh</span>

<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/home/vagrant/apps/jdk1.6.0_45/bin:/home/vagrant/apps/apache-ant-1.9.3/bin
<span class="nb">export</span> <span class="nv">LC_ALL</span><span class="o">=</span>en_US.UTF-8

<span class="nv">svnprefix</span><span class="o">=</span><span class="s1">&#39;svn co --non-interactive --no-auth-cache --username bvt_common --password password&#39;</span>
<span class="nv">svnroot</span><span class="o">=</span><span class="s1">&#39;http://10.0.2.59:8118/svn/gcp/Development-Area&#39;</span>
<span class="nv">prod</span><span class="o">=</span>GNDP
<span class="nv">$svnprefix</span> <span class="si">${</span><span class="nv">svnroot</span><span class="si">}</span>/3-SCL/Trunk/<span class="nv">$prod</span> /vagrant/codes/<span class="nv">$prod</span>

rm -rf /vagrant/codes/*.zip
<span class="nb">cd</span> /vagrant/codes/<span class="nv">$prod</span><span class="p">;</span>  ant
</pre></div>


<h2>Ant build script</h2>
<p>This script resides in the root folder of the source project GNDP in subversion repository.</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;MyJavaProj&quot;</span> <span class="na">basedir=</span><span class="s">&quot;./&quot;</span> <span class="na">default=</span><span class="s">&quot;coverage_report&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;build.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">basedir</span><span class="cp">}</span><span class="s">/build&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;init&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;delete</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
<span class="nt">&lt;/target&gt;</span>

<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;src.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">basedir</span><span class="cp">}</span><span class="s">/src&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;src.class.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/class&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;compile-src&quot;</span> <span class="na">depends=</span><span class="s">&quot;init&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;javac</span> <span class="na">srcdir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">destdir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">encoding=</span><span class="s">&quot;UTF-8&quot;</span> <span class="na">debug=</span><span class="s">&quot;true&quot;/</span><span class="nt">&gt;</span>
<span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;taskdef</span> <span class="na">classpath=</span><span class="s">&quot;cobertura.jar&quot;</span> <span class="na">resource=</span><span class="s">&quot;tasks.properties&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;instrumented.class.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/instrumented-class&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;cobertura.data.file&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">instrumented</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/cobertura.ser&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;instrument&quot;</span> <span class="na">depends=</span><span class="s">&quot;compile-src&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;cobertura</span><span class="err">-instrument</span> <span class="na">datafile=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">cobertura</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">file</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">todir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">instrumented</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;**/*.class&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/fileset&gt;</span>
    <span class="nt">&lt;/cobertura-instrument&gt;</span>
<span class="nt">&lt;/target&gt;</span>

<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;test.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">basedir</span><span class="cp">}</span><span class="s">/test&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;test.class.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/test&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;compile-test&quot;</span> <span class="na">depends=</span><span class="s">&quot;instrument&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">test</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;javac</span> <span class="na">srcdir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">test</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">destdir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">test</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;classpath&gt;</span>
            <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">instrumented</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
            <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/classpath&gt;</span>
    <span class="nt">&lt;/javac&gt;</span>
<span class="nt">&lt;/target&gt;</span>

<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;unittest.report.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/unittest_report&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;lib.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">basedir</span><span class="cp">}</span><span class="s">/lib&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;unittest&quot;</span> <span class="na">depends=</span><span class="s">&quot;compile-test&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">unittest</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;junit</span> <span class="na">printsummary=</span><span class="s">&quot;yes&quot;</span> <span class="na">fork=</span><span class="s">&quot;yes&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;sysproperty</span> <span class="na">key=</span><span class="s">&quot;net.sourceforge.cobertura.datafile&quot;</span> <span class="na">file=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">cobertura</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">file</span><span class="cp">}</span><span class="s">&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;classpath&gt;</span>
            <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">instrumented</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
            <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
            <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">test</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
            <span class="nt">&lt;pathelement</span> <span class="na">location=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;/</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">refid=</span><span class="s">&quot;lib.path&quot;/</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/classpath&gt;</span>
        <span class="nt">&lt;formatter</span> <span class="na">type=</span><span class="s">&quot;xml&quot;/</span><span class="nt">&gt;</span>
        <span class="nt">&lt;batchtest</span> <span class="na">todir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">unittest</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">haltonerror=</span><span class="s">&quot;no&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">test</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;include</span> <span class="na">name=</span><span class="s">&quot;**/*.java&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/fileset&gt;</span>
        <span class="nt">&lt;/batchtest&gt;</span>
    <span class="nt">&lt;/junit&gt;</span>
<span class="nt">&lt;/target&gt;</span>

<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;coverage.report.dir&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/coverage_report&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;coverage-report&quot;</span> <span class="na">depends=</span><span class="s">&quot;unittest&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;cobertura</span><span class="err">-report</span> <span class="na">datafile=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">cobertura</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">file</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">srcdir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">destdir=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">coverage</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="na">format=</span><span class="s">&quot;xml&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/target&gt;</span>

<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.jdbc.url&quot;</span> <span class="na">value=</span><span class="s">&quot;jdbc:h2:tcp://localhost:9092/sonar&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.jdbc.username&quot;</span> <span class="na">value=</span><span class="s">&quot;sonar&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.jdbc.password&quot;</span> <span class="na">value=</span><span class="s">&quot;sonar&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.projectKey&quot;</span> <span class="na">value=</span><span class="s">&quot;com.doco.gif.MyModule&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.projectName&quot;</span> <span class="na">value=</span><span class="s">&quot;My Unit Test Project Demo&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.projectVersion&quot;</span> <span class="na">value=</span><span class="s">&quot;2.1&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.language&quot;</span> <span class="na">value=</span><span class="s">&quot;java&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.sources&quot;</span> <span class="na">value=</span><span class="s">&quot;src&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.tests&quot;</span> <span class="na">value=</span><span class="s">&quot;test&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.binaries&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">src</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">,</span><span class="cp">${</span><span class="n">test</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">,</span><span class="cp">${</span><span class="n">build</span><span class="o">.</span><span class="n">instrument</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.dynamicAnalysis&quot;</span> <span class="na">value=</span><span class="s">&quot;reuseReports&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.surefire.reportsPath&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">unittest</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.core.codeCoveragePlugin&quot;</span> <span class="na">value=</span><span class="s">&quot;cobertura&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sonar.cobertura.reportPath&quot;</span> <span class="na">value=</span><span class="s">&quot;</span><span class="cp">${</span><span class="n">coverage</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">dir</span><span class="cp">}</span><span class="s">/coverage.xml&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;sonar&quot;</span> <span class="na">depends=</span><span class="s">&quot;coverage-report&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;taskdef</span> <span class="na">classpath=</span><span class="s">&quot;sonar-ant-task-2.1.jar&quot;</span> <span class="na">uri=</span><span class="s">&quot;antlib:org.sonar.ant&quot;</span> <span class="na">resource=</span><span class="s">&quot;org/sonar/ant/antlib.xml&quot;/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sonar:sonar</span> <span class="na">xmlns:sonar=</span><span class="s">&quot;antlib:org.sonar.ant&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>


<h2>Code Static check rules</h2>
<p>This file defines the static check rules used by Sonarqube. It's imported manually from file "tyrules.xml" on local hard disk.</p>
<div class="highlight"><pre><span></span>$ cat ~/docs/tyrules.xml

<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span> 
<span class="cp">&lt;!DOCTYPE module PUBLIC &quot;-//Puppy Crawl//DTD Check Configuration 1.3//EN&quot; &quot;http://www.puppycrawl.com/dtds/configuration_1_3.dtd&quot;&gt;</span> 
<span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;Checker&quot;</span><span class="nt">&gt;</span> 
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;severity&quot;</span> <span class="na">value=</span><span class="s">&quot;warning&quot;</span><span class="nt">/&gt;</span> 
    <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;TreeWalker&quot;</span><span class="nt">&gt;</span> 
        <span class="nt">&lt;metadata</span> <span class="na">name=</span><span class="s">&quot;net.sf.eclipsecs.core.lastEnabledSeverity&quot;</span> <span class="na">value=</span><span class="s">&quot;inherit&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;fileExtensions&quot;</span> <span class="na">value=</span><span class="s">&quot;java&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;MethodLength&quot;</span><span class="nt">&gt;</span> 
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;max&quot;</span> <span class="na">value=</span><span class="s">&quot;200&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;/module&gt;</span> 
        <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;NestedIfDepth&quot;</span><span class="nt">&gt;</span> 
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;max&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;/module&gt;</span> 
        <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;CyclomaticComplexity&quot;</span><span class="nt">/&gt;</span> 
            <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;ParameterNumber&quot;</span><span class="nt">&gt;</span> 
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;max&quot;</span> <span class="na">value=</span><span class="s">&quot;6&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;/module&gt;</span> 
    <span class="nt">&lt;/module&gt;</span> 
    <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;StrictDuplicateCode&quot;</span><span class="nt">&gt;</span> 
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;fileExtensions&quot;</span> <span class="na">value=</span><span class="s">&quot;java&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;min&quot;</span> <span class="na">value=</span><span class="s">&quot;75&quot;</span><span class="nt">/&gt;</span> 
    <span class="nt">&lt;/module&gt;</span> 
    <span class="nt">&lt;module</span> <span class="na">name=</span><span class="s">&quot;FileLength&quot;</span><span class="nt">&gt;</span> 
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;fileExtensions&quot;</span> <span class="na">value=</span><span class="s">&quot;java&quot;</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;max&quot;</span> <span class="na">value=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span> 
    <span class="nt">&lt;/module&gt;</span> 
<span class="nt">&lt;/module&gt;</span>
</pre></div>


<h1>For Unit Test</h1>
<ol>
<li>copy junit-4.*.jar, cobertura.jar and hamcrest-core-1.3.jar to $ANT_HOME/lib;</li>
</ol>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2014-06-23T13:48:47+08:00">Jun 23, 2014</time>

<h4>Last Updated</h4>
<time datetime="2014-06-23T13:48:47+08:00">Jun 23, 2014</time>

            <h4>Category</h4>
            <a class="category-link" href="http://leetschau.github.io/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://leetschau.github.io/tags.html#ant-ref">ant
                    <span>21</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#java-ref">java
                    <span>106</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#jdk-ref">jdk
                    <span>8</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#jenkins-ref">jenkins
                    <span>26</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#sonarqube-ref">sonarqube
                    <span>1</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#subversion-ref">subversion
                    <span>4</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#vagrant-ref">vagrant
                    <span>12</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#vm-ref">vm
                    <span>5</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>