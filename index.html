
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="1
2
3
4
5
6
7
8
9
10
11
12
13
$ sudo apt-get update ... W: Failed to fetch http://ppa.launchpad.net/hzwhuang/ss-qt5/ubuntu/dists/trusty/main/binary- &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>The technical blog of Li Chao in Beijing</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/11/11/114228/">Ubuntu 14.04 Apt Update Failure</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-11-11T11:42:28+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:42 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get update
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>W: Failed to fetch http://ppa.launchpad.net/hzwhuang/ss-qt5/ubuntu/dists/trusty/main/binary-amd64/Packages  Hash Sum mismatch
</span><span class='line'>
</span><span class='line'>W: Failed to fetch http://archive.canonical.com/ubuntu/dists/trusty/partner/source/Sources  Hash Sum mismatch
</span><span class='line'>
</span><span class='line'>W: Failed to fetch http://archive.canonical.com/ubuntu/dists/trusty/partner/binary-amd64/Packages  Hash Sum mismatch
</span><span class='line'>
</span><span class='line'>W: Failed to fetch http://archive.canonical.com/ubuntu/dists/trusty/partner/binary-i386/Packages  Hash Sum mismatch
</span><span class='line'>
</span><span class='line'>E: Some index files failed to download. They have been ignored, or old ones used instead.</span></code></pre></td></tr></table></div></figure>


<p>首先尝试了下面的命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo rm -rf /var/lib/apt/lists/*
</span><span class='line'>sudo apt-get clean
</span><span class='line'>sudo apt-get autoclean
</span><span class='line'>sudo apt-get autoremove</span></code></pre></td></tr></table></div></figure>


<p>再次执行<code>sudo apt-get update</code>错误依然存在，按照上面报错的内容，
在<code>/etc/apt/sources.list</code>文件中注释掉了包含<code>canonical</code>的项，
在<code>/etc/apt/sources.list.d/</code>下把<code>hzwhuang-ss-qt5-trusty.list</code>
重命名为<code>hzwhuang-ss-qt5-trusty.list.old</code>，再次执行<code>sudo apt-get update</code>通过。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/11/05/083438/">Use Matplotlib in Python 3 on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-11-05T08:34:38+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>8:34 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On Ubuntu 14.04, Python 3.4.3.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /path/to/your/project
</span><span class='line'>sudo apt-get install python3.4-venv libfreetype6-dev python3-tk
</span><span class='line'>python3 -m venv pyplot
</span><span class='line'>source ./pyplot/bin/activate
</span><span class='line'>pip install --upgrade setuptools  # optional?
</span><span class='line'>pip install matplotlib</span></code></pre></td></tr></table></div></figure>


<p>Verify installation:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /path/to/your/project/pyplot
</span><span class='line'>cat &lt;&lt; EOF &gt; plot.py
</span><span class='line'>import matplotlib.pyplot as plt
</span><span class='line'>plt.plot([1,23,2,4])
</span><span class='line'>plt.ylabel('some numbers')
</span><span class='line'>plt.show()
</span><span class='line'>EOF
</span><span class='line'>source ./pyplot/bin/activate
</span><span class='line'>python plot.py</span></code></pre></td></tr></table></div></figure>


<p>Use matplotlib in shell script:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat &lt;&lt; EOF &gt; plot.sh
</span><span class='line'>#!/bin/bash
</span><span class='line'>source /path/to/your/project/pyplot/bin/activate
</span><span class='line'>python /path/to/your/project/plot.py
</span><span class='line'>EOF
</span><span class='line'>chmod 755 plot.sh
</span><span class='line'>./plot.sh</span></code></pre></td></tr></table></div></figure>


<p>Ref:</p>

<ul>
<li><a href="http://stackoverflow.com/questions/25674612/ubuntu-14-04-pip-cannot-upgrade-matplotllib">http://stackoverflow.com/questions/25674612/ubuntu-14-04-pip-cannot-upgrade-matplotllib</a></li>
<li><a href="http://stackoverflow.com/questions/11425106/python-pip-install-fails-invalid-command-egg-info">http://stackoverflow.com/questions/11425106/python-pip-install-fails-invalid-command-egg-info</a></li>
<li><a href="http://stackoverflow.com/questions/8605847/how-to-install-matplotlib-with-python3-2">http://stackoverflow.com/questions/8605847/how-to-install-matplotlib-with-python3-2</a></li>
<li><a href="http://stackoverflow.com/questions/36327134/matplotlib-error-no-module-named-tkinter">http://stackoverflow.com/questions/36327134/matplotlib-error-no-module-named-tkinter</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/31/171345/">理解IP地址和CIDR</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-31T17:13:45+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>5:13 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>以<code>172.16.0.0/12</code>为例，<code>12</code>表示网络ID的位数，由于IPv4地址由4个8位二进制数字组成，
所以后面20位就是主机ID了，也就是：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0000 0000.0000 0000.0000 0000.0000 0000
</span><span class='line'>-------------- ------------------------
</span><span class='line'>   网络ID             主机ID</span></code></pre></td></tr></table></div></figure>


<p><code>172.16.0.0/12</code>第二段<code>16</code>写成二进制是<code>0001 0000</code>，所以这个地址代表的主机IP地址
范围是：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(172).0001 0000.0000 0000.0000 0000 ~ (172).0001 1111.1111 1111.1111 1111</span></code></pre></td></tr></table></div></figure>


<p>也就是<code>172.16.0.0 ~ 172.31.255.255</code>.</p>

<p>同理可知：<code>172.16.0.0/24</code>表示的IP地址范围是：<code>172.16.0.0 ~ 172.16.0.255</code>.
<code>172.16.0.0/16</code>表示的IP地址范围是：<code>172.16.0.0 ~ 172.16.255.255</code>.</p>

<p>参考：
<a href="https://my.oschina.net/lgscofield/blog/110949">如何计算IP地址及CIDR</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/25/110137/">保证Docker的输入参数可执行</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-25T11:01:37+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:01 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>写Docker的entrypoint时有个问题是：
Docker启动后如果用户的cmd参数以可执行命令开头，
这个命令覆盖entrypoint中的可执行命令，否则执行的是<code>entrypoint cmd</code>。</p>

<p>怎样实现entrypoint对cmd是否可执行的判断？</p>

<p><a href="https://github.com/appropriate/docker-curl">appropriate/docker-curl</a>中的
latest/entrypoint.sh脚本给出了一种实现方法：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/sh
</span><span class='line'>set -e
</span><span class='line'>
</span><span class='line'># Prepend "curl" if the first argument is not an executable
</span><span class='line'>if ! type -- "$1" &&gt; /dev/null; then
</span><span class='line'>  set -- curl "$@"
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>exec "$@"</span></code></pre></td></tr></table></div></figure>


<p>这段脚本的功能是：如果用户在run这个image时，cmd是以可执行命令（或者文件）开头
（例如cmd是<code>curl www.google.com</code>），那么执行这个cmd，否则
（例如cmd是<code>www.google.com</code>）给这个cmd前面加上<code>curl</code>再执行。</p>

<p>根据<a href="http://linuxcommand.org/lc3_man_pages/seth.html">set manpage</a>，
上面脚本第2行<code>set -e</code>的意思是如果执行过程中出现错误直接退出。</p>

<p>第5行用于判断cmd的第一部分是否为可执行命令，如果是跳到最后一行直接执行cmd整体，
否则在<code>$@</code>前面加上<code>curl</code>，然后再执行。</p>

<p>第5行中的<code>--</code>的作用是避免<code>$1</code>以横杠开头时干扰<code>type</code>的判断，在bash中做如下实验：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ type ls &&gt; /dev/null         # return 0
</span><span class='line'>$ type -p ls &&gt; /dev/null     # return 0
</span><span class='line'>$ type -- -p ls &&gt; /dev/null  # return 1</span></code></pre></td></tr></table></div></figure>


<p>可以看到，当cmd是<code>-p ls</code>时（第2条语句），如果不加<code>--</code>，
整个<code>type -p ls</code>的返回结果是0（因为<code>-p</code>被当成了<code>type</code>的选项），
但<code>-p</code>显然不是可执行命令，所以<code>--</code>是必需的。</p>

<p><code>&amp;</code>将命令变为后台运行，<code>&gt; /dev/null</code>去掉所有输出，二者组合起来的意思是：
不要任何输出，只告诉我命令执行是否成功了（返回值0表示成功，否则表示失败）。
做如下实验（假设当前目录下有<code>docs</code>子目录，没有<code>aaa</code>子目录）：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd docs
</span><span class='line'>cd docs &
</span><span class='line'>cd docs &&gt;/dev/null
</span><span class='line'>cd aaa
</span><span class='line'>cd aaa &
</span><span class='line'>cd aaa &&gt;/dev/null</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/20/113258/">为vim增加undo功能</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-20T11:32:58+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:32 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>vim 7.3+后对undo功能有了很大改进，配合<a href="https://github.com/mbbill/undotree">undotree</a>
可以实现完全记录本地改动。</p>

<h1>安装和配置</h1>

<p>手工创建vim的undo持久化目录：<code>mkdir -p $HOME/.vim/undo</code>.</p>

<p>在.vimrc中增加：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>" undo & undotree configs
</span><span class='line'>set undodir=$HOME/.vim/undo/ "make sure this folder exists
</span><span class='line'>set undofile
</span><span class='line'>cabbrev ut UndotreeToggle&lt;CR&gt;
</span><span class='line'>
</span><span class='line'>Plugin 'mbbill/undotree'</span></code></pre></td></tr></table></div></figure>


<p>并安装：<code>vim +PluginClean +PluginInstall</code>.</p>

<h1>使用</h1>

<p>使用<code>:ut</code>打开/关闭undotree窗体；
在undotree窗体中，用<code>?</code>打开/关闭帮助信息。
查看完整的使用说明：<code>:h undotree.txt</code></p>

<h1>Note</h1>

<p>由于使用纯vimscript而不是Python，undotree比<a href="http://sjl.bitbucket.org/gundo.vim/">Gundo</a>更轻便。</p>

<p>在.vimrc中可以通过<code>undolevels</code>和<code>undoreload</code>设置，默认值似乎是100.</p>

<p>参考：</p>

<ul>
<li><p><a href="http://vimdoc.sourceforge.net/htmldoc/options.html#">http://vimdoc.sourceforge.net/htmldoc/options.html#</a>&lsquo;undolevels&rsquo;</p></li>
<li><p><a href="http://stackoverflow.com/questions/5700389/using-vims-persistent-undo">http://stackoverflow.com/questions/5700389/using-vims-persistent-undo</a></p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/19/185245/">翻译书籍的步骤</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-19T18:52:45+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>6:52 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>制作生词表</h1>

<ol>
<li><p>通读全书并记录生词。找到的生词记在这本书的repo下面的 <em>newords</em> 文件里，
每行一个，通读时朗读，加深对全书的印象；</p></li>
<li><p>排序、剃重并生成释义。保存在 <em>exp.txt</em> 文件中：
<code>paste &lt;(cat newwords|sort|uniq) &lt;(cat newwords|sort|uniq|trans -b :zh) &gt; exp.txt</code></p></li>
<li><p>修改错误。大多数错误是 <em>translate-shell</em> 找不到待翻译词（词组）的释义，
返回了原文，例如 <em>noumena</em>，是 <em>noumenon</em> 的复数形式；</p></li>
<li><p>排版。打开文本文件：<code>libreoffice exp.txt</code>，主菜单 <em>Format -> Columns</em> 中选择两列，
字体调整为 <em>Ubuntu 13号</em>；</p></li>
<li><p>打印。生成PDF文件：主菜单 <em>File -> Export as PDF</em>，然后打印此文件；</p></li>
</ol>


<h1>合并编辑的修改</h1>

<p>图灵社区的编辑使用MS Office Word对译稿做审批，所以我也需要用Word来接受/拒绝这些审批。
在Word里修改好的译稿对着原始的md文档，把格式标识符加上，比如标注段落的<code>#</code>，
标注源代码的反引号等等，也就是把Word中的文字当纯文本对待，然后拷贝到md文档里。</p>

<h1>OCR</h1>

<h2>Linux</h2>

<p>试了几个OCR软件，<code>gocr</code>是OCR引擎，识别出来的文字错误太多；OCRFeeder是OCR GUI，
后端可以使用gocr和tesseract。安装了ocrad，提示无法识别png文件，换成bmp还是不行。</p>

<p><code>tesseract</code>的识别正确率较高，但遇到页面字体有变形（比如书页的里侧）时效果会变得很差。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt install tesseract-ocr ocrfeeder</span></code></pre></td></tr></table></div></figure>


<h3>使用</h3>

<h4>命令行</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tesseract -l eng att1.png stdout</span></code></pre></td></tr></table></div></figure>


<h4>图形界面</h4>

<p>启动 <em>OCRFeeder</em>，在主菜单里：<em>Tools -> OCR Engines</em>里面点击 <em>detect</em> 按钮，
找到 <em>tesseract</em> 引擎，在 <em>Edit -> Preferences -> Tools -> OCR Engines</em>
里选择 <em>tesseract</em>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/16/174235/">启动Console后自动进入tmux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-16T17:42:35+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>5:42 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>如果希望启动Console后自动进入tmux环境，可以将这个Console的起始命令设置为
自动attach到一个名为<code>default</code>的tmux session里。</p>

<p>这么做的好处是每次启动Console后，就进入了<code>default</code> session，避免每次手工attach tmux,
坏处是这个Console彻底与tmux绑定，除了修改profile，无法进入没有tmux的状态
（因为退出tmux也就退出了Console）。</p>

<p>所以推荐的做法是除了系统自带的Console软件（Ubuntu上是<code>gnome-terminal</code>），
再安装一个专门用来配合tmux的Console软件，我用的是<code>terminator</code>，
大多数情况下使用terminator + tmux，只有在ssh到其他服务器上使用tmux的时候，
启动系统自带的Console，</p>

<p>配置terminator启动自动进入tmux session <em>default</em>:</p>

<p>在terminator的 <em>Preferences -> Profiles -> Command</em> 标签页中：
check <em>Run a custom command instead of my shell</em>，
并输入 <em>Custom command</em>: <code>tmux new -A -s default</code>
（确认已经预先安装了<code>tmux</code>）。</p>

<p>但是这样配置导致无法创建新的tmux session，所以暂时不使用这种方法。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/08/222904/">使用markdown编写技术文档</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-08T22:29:04+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:29 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>使用markdown编写技术文档的要求是：</p>

<ol>
<li><p>能导出为PDF文件；</p></li>
<li><p>能编写数学公式，</p></li>
<li><p>能在保存md文件后实时看到修改后的渲染效果。</p></li>
</ol>


<p>下面的几款工具都是web server，将md文档渲染为html页面，
定稿后通过浏览器的打印为PDF功能导出为PDF文件。</p>

<h1>markmon</h1>

<p><a href="https://github.com/yyjhao/markmon">markmon</a>是一款基于node的实时预览工具。
优点是配合pandoc，可以识别mathjax格式的数学公式
它本身没有markdown和mathjax parser，需要单独安装：
<code>apt install pandoc</code>（pandoc内置了对mathjax的支持），
<code>node.js</code>建议通过<code>nvm</code>安装，这些准备好后开始安装markmon：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir ~/apps/markmon
</span><span class='line'>cd ~/apps/markmon
</span><span class='line'>npm install markmon</span></code></pre></td></tr></table></div></figure>


<p>在~/.bash_aliases中加入：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>alias mkm="node $HOME/apps/markmon/node_modules/markmon/bin/markmon"</span></code></pre></td></tr></table></div></figure>


<p>预览markdown文档：
<code>mkm myfile.md</code>启动一个node web服务，监听<code>localhost:3000</code>端口，
用浏览器打开就可以看到渲染效果了。</p>

<p>下面是一个示例myfile.md文件，其中的数学公式和多层列表都可以被正确解析：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Chapter 1
</span><span class='line'>
</span><span class='line'>This is chapter 1.
</span><span class='line'>
</span><span class='line'>&gt; some quotes here
</span><span class='line'>
</span><span class='line'>Equation 1: $\Delta w_j = \eta (y^{(i)} - \hat{y}^{(i)}) x^{(i)}_j$
</span><span class='line'>
</span><span class='line'>Equation 2: $f(x)=\sum_{n=0}^\infty\frac{f^{(n)}(a)}{n!}(x-a)^n$
</span><span class='line'>
</span><span class='line'>Equation 3:
</span><span class='line'>
</span><span class='line'>$$\sum_{i=0}^n i^2 = \frac{(n^2+n)(2n+1)}{6}$$
</span><span class='line'>
</span><span class='line'>This is conclusion.
</span><span class='line'>
</span><span class='line'># Chapter 2
</span><span class='line'>
</span><span class='line'>1. line 1
</span><span class='line'>    i. subline 1
</span><span class='line'>    i. subline 2
</span><span class='line'>    i. subline 3
</span><span class='line'>    i. subline 4
</span><span class='line'>    i. subline 5
</span><span class='line'>    i. subline 6
</span><span class='line'>1. line 2</span></code></pre></td></tr></table></div></figure>


<h1>grip</h1>

<p><a href="https://github.com/joeyespo/grip">grip</a>是一个预览markdown文件的工具，
通过<code>pip install grip</code>安装，不能识别数学公式，markmon，</p>

<p>这是一个Server/Client结构的应用，使用<code>grip myfile.md</code>启动web服务，
保存修改后的md文件会自动在<code>http://localhost:6419</code>上反映出来。</p>

<p>适合两个屏幕一个写md文件，一个开web browser预览效果。</p>

<p>配合 <strong>Dark Reader</strong> 和 <strong>Morpheon Dark</strong> 这两个Chrome插件，
浏览器也变成了暗色。</p>

<p>在Evince (PDF viewer)里，用快捷键<code>Ctrl-I</code>切换明暗配色。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/07/223030/">加速pip下载速度</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-07T22:30:30+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:30 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>有时候使用<code>pip</code>安装第三方库时，下载速度很慢，导致经常因为超时安装失败。
解决方法是修改<code>pip</code>安装源，指向一个本地的安装源，下面以安装csvkit库为例说明。</p>

<ol>
<li><p>打开<a href="https://pypi-mirrors.org/">PyPI Mirror Status</a>，选择一个本地（北京）的安装源；</p></li>
<li><p>打开对应的网址，例如<a href="https://pypi.douban.com/">豆瓣的pip镜像</a>，下面会有一个
名为<code>simple</code>的文件夹，看下面有没有<code>csvkit</code>目录，如果有，说明这个源可用，
简单的方法是在源的URL后直接加<code>simple/csvkit</code>：<code>https://pypi.doubanio.com/simple/csvkit</code>
看这个地址是否存在；</p></li>
<li><p>确认源存在后，加<code>-i</code>参数安装：<code>pip install --user -i https://pypi.doubanio.com/simple/ csvkit</code>;</p></li>
</ol>


<p>说明：</p>

<p>用<code>pip install --help</code>查看参数使用说明。网上有说加<code>--use-mirrors</code>参数自动选择镜像，
但Ubuntu 16.04上安装的<code>pip</code>并没有<code>--use-mirrors</code>这个参数（用<code>pip -V</code>查询：
pip 8.1.2 on Python 2.7）。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/02/223400/">Multiple Cursors in Vim</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-02T22:34:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>10:34 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Use plugin <a href="https://github.com/terryma/vim-multiple-cursors">vim-multiple-cursors</a>.</p>

<p>Install this plugin with adding <code>Plugin 'terryma/vim-multiple-cursors'</code>
into .vimrc.</p>

<p>The default key mappings is C-n for start multiple cursors and move to next,
C-p for previous, C-x to skip, and <ECS> for quit.
For C-n conflicts with nerdtree, modify the nerdtree trigger to <code>C-i</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nnoremap &lt;C-i&gt; :NERDTreeTabsToggle&lt;CR&gt;</span></code></pre></td></tr></table></div></figure>


<p>Note:</p>

<p>Do <strong>not</strong> map &lsquo;next/previous&rsquo; to C-j/k as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>" multiple cursors configs
</span><span class='line'>let g:multi_cursor_next_key='&lt;C-j&gt;'
</span><span class='line'>let g:multi_cursor_prev_key='&lt;C-k&gt;'</span></code></pre></td></tr></table></div></figure>


<p>for C-j/k is mapped to keys jumping between windows.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/11/11/114228/">Ubuntu 14.04 Apt Update Failure</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/05/083438/">Use Matplotlib in Python 3 on Ubuntu</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/31/171345/">理解IP地址和CIDR</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/25/110137/">保证Docker的输入参数可执行</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/20/113258/">为vim增加undo功能</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
