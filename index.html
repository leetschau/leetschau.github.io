
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="newfairs-v3 is the container project. newfairs-core is a package. meteor create newfairs-v3
cd newfairs-v3
meteor create --package newfairscommerce: &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/24/185036/">Add a Local Meteor Package</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-24T18:50:36+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>6:50 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>newfairs-v3 is the container project. newfairs-core is a package.</p>

<pre><code>meteor create newfairs-v3
cd newfairs-v3
meteor create --package newfairscommerce:core
cp -r ../newfairs-core packages
mv packages/core/{package.js,README.md} packages/newfairs-core/
rm -rf package/core
meteor add newfairscommerce:core
</code></pre>

<p>Then you have to define dependencies for this package with adding some
<code>api.use()</code> and loading order by adding some <code>api.addFiles(...)</code>
in packages/newfairs-core/package.js.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/23/123748/">Stack Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-23T12:37:48+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>12:37 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Install</h1>

<p>Install <a href="https://github.com/commercialhaskell/stack">stack</a> and start a demo yesod web server:</p>

<pre><code>wget -q -O- https://s3.amazonaws.com/download.fpcomplete.com/ubuntu/fpco.key | sudo apt-key add -
echo 'deb http://download.fpcomplete.com/ubuntu/trusty stable main'|sudo tee /etc/apt/sources.list.d/fpco.list
sudo apt-get update &amp;&amp; sudo apt-get install stack -y
cd ~/docs/playground
stack new myHaskellProj yesod-sqlite  // very slow, 30 minutes or so
stack install yesod-bin cabal-install --install-ghc
stack build  // if it's interupteed by "FailedConnectionException s3.amazonaws.com 443" error, run this command again
stack exec -- yesod devel
</code></pre>

<p>Now open &ldquo;<a href="http://localhost:3000/">http://localhost:3000/</a>&rdquo;.</p>

<h1>Run Haskell Code</h1>

<p>To start a ghci, in any folder, run:</p>

<pre><code>stack ghci
Prelude&gt; putStrLn "hello world"
</code></pre>

<p>To run haskell script: in any folder, run</p>

<pre><code>$ cat hello.hs
main = putStrLn "hello world"
$ stack runghc hello.hs
</code></pre>

<h1>Editor Setup</h1>

<p>Ref: <a href="http://seanhess.github.io/2015/08/05/practical-haskell-editors.html">PRACTICAL HASKELL - EDITOR SETUP WITH STACK</a>.</p>

<pre><code>cd ~
stack setup
stack install hdevtools
stack path|grep ghc      # to get the ghc binary path used below
</code></pre>

<p>Add <code>PATH=$PATH:$HOME/.stack/programs/x86_64-linux/ghc-7.10.2/bin:$HOME/.local/bin</code> into ~/.zshenv.</p>

<p>Install syntastic and &lsquo;bitc/vim-hdevtools&rsquo; plugin for vim:</p>

<p>add the following 2 lines into ~/.vimrc:</p>

<pre><code>Plugin 'scrooloose/syntastic'
Plugin 'bitc/vim-hdevtools'
</code></pre>

<p>then run <code>vim +PluginInstall</code>.</p>

<p>Now your .hs files will be checked when saving.</p>

<p>To verify, create hello.hs as follows:</p>

<pre><code>main = do
  print "What is your name?"
  name &lt;- getLine
  print ("Hello " ++ name ++ "!")
</code></pre>

<p>When cursor on &ldquo;print&rdquo; in the 2nd line, run <code>:HdevtoolsType</code>
(which equivalent to run <code>hdevtools type hello.hs 2 3</code> in shell),
you should get &ldquo;[Char] -> IO ()&rdquo;.</p>

<p>For convenient, add the following shortcuts into ~/.vimrc:</p>

<pre><code>" hdevtools setup (haskell)
au FileType haskell nnoremap &lt;buffer&gt; &lt;F3&gt; :HdevtoolsType&lt;CR&gt;
au FileType haskell nnoremap &lt;buffer&gt; &lt;silent&gt; &lt;F4&gt; :HdevtoolsClear&lt;CR&gt;
</code></pre>

<p>Add &ldquo;this&rdquo; at the end of file from column 3 and save
(which is equivalent to run <code>hdevtools check hello.hs</code> in shell),
a &ldquo;Not in scope: ‘this’&rdquo; error will raises.</p>

<p>See <a href="https://github.com/schell/hdevtools">hdevtools</a> and
<a href="https://github.com/bitc/vim-hdevtools">bitc/vim-hdevtools</a> for more information.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/22/104351/">Using Webstorm as Meteor IDE</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-22T10:43:51+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>10:43 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Terminal</h1>

<p>In editor, use &ldquo;Alt-F12&rdquo; to activate terminal.
In terminal, use &ldquo;Shift-ESC&rdquo; or &ldquo;Alt-F12&rdquo; to go back to editor.
Double click terminal title bar to maximize the terminal panel.</p>

<p>Only run Meteor server in Webstorm&rsquo;s terminal.
Run all other terminal work (such as mongod, git, etc) in a external terminal.
Use &ldquo;Alt-Tab&rdquo; to switch between external terminal and Webstorm.</p>

<h1>Navigattion</h1>

<p>Toggle file browse pane with &ldquo;Alt-1&rdquo;.</p>

<p>Focus editor with &ldquo;ESC&rdquo;.</p>

<h1>Editor</h1>

<p>Split vertically/horizontally;</p>

<h2>Vim Plugin</h2>

<p>Install IdeaVim in [Settings -> Plugins] (open it with Ctrl-Shift-A).</p>

<p>Open/close it in [Tools -> Vim Emulator], or &ldquo;Alt-T Ctrl-Alt-V&rdquo;.</p>

<p>Close editor tab: :q</p>

<h1>Frequently Used Shortcuts</h1>

<p>Double shift: search everything;</p>

<p>Shift-Ctrl-N: search and open files;</p>

<p>Shift-Ctrl-A: search and run commands;</p>

<p>Alt-Left/Right: switch between editor tabs;</p>

<p>Ctrl-Shift-Enter: complate statement;</p>

<p>See [Help -> Default Keymap Reference] for all.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/22/092543/">Autosave in Webstorm</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-22T09:25:43+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>9:25 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Autosave related settings of Webstorm 10.0.4 are mostly in
[Settings -> Appearance &amp; Behavior -> System Settings -> Synchronization].</p>

<p>By default the &ldquo;Save files automatically &hellip;&rdquo; is unchecked.
So Webstorm will not save file changes before you press Ctrl-S.
<strong>But</strong> &ldquo;Save files on frame deactivation&rdquo; is checked.
So if you switch to another application other than Webstorm,
all changes unsaved will be saved to disk.
<strong>However</strong>, when you modify file A without save,
and switch to another tab to edit file B,
file A will not be saved, because this is not &ldquo;frame deactivation&rdquo; (why?).</p>

<p>This is convenient for Meteor development.
You can modify many files without save.
As you switch to browser, Webstorm will save all changes to disk,
then Meteor detects file changes and refreshes pages in browser.</p>

<p>In Webstorm 10.0.4 the Linux version,
the blue color of changed tabs is subtle (compared with that on Windows or Mac),
check &ldquo;Mark modified tabs with asterisk&rdquo;
in [Settings -> Editor -> General -> Editor Tabs] to make unsaved tabs easier to identify.</p>

<p>Finally note that &ldquo;Ctrl-S&rdquo; in Webstorm is &ldquo;save all&rdquo; instead of &ldquo;save&rdquo;.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/21/092600/">Convert a Folder Into Meteor App in Webstorm</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-21T09:26:00+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2015</span></span> <span class='time'>9:26 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>You&rsquo;ve cloned a repo from remote host into foler &ldquo;$HOME/docs/myapp&rdquo;.
So you can&rsquo;t use <code>meteor create myapp</code> to build a new Meteor app.</p>

<p>You can create this &ldquo;myapp&rdquo; under /tmp,
and <code>cp -r /tmp/myapp/.meteor $HOME/docs/myapp/</code>.</p>

<p>Now open $HOME/docs/myapp in Webstorm,
it&rsquo;s been a Meteor app already.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/20/212102/">Generate Random Date After a Specified Date</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-20T21:21:02+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:21 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The following codes can display a random date within a month after the specified fair date.</p>

<pre><code>$ meteor create randomDate
$ cd randomDate
$ meteor add momentjs:moment
$ cat randomDate.html
&lt;head&gt;
  &lt;title&gt;Random Date&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
  在 展会日期 输入框中输入日期，例如：2015-05-25，然后点击 评论 按钮。
  &lt;hr&gt;

&lt;/body&gt;

&lt;template name="DatePanel"&gt;
  &lt;label&gt;展会日期：&lt;/label&gt;
  &lt;input type="text" id="fairDate"&gt;
  &lt;button&gt;评论&lt;/button&gt;
  &lt;p&gt;评论添加日期：&lt;/p&gt;
&lt;/template&gt;

$ cat randomDate.js
if (Meteor.isClient) {
  Template.DatePanel.helpers({
    commentDate: function () {
      return Session.get('commentDate');
    }
  });

  Template.DatePanel.events({
    'click button': function (e, t) {
      var dateStr = t.find("#fairDate").value;
      var fairDate = moment(dateStr);
      var randomDays = Math.floor((Math.random() * 30) + 1);
      var commentDate = fairDate.add(randomDays, 'days');
      var commStr = commentDate.format("YYYY-MM-DD");
      Session.set('commentDate', commStr);
    }
  });
}

$ meteor
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/16/101529/">A JavaScript Closure Demo</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-16T10:15:29+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:15 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>下面的代码演示了JavaScript中的闭包：</p>

<pre><code>$ cat test.js
x = 100;
inc = function(){
  var x = 0;
  return function(){
    console.log(x++);
  };
};
inc1 = inc();
inc2 = inc();

$ node
&gt; require('./test.js')
{}
&gt; x
100
&gt; inc
[Function]
&gt; inc1
[Function]
&gt; inc2
[Function]
&gt; inc1()
0
undefined
&gt; inc1()
1
undefined
&gt; inc1()
2
undefined
&gt; inc2()
0
&gt; inc2()
1
undefined
&gt; inc2()
2
undefined
&gt; inc2()
3
undefined
&gt; inc2()
4
undefined
&gt; inc1()
3
undefined
&gt; inc()
[Function]
&gt; inc()()
0
undefined
&gt; inc()()
0
undefined
</code></pre>

<p>可以看到inc2()最后一次执行时内部x值为4，
inc1不受影响，执行时依然从上次的2开始增加变成3，
所以，不同的闭包（这里是inc1和inc2）保存了自己单独的内部变量x，
其中一个变化不会影响另一个的值。</p>

<p>由于每次执行inc()返回一个新的function，所以每次执行<code>inc()()</code>都打印0。</p>

<p>参考：</p>

<p><a href="http://www.zhihu.com/question/35060711/answer/62641357?group_id=627257263421976576#comment-94699289">javascript的闭包的概念和ruby的闭包的概念有何异同？</a>.</p>

<p>&ldquo;Load and execute external js file in node.js with access to local variables?&rdquo; on StackOverflow.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/15/122519/">JSDoc Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-15T12:25:19+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:25 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>JSDoc is a documentation generator similar to JavaDoc or PHPDoc.</p>

<h1>JSDoc</h1>

<p>Install <a href="https://github.com/jsdoc3/jsdoc">JSDoc</a> with <code>npm install -g jsdoc</code>.
Generate docs with <code>jsdoc **/*.js</code>.</p>

<h1>YUIDoc</h1>

<p><a href="http://yui.github.io/yuidoc/">YUIDoc</a> is suitable for generate documentation for <a href="http://yuilibrary.com/">YUI</a>,
a JavaScript library, and no longer actively maintained.</p>

<p>It can only list modules and classes on the homepage,
which is not very suitable for general purpose jsdoc.</p>

<p>Install it with <code>npm install -g yuidocjs</code>.
Run it with <code>yuidoc .</code>.
It creates a folder named &ldquo;out&rdquo; by default in the current directory.
Open the index.html in &ldquo;out&rdquo; folder to see the doc.</p>

<h1>Editor</h1>

<p>vim with <a href="https://github.com/scrooloose/nerdcommenter">scrooloose/nerdcommenter</a>.
Use <code>&lt;leader&gt;cs</code> to add block comment.
But note that the block generated by this plugin is started by <code>/*</code>, which is invalid for jsdoc and yuidoc.
You have to add an asterisk behind it as <code>/**</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/12/233609/">Push to Github Repository With SSH Keys</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-12T23:36:09+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:36 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want push to github repository without input username and password.</p>

<ol>
<li><p>Add pub key to github account [profile -> settings -> SSH keys];</p></li>
<li><p>Set up git default user name and email address with <code>git config --global user.name</code>
and <code>git config --global user.email</code>;</p></li>
<li><p>Test ssh connection: <code>ssh -T git@github.com</code>;</p></li>
<li><p>Modify remote repo address: from <code>https://github.com/USERNAME/OTHERREPOSITORY.git</code> to
<code>git@github.com:USERNAME/OTHERREPOSITORY.git</code>, where first replace <code>https://</code> with <code>git@</code>,
then replace <code>github.com/</code> with <code>github.com:</code>.</p></li>
</ol>


<p>Now you can push to github repo (<code>git push origin master</code>) without input username and password.</p>

<p>Ref:</p>

<p><a href="http://stackoverflow.com/questions/6565357/git-push-requires-username-and-password">Git push requires username and password</a></p>

<p><a href="https://help.github.com/articles/set-up-git/#next-steps-authenticating-to-github-from-git">Set Up Git</a></p>

<p><a href="https://help.github.com/articles/generating-ssh-keys/">Generating SSH keys</a></p>

<p><a href="https://help.github.com/articles/changing-a-remote-s-url/">Changing a remote&rsquo;s URL</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/12/093754/">Change SSH Port on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-12T09:37:54+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:37 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Modify /etc/ssh/sshd_config:</p>

<ul>
<li><p>Port 22 -> 222</p></li>
<li><p>PermitRootLogin yes -> no</p></li>
<li><p>PasswordAuthentication yes -> no</p></li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/09/24/185036/">Add a Local Meteor Package</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/23/123748/">Stack Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/104351/">Using Webstorm as Meteor IDE</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/092543/">Autosave in Webstorm</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/21/092600/">Convert a Folder Into Meteor App in Webstorm</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
