<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="jupyter, rstudio, notebook, systemd, Tech, " />

<meta property="og:title" content="Python Data Analysis Environment in RStudio-Server Style "/>
<meta property="og:url" content="http://leetschau.github.io/python-data-analysis-environment-in-rstudio-server-style.html" />
<meta property="og:description" content="Demo Code Wavelet Denoise Run the folling codes as test case: import numpy as np import matplotlib.pyplot as plt import pywt original = pywt.data.camera() noiseSigma = 16.0 image = original + np.random.normal(0, noiseSigma, size=original.shape) wavelet = pywt.Wavelet(&#39;haar&#39;) levels = int(np.floor(np.log2(image …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2018-02-03T18:04:23+08:00" />
<meta property="" content="2018-10-30T09:59:41+08:00" />
<meta name="twitter:title" content="Python Data Analysis Environment in RStudio-Server Style ">
<meta name="twitter:description" content="Demo Code Wavelet Denoise Run the folling codes as test case: import numpy as np import matplotlib.pyplot as plt import pywt original = pywt.data.camera() noiseSigma = 16.0 image = original + np.random.normal(0, noiseSigma, size=original.shape) wavelet = pywt.Wavelet(&#39;haar&#39;) levels = int(np.floor(np.log2(image …">

        <title>Python Data Analysis Environment in RStudio-Server Style  · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://leetschau.github.io/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://leetschau.github.io">Home</a></li>
                            <li ><a href="http://leetschau.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://leetschau.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://leetschau.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://leetschau.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://leetschau.github.io/python-data-analysis-environment-in-rstudio-server-style.html"> Python Data Analysis Environment in RStudio-Server Style  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>Demo Code</h1>
<h2>Wavelet Denoise</h2>
<p>Run the folling codes as test case:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pywt</span>

<span class="n">original</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>

<span class="n">noiseSigma</span> <span class="o">=</span> <span class="mf">16.0</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">original</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noiseSigma</span><span class="p">,</span> <span class="kp">size</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="kp">shape</span><span class="p">)</span>

<span class="n">wavelet</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">Wavelet</span><span class="p">(</span><span class="s1">&#39;haar&#39;</span><span class="p">)</span>
<span class="n">levels</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">log2</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

<span class="n">waveletCoeffs</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">wavedec2</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>

<span class="n">threshold</span> <span class="o">=</span> <span class="n">noiseSigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">log2</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="kp">size</span><span class="p">))</span> 
<span class="n">newWaveletCoeffs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pywt</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">threshold</span><span class="p">),</span> <span class="n">waveletCoeffs</span><span class="p">))</span>
<span class="n">newImage</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">waverec2</span><span class="p">(</span><span class="n">newWaveletCoeffs</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">newImage</span><span class="p">)</span>
</pre></div>


<h1>Visual Studio Code</h1>
<p>See dsnote <em>Visual Studio Code Notes</em> for initial setup.</p>
<p>Install <em>Python Extension Pack</em> and <em>VS Code Jupyter Notebook Previewer</em>
in the <em>Extensions</em> bar.
After the Python language server pack is downloaded and installed
(see the progression in the status bar), restart VSC.</p>
<p>Now you have 3 options:</p>
<ul>
<li>
<p>shift+enter: run selected codes (or current line) in Python console
  provided by Python Extension Pack. You need specify the conda environment
  with <em>Python: Select interpreter</em> in command palette.
  Then it starts conda environment automatically. But no way to use IPython console;</p>
</li>
<li>
<p>ctrl+enter: run selected codes (or current line) in active terminal.
  This is implemented by add keyboard shortcut in user's keybindings.json file,
  see dsnote "Visual Studio Code Notes" for details.
  You need specify conda environment and start Python shell IPython console manually.
  For a <a href="https://github.com/Microsoft/vscode/issues/11281">feature (bug?)</a> of IPython,
  you can't send multiple lines to IPython shell.
  You can use bpython or ptpython shell instead (install with pip).</p>
</li>
<li>
<p>ctrl+alt+enter: run in Jupyter notebook provided by <em>VS Code Jupyter Notebook Previewer</em>.
  Output to Jupyter notebook instead of console let you see the plot right after
  the plot command (for example, <code>plt.imshow(newImage)</code> in above codes),
  without <code>plt.show()</code>, which is necessary for image show in console.</p>
</li>
</ul>
<h1>Spyder</h1>
<p>This is the most light-weight solution except bare IPython console,
It's included in Anaconda package, so no need to install.</p>
<p>The keyboard shortcuts and image display are both good.
You can jump between editor and embedded IPython console easily.
And run current line or selected block easily with Keyboard shortcuts.</p>
<p>The main problem is the lost of funding of this project(2018.9).
The developers work mainly for maintaining 3.x version,
and the lack of vim mode plugin.
(There's one on github but not published to conda).</p>
<p>See dsnote <em>Spyder Notes</em> for details.</p>
<h1>Rodeo</h1>
<p>Verified on Ubuntu 16.04.</p>
<p>Jupyter notebook has no console with notebook.
Rodeo has console with notebook in RStudio style.
But Rodeo has no server edition.
And by far Rodeo only support .py format.
You can't write Jupyter notebook in Rodeo.</p>
<p>Another problem is the Keyboard shortcuts.
Rodeo use <code>Alt-Enter</code> to run current line,
which is conflict with i3wm.
And there's NO way to customize this shortcut.</p>
<p>So Rodeo is a good exploring and analyse environment,
while Jupyter notebook is good for presenting the results.</p>
<p>I installed Rodeo's Linux editon on the server.
SSH to server from my laptop in MobaXterm and run:</p>
<div class="highlight"><pre><span></span>. activate anaconda
cd &lt;project_root&gt;
/opt/Rodeo/rodeo
</pre></div>


<p>Or set <code>python</code> path in <em>Preferences</em>, so no need to start Rodeo
in virtual environment.</p>
<p>Highlights:</p>
<ul>
<li>
<p>vim-mode in editor: [Preferences &gt; Editor &gt; Key Bindings] to <em>vim</em>;</p>
</li>
<li>
<p>Better code hints and completion of module names, function names,
  function parameters in both editor and console, than Jupyter notebook;</p>
</li>
</ul>
<p>To set working directory in session level, run <code>cd &lt;target-foder&gt;</code>
in console window. To set working directory in system level,
set the path in [Preferences &gt; Python &gt; Default Working Directory].</p>
<p>Changing the font size [Preferences &gt; Global &gt; Font Size].</p>
<p>Useful key shortcuts:</p>
<ul>
<li>
<p>Ctrl-1: jump to editor;</p>
</li>
<li>
<p>Ctrl-2: jump to console;</p>
</li>
<li>
<p>Ctrl-,: open preference window;</p>
</li>
<li>
<p>Ctrl-Enter: run the current line, or run selected multiple lines,
  which is very convenient in vim-mode;</p>
</li>
</ul>
<p>See http://rodeo.yhat.com/docs/#keyboard-shortcuts for all shortcuts.</p>
<h1>Jupyter Notebook</h1>
<p>See dsnote "Jupyter Notebook Notes".</p>
<h1>Enthought Canopy</h1>
<p>Verified on Ubuntu 16.04.</p>
<p>Likes Rodeo, this IDE puts text editor and console side by side,
so you can run the current script (Ctrl-R) or
selected text (Ctrl-Shift-R) in console easily.</p>
<p>Jump between editor and console with <code>Ctrl-Tab</code>.</p>
<p>Canopy supports image display inline.</p>
<p>To install Canopy, download the installer (a .sh file more than 600MB),
make it executable and run.
Then start Canopy with
<code>https_proxy=https://localhost:1080 http_proxy=https://localhost:1080 ./canopy</code>,
because it's package manager will be stuck without the proxy.
Canopy uses its own package manager. 
Start it in welcome page, or [Window -&gt; Package Manager] in editor.</p>
<p>Config the proxy settings in [Edit -&gt; Preferences -&gt; Network].
Choose <em>System settings</em> and click button <em>Test connection setup</em>.</p>
<p>It has no vim bindings.</p>
<p>It auto-completion looks better than Rodeo.
For example, when in a function, it can auto-complete the name of the parameters
with TAB key, while Rodeo can't.</p>
<p>It creates some folders in the home directory, which is annoying.</p>
<h1>Wing IDE</h1>
<p>To make Wing use Anaconda environment, set
[Project &gt; Project Properties &gt; Python Executable] to the python executable
in the target environment, for example:
<em>/home/leo/apps/miniconda3/envs/anaconda/bin/python</em>.
Then check it with [Source &gt; Show Python Environment &gt; Effective Python Path].</p>
<p>To use vim mode in editor, set
[Edit &gt; Preferences &gt; User Interface &gt; Keyboard &gt; Personality] to "VI/VIM".</p>
<p>To run current line or selected texts in Python console with keyboard shortcut
<em>Shift-Enter</em>, build a script (such as "myfunc.py") in the folder
"~/.wingpersonal6/scripts", which is defined at
[Edit &gt; Preferences &gt; IDE Extension Scripting &gt; Search Path].</p>
<p>In this file add the following functions:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wingapi</span>

<span class="k">def</span> <span class="nf">runCurLine</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">wingapi</span><span class="o">.</span><span class="n">gApplication</span>
    <span class="n">app</span><span class="o">.</span><span class="n">ExecuteCommand</span><span class="p">(</span><span class="s1">&#39;evaluate-sel-in-shell&#39;</span><span class="p">,</span> <span class="n">restart_shell</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">whole_lines</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">ExecuteCommand</span><span class="p">(</span><span class="s1">&#39;focus-current-editor&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">ExecuteCommand</span><span class="p">(</span><span class="s1">&#39;exit-visual-mode&#39;</span><span class="p">)</span>
</pre></div>


<p>Then in [Edit &gt; Preferences &gt; User Interface &gt; Keyboard &gt; Custom Key Bindings],
click "Insert" button.
Press <em>Shift-Enter</em> when "Key" is focused.
Input <code>runCurLine</code> in "Command" text box, which is the function name defined
in your script file.</p>
<p>To focus Pythn shell with keyboard, add the following function into your
script file:</p>
<div class="highlight"><pre><span></span>def focusShell():
    app = wingapi.gApplication
    app.ExecuteCommand(&#39;show-panel-python-shell&#39;, flash=True, grab_focus=True)
</pre></div>


<p>In [Edit &gt; Preferences &gt; User Interface &gt; Keyboard &gt; Custom Key Bindings],
click "Insert" button.
Press <em>Alt-u</em> when "Key" is focused.
Input <code>focusShell</code> in "Command" text box.</p>
<p>Or input <code>show-panel-python-shell</code> in "Command" text box,
so no need to define a custom function.</p>
<p>Now you can focus Python shell with <em>Alt-u</em>. Focus editor with <em>ESC</em> key.</p>
<p>Note:</p>
<p>Test a command Wing provided (such as <code>show-panel-python-shell</code> ),
or user-defined (such as <code>focusShell</code>) by [Edit &gt; Command by Name].</p>
<p>After modified a function, save your script file and reload it in Wing
with [Edit &gt; Reload All Scripts].</p>
<h2>Problems</h2>
<p>Wing can't embed image into the IDE environment.
The image window is a new window seperating from the IDE.
The process of drawing the image persists until you close the image window.</p>
<h1>PyCharm</h1>
<p>PyCharm's project-oriented workflow makes it suitable for project development,
instead of casual data exploration.
The latter is fit for file-oriented workflow.</p>
<p>Send current cell (a cell is a code block seperated by <code>#%%</code>, which is the same
with that in Spyder) to console with <em>Shift-Enter</em>.</p>
<p>Pycharm's <em>Scientific Mode</em> (toggle with [View &gt; Scientific Mode]) is exellent
for data exploration, for smart code auto-completion, embeded image and
documentation window.</p>
<p>Pycharm need relatively large memory resources, or it will very slow.</p>
<p>Jupyter notebook support in Pycharm is still poor.
Keyboard shortcuts doesn't work.
Connecting to Jupyterhub failed, so you can't run codes in a notebook.</p>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2018-02-03T18:04:23+08:00">Feb 3, 2018</time>

<h4>Last Updated</h4>
<time datetime="2018-10-30T09:59:41+08:00">Oct 30, 2018</time>

            <h4>Category</h4>
            <a class="category-link" href="http://leetschau.github.io/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://leetschau.github.io/tags.html#jupyter-ref">jupyter
                    <span>5</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#notebook-ref">notebook
                    <span>4</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#rstudio-ref">rstudio
                    <span>4</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#systemd-ref">systemd
                    <span>1</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>