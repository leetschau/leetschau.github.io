<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="ipython, python, shell, Tech, " />

<meta property="og:title" content="Develop Python Codes with IPython "/>
<meta property="og:url" content="http://leetschau.github.io/develop-python-codes-with-ipython.html" />
<meta property="og:description" content="Configurations Config IPython to make it loading autoreload extension automatically, and quit without confirmation: $ cat &lt;&lt; EOF &gt; ~/.ipython/profile_default/startup/50-autoreload.ipy %load_ext autoreload %autoreload 2 %config TerminalInteractiveShell.confirm_exit = False EOF If not config it globally, you can run commands above in IPython shell. Autoreload make the change to function …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2016-11-23T10:53:45+08:00" />
<meta property="" content="2019-03-08T10:34:59+08:00" />
<meta name="twitter:title" content="Develop Python Codes with IPython ">
<meta name="twitter:description" content="Configurations Config IPython to make it loading autoreload extension automatically, and quit without confirmation: $ cat &lt;&lt; EOF &gt; ~/.ipython/profile_default/startup/50-autoreload.ipy %load_ext autoreload %autoreload 2 %config TerminalInteractiveShell.confirm_exit = False EOF If not config it globally, you can run commands above in IPython shell. Autoreload make the change to function …">

        <title>Develop Python Codes with IPython  · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://leetschau.github.io/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://leetschau.github.io">Home</a></li>
                            <li ><a href="http://leetschau.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://leetschau.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://leetschau.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://leetschau.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://leetschau.github.io/develop-python-codes-with-ipython.html"> Develop Python Codes with IPython  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>Configurations</h1>
<p>Config IPython to make it loading <em>autoreload</em> extension automatically,
and quit without confirmation:</p>
<div class="highlight"><pre><span></span><span class="err">$</span> <span class="n">cat</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span> <span class="o">&gt;</span> <span class="o">~/</span><span class="p">.</span><span class="n">ipython</span><span class="o">/</span><span class="n">profile_default</span><span class="o">/</span><span class="n">startup</span><span class="o">/</span><span class="mi">50</span><span class="o">-</span><span class="n">autoreload</span><span class="p">.</span><span class="n">ipy</span>
<span class="nf">%load_ext</span> <span class="n">autoreload</span>
<span class="nf">%autoreload</span> <span class="mi">2</span>
<span class="nf">%config</span> <span class="n">TerminalInteractiveShell</span><span class="p">.</span><span class="n">confirm_exit</span> <span class="o">=</span> <span class="n">False</span>
<span class="n">EOF</span>
</pre></div>


<p>If not config it globally, you can run commands above in IPython shell.</p>
<p>Autoreload make the change to function and class method reloaded automatically
after the file saved.</p>
<h1>Workflow</h1>
<h2>Basic workflow</h2>
<p>The basic workflow is: IPython console + editor (vim),
and optionally tmux (or i3wm, etc).</p>
<p>Define one-line statements and expressions in IPython console;
Define and update function or class in IPython console with <code>%edit</code> magic;
Visualize data with:</p>
<div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>


<p>With tmux, you can create an editor pane and an IPython console pane
in a tmux window. In IPython shell, import all functions in the developed file
(name it myfile.py for example) with <code>from myfile import *</code>,
and you can use all functions of myfile in IPython shell.</p>
<p>Ref: https://ipython.org/ipython-doc/3/config/extensions/autoreload.html</p>
<h2>Live development</h2>
<p>"Live development" means writing codes at the "developing point" (DP) in
the runtime, with all variables, environments and data loaded.</p>
<h3>In PyCharm</h3>
<p>No need to add stub codes into the source file.
But you need a PyCharm IDE, which is not very keyboard friendly,
and remote develop (via SSH) is complicated.</p>
<ol>
<li>
<p>Write a unit test (with unittest or pytest) to cover the DP;</p>
</li>
<li>
<p>Add a breakpoint at the DP;</p>
</li>
<li>
<p>"Debug" the test, then the process stops at the DP;</p>
</li>
<li>
<p>Write new codes, add them to your source file;</p>
</li>
<li>
<p>Change the DP, start the next iteration of live development.</p>
</li>
</ol>
<h3>In IPython console</h3>
<p>You need only IPython console and an editor, minimal, fast and keyboard friendly.
Both OK for local and remote development.
You can exploit full functionality of IPython console, such as tab-completion,
running any valid statements and evaluating any expressions.
You can define and  edit a function with <code>%edit my_func</code> magic of IPython.
Display the function body with <code>??my_func</code>.
After the function is fulfilled, copy it to your source code.</p>
<p>But you need insert some stub codes into your source codes,
and comment out or remove them when the functions is fulfilled.</p>
<ol>
<li>
<p>Write a unit test (with unittest or pytest) to cover the DP;</p>
</li>
<li>
<p>Add <code>embed()</code> at the DP (and <code>from IPython import embed</code>);</p>
</li>
<li>
<p>Run the test with <code>python -m unittest your_module.YourClassTest.test_your_func</code>,
   then the process stops at the DP and an IPython console is fired;</p>
</li>
<li>
<p>Test your expressions in the console, if OK add them to your source file;</p>
</li>
<li>
<p>Change the DP, start the next iteration of live development.</p>
</li>
</ol>
<h3>With ipdb</h3>
<p>ipdb in IPython console is more "live" than IPython console decribed above,
for you can run the program step by step.
And the tab-completion still works well in the debugger.</p>
<p>But you can't use magic here.
So you can't edit function with <code>%edit</code>, and can't run system command with <code>!</code>.</p>
<p>See <em>ipdb</em> section in dsnote <em>Debug Python Script</em>.</p>
<h1>Debug</h1>
<p>Install <code>ipdb</code> with <code>sudo pip3 install ipdb</code>.</p>
<p>Add <code>from ipdb import set_trace</code> and <code>set_trace()</code> into myfile,
the line before the the breakpoint.</p>
<p>In IPython shell, run <code>%pdb</code> and the function.
It will stopped at the <code>set_trace()</code>. Use <code>h</code> for available commands.</p>
<p>You can add multiple <code>set_trace()</code> for multiple breakpoints.
Use <code>c</code> to jump to the next breakpoint.</p>
<h1>Other tips</h1>
<ul>
<li>
<p><code>%autocall</code>: with <code>%autocall 2</code>, you can run <code>len mylist</code>
  instead of <code>len(mylist)</code>, or <code>df.info</code> instead of <code>df.info()</code>,
  to save typing;</p>
</li>
<li>
<p><code>%load</code>: Copy text from source file into IPython console.
  You can load specific line ranges: <code>%load -r start:end myscript.py</code>.
  Or load specific functions or classes: <code>%load -s myfunc,MyClass myscript.py</code>.
  See <code>%load?</code> for details;</p>
</li>
<li>
<p><code>%quickref</code> shows a quick reference sheet;</p>
</li>
<li>
<p><code>ll</code> to list files in current directory;</p>
</li>
<li>
<p><code>%cd</code> changes working directory;</p>
</li>
<li>
<p><code>%who</code> and <code>%whos</code> list all interactive variables;</p>
</li>
<li>
<p><code>_</code> is the last command output;</p>
</li>
<li>
<p>Use <code>_oh</code> to see all output;</p>
</li>
<li>
<p><code>%edit</code> edit a string and run it, for example: <code>edit _</code>;</p>
</li>
<li>
<p><code>%time</code> is the shell command <code>time</code> equivalent;</p>
</li>
<li>
<p>Run shell command: <code>!</code> only executes a shell command.
  With <code>!!</code>, you can store the command output for later use.
  Reference the output with <code>_&lt;no&gt;</code>, for example <code>_38</code>.</p>
</li>
</ul>
<h2>Rerun some codes multiple times with <code>rerun</code></h2>
<p>The following codes show the command history and rerun the first to 3rd line:</p>
<div class="highlight"><pre><span></span><span class="nf">%hist</span> <span class="o">-</span><span class="n">n</span>
<span class="nf">%rerun</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span>
</pre></div>


<h2>Rerun some codes multiple times with macro</h2>
<p>The following codes defines a macro named "my_macro" which contains
the first to third line, the 5th and the 8th lines in history.
And run it:</p>
<div class="highlight"><pre><span></span><span class="nf">%hist</span> <span class="o">-</span><span class="n">n</span>
<span class="n">macro</span> <span class="n">my_macro</span> <span class="mi">1</span><span class="o">-</span><span class="mi">3</span> <span class="mi">5</span> <span class="mi">8</span>
<span class="n">my_macro</span>
</pre></div>


<h2>List functions with wildcard</h2>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.*</span><span class="kp">load</span><span class="o">*</span><span class="err">?</span>
<span class="n">np</span><span class="o">.</span><span class="n">__loader__</span>
<span class="n">np</span><span class="o">.</span><span class="kp">load</span>
<span class="n">np</span><span class="o">.</span><span class="kp">loads</span>
<span class="n">np</span><span class="o">.</span><span class="kp">loadtxt</span>
<span class="n">np</span><span class="o">.</span><span class="kp">pkgload</span>
</pre></div>


<h2>Run scripts in <em>Current</em> environment</h2>
<p>The variables <code>aa</code>, <code>bb</code> defined <strong>outside</strong> the script can be loaded into
the script with <code>run -i</code> magic:</p>
<div class="highlight"><pre><span></span>$ <span class="nv">cat</span> <span class="o">&lt;&lt;</span> <span class="nv">EOF</span> <span class="o">&gt;</span> <span class="nv">demo</span>.<span class="nv">py</span>
<span class="nv">def</span> <span class="nv">func2</span><span class="ss">(</span><span class="nv">x</span>, <span class="nv">y</span><span class="ss">)</span>:
    <span class="k">return</span> <span class="nv">bb</span> <span class="o">*</span> <span class="nv">x</span> <span class="o">+</span> <span class="nv">y</span>
<span class="nv">print</span><span class="ss">(</span><span class="nv">func2</span><span class="ss">(</span><span class="nv">aa</span>, <span class="mi">4</span><span class="ss">))</span>
<span class="nv">EOF</span>
$ <span class="nv">ipython</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nv">aa</span>, <span class="nv">bb</span> <span class="o">=</span> <span class="mi">3</span>, <span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nv">run</span> <span class="o">-</span><span class="nv">i</span> <span class="nv">demo</span>.<span class="nv">py</span>
<span class="mi">16</span>
</pre></div>


<p>Ref: https://ipython.org/ipython-doc/3/interactive/magics.html</p>
<h2></h2>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2016-11-23T10:53:45+08:00">Nov 23, 2016</time>

<h4>Last Updated</h4>
<time datetime="2019-03-08T10:34:59+08:00">Mar 8, 2019</time>

            <h4>Category</h4>
            <a class="category-link" href="http://leetschau.github.io/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://leetschau.github.io/tags.html#ipython-ref">ipython
                    <span>4</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#python-ref">python
                    <span>122</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#shell-ref">shell
                    <span>43</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>