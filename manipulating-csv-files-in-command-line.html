<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="csv, command line, linux, Tech, " />

<meta property="og:title" content="Manipulating CSV Files in Command Line "/>
<meta property="og:url" content="/manipulating-csv-files-in-command-line.html" />
<meta property="og:description" content="csvkit Here we manipulate csv files with csvkit. It&#39;s developed with Python. So install it with sudo pip install csvkit; Convert xls, xlsx file into csv file: in2csv input.xlsx &gt; data.csv; List column titles of a csv file: csvcut -n data.csv; Print statistic information for each columns in …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2015-01-05T17:32:53+08:00" />
<meta property="" content="2018-09-03T17:14:14+08:00" />
<meta name="twitter:title" content="Manipulating CSV Files in Command Line ">
<meta name="twitter:description" content="csvkit Here we manipulate csv files with csvkit. It&#39;s developed with Python. So install it with sudo pip install csvkit; Convert xls, xlsx file into csv file: in2csv input.xlsx &gt; data.csv; List column titles of a csv file: csvcut -n data.csv; Print statistic information for each columns in …">

        <title>Manipulating CSV Files in Command Line  · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="">Home</a></li>
                            <li ><a href="/categories.html">Categories</a></li>
                            <li ><a href="/tags.html">Tags</a></li>
                            <li ><a href="/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="/manipulating-csv-files-in-command-line.html"> Manipulating CSV Files in Command Line  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>csvkit</h1>
<p>Here we manipulate csv files with <a href="https://github.com/onyxfish/csvkit">csvkit</a>.
It's developed with Python. So install it with <code>sudo pip install csvkit</code>;</p>
<p>Convert xls, xlsx file into csv file: <code>in2csv input.xlsx &gt; data.csv</code>;</p>
<p>List column titles of a csv file: <code>csvcut -n data.csv</code>;</p>
<p>Print statistic information for each columns in a csv file: <code>csvstat data.csv</code>;</p>
<p>Pretty print the first 3 columns, first 5 rows of data:
<code>csvcut -c 1-3 agenda.csv | head -6 | csvlook</code>.</p>
<p>Print the first, second, 11th, 16th column of first 9 records
(another one for headline): <code>csvcut -c 1,2,11,16 data.csv|head</code>;</p>
<p>If there are newline characters in records, add "-l" option to make it clear:
<code>csvcut -l -c 1,2,11,16 data.csv|head</code>;</p>
<p>Convert to json file with csvjson:, <code>head fairData150104.csv|csvjson -i 4</code>,
where "-i" specify how many indent spaces, default is no indent.
Or select some collomns to show:
<code>csvcut -c 1,2,11,16 fairData150104.csv|head|csvjson -i 4</code></p>
<p>Select some columns and save to a new file:
<code>csvcut -c &lt;col-index&gt; input.csv &gt; output.csv</code>.
For example, save the 2nd and 3rd columns of file <code>276107.csv</code>
to file <code>windspeed.csv</code>: <code>csvcut -c 2,3 276107.csv &gt; windspeed.csv</code>.</p>
<h1>csvtool</h1>
<p>Install: <code>sudo aptitude install csvtool</code>;</p>
<ul>
<li>
<p>Pretty print the first 3 columns, first 5 rows of data:
  <code>csvtool col 1-3 agenda.csv | head -6 | csvtool readable -</code>.</p>
</li>
<li>
<p>csvtool sub <n1> <n2> <n3> <n4> data.csv:</p>
<p>Take a square subset of the CSV, top left at row <n1>, column <n2>,
which is <n3> deep and <n4> wide.
<n1> and <n2> count from 1, or from 0 if -z option is given.</p>
<p>Example: <code>csvtool sub 1 16 1 1 data.csv</code></p>
</li>
<li>
<p>csvtool take <n> data.csv: take first <n> rows of the csv, like "head" in shell;</p>
</li>
<li>
<p>csvtool drop <n> data.csv: drop the first <n> rows and return the rest (if any).</p>
</li>
</ul>
<p>See <code>csvtool -h</code> for details.</p>
<p>To print the <em>n</em>th record easily, add the following function into ~/.bash_alias file:</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">ctls</span><span class="p">(){</span>
  <span class="k">if</span> <span class="nx">test</span> <span class="nx">$</span><span class="err">#</span> <span class="o">-</span><span class="nx">eq</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">then</span>
    <span class="nx">csvtool</span> <span class="nx">drop</span> <span class="nx">$2</span> <span class="nx">$1</span> <span class="o">|</span> <span class="nx">csvtool</span> <span class="nx">take</span> <span class="nx">$3</span> <span class="o">-</span>
  <span class="k">else</span>
    <span class="nx">echo</span> <span class="nx">ctls</span>: <span class="kt">csvtool</span> <span class="nx">list</span> <span class="nx">specified</span> <span class="nx">record</span>
    <span class="nx">echo</span> <span class="nx">Synopsis</span>: <span class="kt">ctls</span> <span class="s1">&#39;&lt;filename&gt; &lt;startNo&gt; &lt;count&gt;&#39;</span>
  <span class="nx">fi</span>
<span class="p">}</span>
</pre></div>


<p>Now print the 3rd record of data.csv with <code>ctls data.csv 3 1</code>.</p>
<p>The "-" in "csvtool take" means "get input from stdin instead of a file".</p>
<p>Select some columns and save to a new file:
<code>csvtool col &lt;col-index&gt; input.csv &gt; output.csv</code>.
For example, save the 1,2,3 and 6th columns of input file to output file:
<code>csvtool col 1-3,6 input.csv &gt; output.csv</code>.</p>
<p>Join some files column-wise:</p>
<div class="highlight"><pre><span></span>$ cat aa.csv
col1,col2
<span class="m">11</span>,21
<span class="m">12</span>,22

$ cat bb.csv
col3,col4
<span class="m">31</span>,41
<span class="m">32</span>,42

$ csvtool paste aa.csv bb.csv 
col1,col2,col3,col4
<span class="m">11</span>,21,31,41
<span class="m">12</span>,22,32,42
</pre></div>


<h1>Put them together</h1>
<ul>
<li>
<p>Count the number of records which the 7th field is empty:
  <code>csvgrep -c 7 -r "^$" data.csv | csvtool height -</code>;</p>
</li>
<li>
<p>Count the number of records which the 7th field is NOT empty:
  <code>csvgrep -c 7 -r "^.+$" data.csv | csvtool height -</code>;</p>
</li>
<li>
<p>Pretty print all rows whose 3rd column is <em>Bob</em> in file <em>agenda.csv</em>:
  <code>csvgrep -c 3 -m 'Bob' agenda.csv| csvcut -c 1-3 | csvtool readable -</code></p>
</li>
<li>
<p>Print data on screen without line wrap: <code>less -S &lt;filename&gt;</code>;</p>
</li>
</ul>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2015-01-05T17:32:53+08:00">Jan 5, 2015</time>

<h4>Last Updated</h4>
<time datetime="2018-09-03T17:14:14+08:00">Sep 3, 2018</time>

            <h4>Category</h4>
            <a class="category-link" href="/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags.html#command-line-ref">command line
                    <span>14</span>
</a></li>
                <li><a href="/tags.html#csv-ref">csv
                    <span>3</span>
</a></li>
                <li><a href="/tags.html#linux-ref">linux
                    <span>152</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>