
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Chapter 3 Section &ldquo;The expect Command&rdquo;: expect_out(0,string) can NOT be written as &ldquo;expect_out(0, string)&rdquo;, blank before & &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/44">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leetschau.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/20/185908/">Notes About `Exploring Expect`</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-20T18:59:08+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:59 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 3</h1>

<ul>
<li><p>Section &ldquo;The expect Command&rdquo;: expect_out(0,string) can NOT be written as &ldquo;expect_out(0, string)&rdquo;, blank before &ldquo;string&rdquo; will make a mistake;</p></li>
<li><p>Concurrent matching:</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>expect {
</span><span class='line'>    item1 {send cmd1}
</span><span class='line'>    item2 {send cmd2}
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<ul>
<li>In spawn process, use &ldquo;\r&rdquo; as the return key in send command;</li>
</ul>


<h1>Chapter 5</h1>

<ul>
<li>Section &ldquo;Using Parentheses For Feedback&rdquo; give a clear and concise explanations of how to get feedback in expect.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/expect 
</span><span class='line'>set timeout 60 
</span><span class='line'>expect -re "a(.*)c" 
</span><span class='line'>send "expect_out(buffer) = ${expect_out(buffer)}\n" 
</span><span class='line'>send "expect_out(0,string) = ${expect_out(0,string)}\n" 
</span><span class='line'>send "expect_out(1,string) = ${expect_out(1,string)}\n" 
</span><span class='line'>expect -re "e" 
</span><span class='line'>send "expect_out(buffer) = ${expect_out(buffer)}\n" 
</span><span class='line'>send "expect_out(0,string) = ${expect_out(0,string)}\n" 
</span><span class='line'>send "expect_out(1,string) = ${expect_out(1,string)}\n" </span></code></pre></td></tr></table></div></figure>


<p>Run this script, input &ldquo;junk abcbcdef&rdquo; and return, will produces:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./feedback.exp 
</span><span class='line'>junk abcbcdef 
</span><span class='line'>expect_out(buffer) = junk abcbc 
</span><span class='line'>expect_out(0,string) = abcbc 
</span><span class='line'>expect_out(1,string) = bcb 
</span><span class='line'>expect_out(buffer) = de 
</span><span class='line'>expect_out(0,string) = e 
</span><span class='line'>expect_out(1,string) = bcb </span></code></pre></td></tr></table></div></figure>


<p>You can see value of &ldquo;expect_out(&hellip;)&rdquo; will be refreshed when a expect matches (expect &ldquo;e&rdquo;). &ldquo;buffer&rdquo; are all things from last buffer (&ldquo;&hellip;cbc&rdquo;) to this match (&ldquo;e&rdquo;), which is &ldquo;de&rdquo; in this case. &ldquo;0,string&rdquo; means all matching strings (note &ldquo;0, string&rdquo; will raise a exception for the redundant blank). &ldquo;1,string&rdquo; means the first subgroup of &ldquo;0,string&rdquo;. If there is no subgroup (expressed as parentheses) in current match, (1,string) remains last value (&ldquo;bcb&rdquo; in this case). Even &ldquo;f&rdquo; at the end of input has been sent to expect, it will not be added to &ldquo;buffer&rdquo;, because it&rsquo;s not a part of the current match.</p>

<h1>Chapter 6</h1>

<ul>
<li>exp_continue is useful in many circumstances. See its code example in section &ldquo;Matching Multiple Times&rdquo; in chapter 6 and section &ldquo;Prompting For A Password On Behalf Of A Program&rdquo; in chapter 8;</li>
</ul>


<h1>Chapter 7 &amp; 8</h1>

<ul>
<li><p>some frequently used command:</p>

<pre><code>  log_file: write output of spawned process to a file; 
  log_user: send output of spawned process to/not to user; 
  send_user: expect script send messages to user;

  expect_user: continue communicating with the user even after a process has been spawned; 
  send: expect script send messages to spawned process; 
  send_log: only write to log (without writing to stdout); 
  send_error: expect script send messages to stderr; 
  exp_internal: enable/disable internal diagnostics to stdout or log file (see section "Logging Internal Diagnostics"); 
</code></pre></li>
<li><p>proc sendexpect in section &ldquo;The send_error Command&rdquo; is useful;</p></li>
<li><p>right-wrong-timeout switch in section &ldquo;The expect_user Command&rdquo;:</p>

<pre><code>  expect {
      right {
      } wrong {
          send_error error_message
          exit 1
      } timeout {
          send_error "time out!"
          exit 1
      }
  }
</code></pre></li>
<li><p>A program switch between character and line mode. Notice the usage of &ldquo;stty raw&rdquo;:</p>

<pre><code>  send_user "Now we are in line mode. You can use backspace to re-input.\n" 
  send_user "Continue? y or n\n" 
  expect_user -re "y|n" 
  send_user "you press $expect_out(0,string)\n" 
  stty raw 
  send_user "Now we are in character mode. You have no chance to re-input.\n" 
  send "Continue? Enter y or n: \r\n" 
  expect -re "y|n" 
  send_user "\nyou press $expect_out(0,string)" 
</code></pre></li>
<li><p>stty should be executed during times when the user is not typing, such as before a prompt rather than after, otherwise there is possibility of losing characters while switching modes. See the end of section &ldquo;Line Versus Character-Oriented And Other Terminal Modes&rdquo;;</p></li>
<li><p>In the modified version of su2 in section &ldquo;Echoing&rdquo;, I modified &ldquo;# &rdquo; to &ldquo; #&rdquo; in the last 3rd line, because on my platform (Mint Xfce 14) there are no space after &ldquo;#&rdquo; in the prompt of root user;</p></li>
<li><p>the get password procedure in section &ldquo;Echo&rdquo; is a must-have tool;</p></li>
<li><p>If you want exact Bourne-shell semantics, the simplest way is to call system. See section &ldquo;The system Command&rdquo;;</p></li>
</ul>


<h1>Chapter 9</h1>

<h2>arguments experiment after #!</h2>

<p>The echo.exp:</p>

<p>version 1:</p>

<pre><code>#!/usr/bin/expect 
set argc [llength $argv] 
for {set i 0} {$i&lt;$argc} {incr i} { 
    puts "arg $i: [lindex $argv $i]" 
} 
</code></pre>

<p>version 2:</p>

<pre><code>#!/usr/bin/expect --
...
</code></pre>

<p>version 3:</p>

<pre><code>#!/usr/bin/expect -f
...
</code></pre>

<p>Now run command <code>./echo.exp -c "puts hello" 1 2 3</code>, the output is:</p>

<p>version 1:</p>

<pre><code>arg 0: -c 
arg 1: puts hello 
arg 2: 1 
arg 3: 2 
arg 4: 3 
</code></pre>

<p>version 2:</p>

<pre><code>arg 0: -c 
arg 1: puts hello 
arg 2: 1 
arg 3: 2 
arg 4: 3 
</code></pre>

<p>version 3:</p>

<pre><code>hello 
arg 0: 1 
arg 1: 2 
arg 2: 3 
</code></pre>

<p>So it is clear that only when &ldquo;-f&rdquo; is specified, &ldquo;-c&rdquo; means &ldquo;take my arguments as a script&rdquo;. Otherwise &ldquo;-c&rdquo; will be treated as a common arguments of the script. &ldquo;&ndash;&rdquo; explicitly stop any arguments interpreting.</p>

<h1>Chapter 17</h1>

<ul>
<li>this chapter describes how to make expect script a server;</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/20/102248/">Exercies of Chapter 2 in `Exploring Expect`</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-20T10:22:48+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:22 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><ol>
<li>Write a procedure to reverse a string. If you wrote an iterative solution, now write a recursive solution or vice versa.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh</p>

<p> # iterative solution:</p>

<p> proc rev_str_iter { input } {
  for {set idx [string length $input]} {$idx > 0} {incr idx -1} {
   append res [string index $input [expr $idx-1]]
  }
  return $res
 }
 # recursive solution:
 proc rev_str_recur { input } {
  set len [string length $input]
  if {[expr $len - 1] > 0} {
   append res [rev_str_recur [string range $input 1 end]] \
             [string index $input 0]
  } else {
   set res $input
  }
  return $res
 }
 set m &ldquo;abcdefg&rdquo;
 set n [rev_str_iter $m]
 puts $n
 set n2 [rev_str_recur $m]
 puts $n2</p>

<blockquote><ol>
<li>Repeat the previous exercise but with a list instead of a string.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh
 # iterative solution:
 proc rev_list_iter { input } {
  for {set idx [llength $input]} {$idx > 0} {incr idx -1} {
   lappend res [lindex $input [expr $idx-1]]
  }
  return $res
 }
 # recursive solution:
 proc rev_list_recur { input } {
  set len [llength $input]
  if {[expr $len - 1] > 0} {
   set res [concat [rev_list_recur [lrange $input 1 end]] [lindex $input 0]]
  } else {
   set res $input
  }
  return $res
 }
 set m &ldquo;a b c d e g&rdquo;
 set n [rev_list_iter $m]
 puts $n
 set n2 [rev_list_recur $m]
 puts $n2</p>

<blockquote><ol>
<li>Write a procedure to rename all the files in a directory ending with .c to names ending in &ldquo;.cc“.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh
 foreach file_name [glob *.c] {
  file rename $file_name [append file_name c]
 }</p>

<blockquote><ol>
<li>Write a procedure that takes a list of variable names and a list of values, and sets each variable in the list to the respective value in the other list. Think of different alternatives to handle the case when the lists are of different lengths.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh
 proc assign {names values} {
  if {[llength $names] > [llength $values]} {
   set len [llength $values]
  } else {
   set len [llength $names]
  }
  for {set idx 0} {$idx&lt;$len} {incr idx} {
   set var_name [lindex $names $idx]
   set $var_name [lindex $values $idx]
   puts [concat $var_name = [set $var_name]]
  }
 }
 set names &ldquo;za bb ee dk&rdquo;
 set values &ldquo;11 32 53 94 5&rdquo;
 assign $names $values</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/20/101843/">Tcl Shell Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-20T10:18:43+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:18 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>Start origin tcl shell: tclsh (apt-get install tcl);</p></li>
<li><p>Start tcl shell with command history shortcuts (up arrow for previous command and other powerful command line shortcuts like alt+backspace, brackets matching, etc. on Ubuntu): rlwrap -c tclsh;</p></li>
</ul>


<p>For efficiency, add <code>alias tcl="rlwrap -c tclsh"</code> to ~/.zshrc;</p>

<p>Note: rlwrap is readline wrapper;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/16/174647/">Copy Full Path Name of a File in Ranger</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-16T17:46:47+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>5:46 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After version 1.4.0, ranger add a command &ldquo;yp&rdquo; to copy full path name of a file with xsel. So you have to install xsel (apt-get install xsel), then use middle-button of the mouse to paste it somewhere else (both console and GUI apps, and if you are using laptop, you can only paste to console with <code>xsel -o</code>). Because xsel is a &ldquo;global clipboard&rdquo;, you can use yp of ranger in one console, and get the path with middle button or <code>xsel -o</code> in another console.</p>

<p>Note: see man page of xsel for the concept of 3 different clipboard PRIMARY, SECONDARY and CLIPBOARD of X windows.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/15/103209/">CFEngine Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-15T10:32:09+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:32 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Based on: <a href="https://cfengine.com/archive/manuals/cf3-quickstart">CFEngine Quick Start Guide</a></p>

<ol>
<li><p>Use 10.21.3.23 as cfhub (server), 10.21.3.31 as cfhost (client);</p></li>
<li><p>Install cfengine on both cfhub and cfhost:</p>

<ol type="a">
<li><p>download cfengine-community_3.5.1-3_i386.deb;</p></li>
<li><p>Ensure OpenSSL, BerkeleyDB and PCRE are installed: <code>apt-get install libdb4.* libpcre3 libssl</code>, so weired that this can not be excecuted in zsh, but bash is ok;</p></li>
<li><p><code>sudo dpkg --install cfengine-community_3.5.1-3_i386.deb</code>;</p></li>
</ol>
</li>
<li><p>Start policy server: <code>/var/cfengine/bin/cf-agent -B 10.21.3.23</code>;</p></li>
<li><p>Start client: same as above;</p></li>
<li><p>On cfhub: create a file cftest1.cf at /var/cfengine/masterfiles;</p></li>
<li><p>Modify /var/cfengine/masterfiles/promises.cf file;</p></li>
<li><p>&hellip;</p></li>
</ol>


<h1>Uninstall CFEngine3</h1>

<p>$ sudo apt-get purge cfengine-community</p>

<p>$ sudo rm -rf /var/cfengine</p>

<h1>bcfg2</h1>

<ol>
<li><p>Use 10.21.3.31 as server: <code>apt-get install bcfg2-server</code>;</p></li>
<li><p>Use 10.21.3.23 as client: <code>apt-get install bcfg2</code>;</p></li>
<li><p><a href="http://docs.bcfg2.org/appendix/guides/ubuntu.html#initialize-your-repository">Initialize your repository</a></p></li>
</ol>


<h1>cdist</h1>

<ol>
<li><p>install python3: <code>apt-get install python3</code>;</p></li>
<li><p><code>git clone git://git.schottelius.org/cdist</code>;</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/14/160009/">Run Interactive Shell Command in Erlang</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-14T16:00:09+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>4:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The following simple Erlang netcat client demonstrates the communication between Erlang program and external OS process. The rc.erl start a netcat client to connect to a netcat server, and send some message to the server at a given time.</p>

<ol>
<li><p>Create Erlang server;</p>

<p> -module(rc).
 -export([cmd/1]).
 cmd(Cmd) ->
     Opt = [stream, exit_status, stderr_to_stdout, eof],
     P = open_port({spawn, Cmd}, Opt),
     get_data(P, [], 0).
 get_data(P, Sofar, 3) ->
     port_command(P, &ldquo;abcd&rdquo;),
     get_data(P, Sofar, 4);
 get_data(P, Sofar, Cnt) ->
     receive
         {P, {data, Bin}} ->
             io:format(&ldquo;rec Bin: ~p, Cnt=~p~n&rdquo;, [Bin, Cnt]),
             get_data(P, [Bin|Sofar], Cnt+1);
         {P, eof} ->
             port_close(P),
             receive
                 {P, {exit_status, N}} ->
                     {N, lists:reverse(Sofar)}
             end
     end.</p></li>
<li><p>Start netcat server: run command <code>nc -l 3333</code> at host 10.21.3.31;</p></li>
<li><p>Start netcat client:</p>

<p> $ erl
 &hellip;</p>

<p> 1> c(rc).</p>

<p> {ok,rc}
 2> rc:cmd(&ldquo;nc 10.21.3.31 3333&rdquo;).</p></li>
<li><p>Send message from server to client: press &ldquo;1<CR>2<CR>3<CR>4<CR>^C&rdquo;, client output as follows:</p>

<p> rec Bin: &ldquo;1\n&rdquo;, Cnt=0
 rec Bin: &ldquo;2\n&rdquo;, Cnt=1
 rec Bin: &ldquo;3\n&rdquo;, Cnt=2
 rec Bin: &ldquo;4\n&rdquo;, Cnt=4
 {0,[&ldquo;1\n&rdquo;,&ldquo;2\n&rdquo;,&ldquo;3\n&rdquo;,&ldquo;4\n&rdquo;]}
 3></p></li>
</ol>


<p>When you press <CR> after 3, you can receive &ldquo;abcd&rdquo; from netcat client.</p>

<p>The pattern of Erlang-Shell communication is:</p>

<ul>
<li><p>Use &ldquo;open_port&rdquo; to start a external shell process;</p></li>
<li><p>Use &ldquo;receive&rdquo; clause to receive output of the process;</p></li>
<li><p>Use &ldquo;port_command&rdquo; to send message to process;</p></li>
<li><p>Use &ldquo;port_close&rdquo; to close the shell;</p></li>
</ul>


<p>Notes:</p>

<ol>
<li><p>For non-interactive shell command, os:cmd/1 is a better choice;</p></li>
<li><p>If you want to catch the event that the peer close actively, add &ldquo;eof&rdquo; into option list of open_port; If you want to catch the exit value of the shell process, add &ldquo;exit_status&rdquo; to option list of open_port;</p></li>
<li><p>Not specify &ldquo;in&rdquo; in option list of open_port when you want to send the process some message, or a &ldquo;ebadf&rdquo; exception arises, because &ldquo;in&rdquo; means this process only used for input, and &ldquo;ebadf&rdquo; means the file is not open for reading or writing.</p></li>
<li><p><a href="http://www.cnblogs.com/gibbon/archive/2012/12/26/Erlang.html">Erlang port communicate with python</a> is a good demonstration of erlang calling a python script; Chapter 12 of &ldquo;Programming Erlang&rdquo; also concentrate Erlang interfacing techniques.</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/13/174638/">My Vimrc</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-13T17:46:38+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>5:46 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Plugins used in this file includes:
FuzzyFinder, L9, bufexplorer (v7.4.2), <a href="https://github.com/bling/vim-airline">vim-airline</a>,
<a href="https://github.com/plasticboy/vim-markdown">vim-markdown</a>.</p>

<p>nerdcommenter is a must-have plugin.</p>

<p>For html editing, <a href="https://github.com/sukima/xmledit/">xmledit</a> is a good helper.</p>

<pre><code>set nocompatible
set clipboard=unnamedplus
execute pathogen#infect()
call pathogen#helptags()
call pathogen#incubate()

noremap &lt;left&gt; &lt;C-w&gt;h
noremap &lt;right&gt; &lt;C-w&gt;l
noremap &lt;up&gt; &lt;C-w&gt;k
noremap &lt;down&gt; &lt;C-w&gt;j
nnoremap &lt;F2&gt; :set wrap!&lt;CR&gt;

set nobackup
set noswapfile

colo ron
syntax on
set incsearch
set et
set sw=2
set ts=2
set nu
set nowrap

nnoremap &lt;C-o&gt; :FufCoverageFile&lt;CR&gt;

" status line
set laststatus=2
let g:airline_section_c='%F'

" markdown
let g:vim_markdown_initial_foldlevel=2

filetype plugin indent on
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/10/081522/">Hadoop 1.2.1 Up and Running</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-10T08:15:22+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:15 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Pseudo-distributed Mode</h1>

<ol>
<li><p>Download Oracle jdk-6u45-linux-i586.bin from Oracle website. Openjdk is unsuitable here because some package like sun.net.dns.ResolverConfiguration only exists in rt.jar of Oracle jdk;</p></li>
<li><p>Install (run <code>./jdk-6u45-linux-i586.bin</code> under ~/apps) this jdk at ~/apps with current user (do not install it into /opt with root user, because this will cause access restriction of rt.jar of jdk);</p></li>
<li><p>Add $JAVA_HOME and $CLASSPATH into /etc/profile and re-log into OS to validate:</p>

<pre><code> export JAVA_HOME=/home/lichao/apps/jdk1.6.0_45 
 export PATH=$PATH:$JAVA_HOME/bin 
 export CLASSPATH=$CLASSPATH:$JAVA_HOME/lib:$JAVA_HOME/jre/lib
</code></pre></li>
<li><p>Follow <a href="https://hadoop.apache.org/docs/stable/single_node_setup.html">Single Node Setup</a>.</p></li>
</ol>


<p>Verified this morning: 2013-8-9, Linux Mint 14 32bit, Hadoop 1.2.1.</p>

<h1>Distributed Mode</h1>

<ol>
<li><p>Create user hadoop in host 23, 31, 49 and 139;</p></li>
<li><p>Create apps and warez folder in home directory on all hosts above;</p></li>
<li><p>Copy jdk-6u45-linux-i586.bin from Oracle and hadoop-1.2.1.tar.gz to warez directory to all above hosts;</p></li>
<li><p>Unzip jdk6u45 and hadoop to ~/apps;</p></li>
<li><p>modify $JAVA_HOME as &ldquo;/home/hadoop/apps/jdk1.6.0_45&rdquo; in ~/apps/hadoop-1.2.1/conf/hadoop-env.sh;</p></li>
<li></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/09/120651/">Build Hadoop Develop Environment</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-09T12:06:51+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:06 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Prerequisites</h1>

<ol>
<li><p>Download Oracle jdk-6u45-linux-i586.bin from Oracle website. Openjdk is unsuitable here because some package like sun.net.dns.ResolverConfiguration only exists in rt.jar of Oracle jdk;</p></li>
<li><p>Install (./jdk<strong>.bin) this jdk at ~/apps/jdk</strong> with current user (do not install it into /opt with root user, because this will cause access restriction of rt.jar of jdk);</p></li>
<li><p>Add $JAVA_HOME and $CLASSPATH into /etc/profile and re-log into OS to validate;</p></li>
<li><p>Add this jdk to eclipse (Preferences -> Install JREs);</p></li>
</ol>


<h1>Method 8-10</h1>

<p>Follow <a href="https://wiki.apache.org/hadoop/EclipseEnvironment">Working with Hadoop under Eclipse</a></p>

<ol>
<li>make sure your maven version is 3.x (mvn &ndash;version), if not:</li>
</ol>


<p> sudo apt-get remove maven2
 sudo apt-get update
 sudo apt-get install maven</p>

<ol>
<li><p>git clone git://git.apache.org/hadoop-common.git ()</p></li>
<li><p>mvn install -DskipTests</p></li>
<li><p>mvn eclipse:eclipse -DdownloadSources=true -DdownloadJavadocs=true</p></li>
<li></li>
</ol>


<h1>Method 8-9</h1>

<ol>
<li><p>Create a Java Project in Eclipse, modify default output folder to $PROJECT_HOME/out (because &ldquo;bin&rdquo; is a script folder in hadoop source pack);</p></li>
<li><p>Exclude src from source folder and create &ldquo;lib&rdquo;, &ldquo;conf&rdquo; folder under $PROJECT_HOME;</p></li>
<li><p>Import $HADOOP_HOME/src, lib, conf into $PROJECT_HOME;</p></li>
<li><p>Add all jar files under lib to build path;</p></li>
<li><p>Add ant.jar to build path;</p></li>
<li><p>Add mapred, tools, ant, core, hdfs under src folder as source folder;</p></li>
</ol>


<h1>Verify</h1>

<ol>
<li><p>modify config files;</p></li>
<li><p>run hadoop</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/09/083854/">Windows上安装Linux后Grub目录中没有Windows启动项的修复方法</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-09T08:38:54+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:38 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>启动Linux后，执行<code>sudo update-grub</code>，此命令将重新扫描启动区，输出更新结果，并更新/boot/grub/grub.cfg文件。</p>

<p>今天在联想笔记本上执行此命令后，找回了之前安装的Windows 7启动项。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/45">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/43">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/04/18/140631/">4月17日讲座文字稿</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/17/151844/">Linux Mint System Backup and Restore</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/16/172913/">Fzf让命令行更方便</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/15/105035/">How to Sync a Fork on Github</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/08/161006/">Python的Generator和yield</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
