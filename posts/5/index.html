
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Find a user whose email is verified.
The &ldquo;emails&rdquo; field is an array.
The function of &ldquo;$elemMatch&rdquo; operator is: Find a element &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/07/151147/">Find Verified User in MongoDB</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-07T15:11:47+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:11 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Find a user whose email is verified.
The &ldquo;emails&rdquo; field is an array.
The function of &ldquo;$elemMatch&rdquo; operator is:</p>

<p>Find a element in an array (here is emails),
whose feature obey the value after &ldquo;$elemMatch&rdquo; (here its &ldquo;verified&rdquo; key is &ldquo;true&rdquo;).</p>

<p>The code:</p>

<pre><code>&gt; db.users.findOne({'emails': {$elemMatch: {verified: true}}})
{
  "_id" : "rKawn5jCiuGcsPHdP",
  "createdAt" : ISODate("2015-05-07T01:04:23.375Z"),
  "services" : {
    "password" : {
      "bcrypt" : "$2a$10$T07N74DUrVrRtVGPT9dzleZlpRTlULfb9OrlWveW4NbcNpi.HkiAK"
    },
    "resume" : {
      "loginTokens" : [
        {
          "when" : ISODate("2015-05-07T01:04:23.902Z"),
          "hashedToken" : "Xbt2ASQF61artSmrYX1Gn6DLUNvbIrz9DW0sE4tbJh4="
        }
      ]
    },
    "email" : {
      "verificationTokens" : [ ]
    }
  },
  "emails" : [
    {
      "address" : "leechau@126.com",
      "verified" : true
    }
  ]
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/07/111310/">Calculate String Length Containing Chinese Characters</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-07T11:13:10+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:13 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want to remove all lines with only 1 Chinese character.
The origin file is very large,
so I have to filter out all lines with 1 character.
And remove them together.</p>

<p>Sort all lines in the file by their length is a easy way to achieve this.
The content of file origin.txt is:</p>

<blockquote><p>一十一
一十二
一十三
一十四
一十五
一十六
一十七
一十八
一十九
二十</p></blockquote>

<h1>Shell</h1>

<pre><code>awk '{print length, $0}' origin.txt | sort -n | cut -d " " -f2- | uniq &gt; target.txt
</code></pre>

<h1>Python</h1>

<h1>Node</h1>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/07/093644/">CoffeeScript Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-07T09:36:44+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:36 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Format</h1>

<ul>
<li>Function call line wrap: if the first parameter is an object,
it can be written at the next line, with an indent.
Otherwise, the first parameter must be written at the same line with the function name.
The following parameters can be written at the next line with an indent.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/30/095841/">Git GUI Clients on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-30T09:58:41+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:58 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>gitg</h1>

<p>Very intuitive branch model.
You can select different branch,
which will be displayed as the left-most line in the branch view panel.
Cover the functions of giggle.</p>

<h1>gitk</h1>

<p>Come with git.
See all branches: <code>gitk --all</code>.
Not intuitive for branching information.</p>

<h1>git gui</h1>

<p>Install with <code>aptitude install git-gui</code>.</p>

<p>Use gitk&rsquo;s branch-browsing interface.</p>

<h1>SmartGit</h1>

<p><a href="http://www.syntevo.com/smartgit/">SmartGit</a> is free for non-commercial use.
You have to download the installer, extract it and run.</p>

<h1>giggle</h1>

<p>Install with <code>aptitude install giggle</code>.</p>

<p>You can browse the history of a file.</p>

<h1>git cola</h1>

<p>Install with <code>aptitude install git-cola</code>.</p>

<p>Like git gui, use gitk&rsquo;s branch-browsing interface, too.</p>

<h1>Summary</h1>

<p>gitg is the first choice.
SmartGit is good except its license restriction.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/29/181733/">Build a Simple Meteor Package</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-29T18:17:33+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>6:17 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Build the package</h1>

<pre><code>$ cd ~/docs/tmp
$ meteor create --package leechau:segmentation
$ cd segmentation
$ cat &lt;&lt; EOF &gt; segmentation.js
Seg = 'segment results in Chinese';
Seg2 = function(inp){
  return inp.toUpperCase();
}
EOF

$ cat &lt;&lt; EOF &gt; package.js
Package.describe({
  name: 'leechau:segmentation',
  version: '0.0.1',
  // Brief, one-line summary of the package.
  summary: 'for chinese segmentation',
  // URL to the Git repository containing the source code for this package.
  git: 'https://github.com/leetschau/meteorSegmentation',
  // By default, Meteor will default to using README.md for documentation.
  // To avoid submitting documentation, set this field to null.
  documentation: 'README.md'
});

Package.onUse(function(api) {
  api.versionsFrom('1.1.0.2');
  api.addFiles('segmentation.js', 'client');
  api.export(['Seg', 'Seg2'], 'client');
});

Package.onTest(function(api) {
  api.use('tinytest');
  api.use('leechau:segmentation');
  api.addFiles('segmentation-tests.js');
});
EOF

$ cd ~/docs/tmp
$ meteor create testpkg
$ cd testpkg
$ mkdir packages
$ ln -s ~/docs/tmp/segmentation packages/segmentation
</code></pre>

<p>Add the following lines into &lsquo;click button&rsquo; of testpkg.js file:</p>

<pre><code>console.log(Seg);
console.log(Seg2('axd'));
</code></pre>

<p>Note:</p>

<ol>
<li><p><code>api.export</code> is necessary in <code>Package.onUse</code> function of package.js file.</p></li>
<li><p>The soft link does <strong>not</strong> contains the username part, to compare with <a href="https://atmospherejs.com/i/publishing">atmospherejs.com publishing doc</a>.
So the package you created is &ldquo;leechau:segmentation&rdquo; in <code>meteor create --package</code>.
While the soft link is &ldquo;segmentation&rdquo;, not &ldquo;leechau:segmentation&rdquo;.</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/29/114138/">QGIS的坐标系和缓冲区</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-29T11:41:38+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:41 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>一个图层文件(shp）有自己的坐标系，通过【右键->属性->通用->坐标参照系】查看。
直接修改坐标系导致图层对象消失，原因不明。
在图层上【右键->另存为】，在坐标系中搜索2154，选择"EPSG:2154"，保存在另一个shp文件中。</p>

<p>在QGIS窗口右下角状态栏中显示的坐标系只作显示用，与图层自己的坐标系无关。</p>

<p>当生成图层对象的缓冲区（主菜单->矢量->地学数据处理工具->缓冲区分析）时，
其中【缓冲距离】的单位是图层自身坐标系确定的单位，
例如WGS84的单位是degree，具体含义尚不清楚，大致是地球这个球体上两点与球心形成夹角的角度，
&ldquo;EPSG:2154"坐标系的单位是米。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/26/101038/">Penetrate GFW With ShadowSocks</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-26T10:10:38+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:10 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>To browse internet with <a href="https://github.com/shadowsocks/shadowsocks">shadowsocks</a>,</p>

<h1>Server setup</h1>

<p>You need a VPS (buy it from linode or digitalocean, etc, as the outlet),
to run the server with root (say its IP address is &ldquo;123.234.23.45&rdquo;):</p>

<pre><code># aptitude install python-pip
# pip install shadowsocks
# ssserver -p 2043 -k er@20 -m aes-256-cfb --user nobody -d start
</code></pre>

<p>See the logs:</p>

<pre><code>tail -f /var/log/shadowsocks.log
</code></pre>

<p>Or start it in foreground:</p>

<pre><code># ssserver -p 2043 -k testpwd
</code></pre>

<h1>Client</h1>

<p>Client is the machine you want to bypass the GFW.</p>

<h2>Windows</h2>

<p>Download the client package (Shadowsocks-win-dotnet4.0-2.3.1.zip for now),
extract it, and run.</p>

<p>You can check its &ldquo;System Proxy&rdquo; option, which is convenient for all browsers and terminal.</p>

<h2>Linux</h2>

<h3>Install</h3>

<p>For Ubuntu/Mint:</p>

<pre><code>$ sudo aptitude install python-pip
$ sudo pip install shadowsocks
</code></pre>

<p>Now you have a socks5 proxy. If you want convert it into a http proxy:</p>

<pre><code>$ sudo aptitude install polipo
$ service polipo stop
$ sslocal -s 123.234.23.45 -p 2043 -b 127.0.0.1 -l 1080 -k testpwd
$ sudo polipo socksParentProxy=localhost:1080
</code></pre>

<p>Now setup the http proxy of your browser as localhost:8123.
To use the proxy in terminal, add prefix &ldquo;http_proxy=<a href="http://localhost:8123">http://localhost:8123</a>&rdquo;,
for example:</p>

<pre><code>http_proxy=http://localhost:8123 curl www.xys.org
</code></pre>

<p>Or use a text-based web browser:</p>

<pre><code>http_proxy=http://localhost:8123 lynx rsf.org
</code></pre>

<p>where 8123 is the default port number of polipo.</p>

<p><a href="https://github.com/shadowsocks/shadowsocks/wiki/Using-Shadowsocks-with-Command-Line-Tools">Using Shadowsocks with Command Line Tools</a> in
<a href="https://github.com/shadowsocks/shadowsocks/wiki">shadowsocks wiki</a> use proxychains to achieve proxy in terminal,
which didn&rsquo;t work for me.</p>

<p>To summarize, you need 3 processes to access blocked website on Linux:</p>

<ol>
<li><p>The shadowsocks server on the VPS abroad;</p></li>
<li><p>The shadowsocks client on your machine;</p></li>
<li><p>The polipo to convert a socks proxy into a http proxy.</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/23/174442/">Resolving Merge Conflicts in Git</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-23T17:44:42+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>5:44 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Edit the conflicted files manually.
Remove &ldquo;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&rdquo;, &ldquo;=======&rdquo; and &ldquo;>>>>>>>&rdquo;,
then add and commit the modified files to resolve the conflict.</p>

<p>When using git-flow, if a conflict appears when finishing a release,
after resolve and commit the conflicted files,
run <code>git flow release finish 0.2.0</code> again.</p>

<p>Ref:</p>

<p><a href="http://genomewiki.ucsc.edu/index.php/Resolving_merge_conflicts_in_Git">Resolving merge conflicts in Git</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/22/145820/">Take Screenshot With Shutter on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-22T14:58:20+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>2:58 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Install</h1>

<p>On Linux Mint:</p>

<pre><code>sudo aptitude install shutter libgoo-canvas-perl
</code></pre>

<p>the second one is for editing the screenshot.</p>

<p>On Ubuntu 14.04:</p>

<pre><code>sudo aptitude install shutter
</code></pre>

<h1>Usage</h1>

<p>Run <code>shutter</code> in dmenu, click &ldquo;Selection&rdquo; on toolbar.</p>

<p>Shutter is a multi-tab application, and save picture to disk automatically,
which is very convenient.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/22/103439/">Manage Vagrant-Created VMs on Linux Mint</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-22T10:34:39+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>10:34 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li><p>After installation of Virtualbox,
specify the VM files location in VirutalBox:
[File -> Preferences -> General -> Default Machine Folder]
to &ldquo;$HOME/docs/vms&rdquo;;</p></li>
<li><p>Add <code>alias vb='VBoxManage'</code> into ~/.bash_aliases;</p></li>
<li><p>List all existing VMs: <code>vb list vms</code>;</p></li>
<li><p>List all running VMs: <code>vb list runningvms</code>;</p></li>
<li><p>Print the details of a VM: <code>vb showvminfo xxx</code>,
where xxx is one item name in output of <code>vb list vms</code>;</p></li>
</ol>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/6">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/4">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/09/24/185036/">Add a Local Meteor Package</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/23/123748/">Stack Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/104351/">Using Webstorm as Meteor IDE</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/092543/">Autosave in Webstorm</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/21/092600/">Convert a Folder Into Meteor App in Webstorm</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
