
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Scenario: When checkout codes in Juno SR2 with svn plugin subclipse 1.10.x, it reports &ldquo;unable to load default svn client&rdquo;, and checkout &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/36">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leetschau.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/22/175812/">Subclipse Report `Unable to Load Default Svn Client` on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-22T17:58:12+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2013</span></span> <span class='time'>5:58 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Scenario: When checkout codes in Juno SR2 with svn plugin subclipse 1.10.x, it reports &ldquo;unable to load default svn client&rdquo;, and checkout failed.</p>

<p>Solution: There is a bug in this version. Remove this plugin, and install 1.6.x (I use 1.6.18 at <a href="http://subclipse.tigris.org/files/documents/906/49028/site-1.6.18.zip,">http://subclipse.tigris.org/files/documents/906/49028/site-1.6.18.zip,</a> unzip it into dropins folder of $ECLIPSE_HOME). Restart Eclipse, everything goes fine.</p>

<p>I install a svn repository at 10.0.7.141:/opt/svnRepo.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/21/102535/">Exercies of Chapter 3 in `Exploring Expect`</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-21T10:25:35+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>10:25 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>1 ~ 3: ftp.uu.net has disappeared since 2006 (<a href="https://en.wikipedia.org/wiki/UUNET">https://en.wikipedia.org/wiki/UUNET</a>).</p></li>
<li><p>4:</p></li>
</ul>


<p>method 1 (no timeout): login; send &ldquo;ls&rdquo;; save expect_out(buffer) to buf; expect &ldquo;ftp>&rdquo;; parse buf, if there is &ldquo;pub&rdquo;, send &ldquo;cd pub&rdquo;; &ldquo;interact&rdquo;;</p>

<p>method 2 (timeout): login; send &ldquo;ls&rdquo;; expect &ldquo;pub*send OK.&rdquo; then send &ldquo;cd pub&rdquo;; if timeout, interact;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/20/185908/">Notes About `Exploring Expect`</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-20T18:59:08+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:59 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Chapter 3</h1>

<ul>
<li><p>Section &ldquo;The expect Command&rdquo;: expect_out(0,string) can NOT be written as &ldquo;expect_out(0, string)&rdquo;, blank before &ldquo;string&rdquo; will make a mistake;</p></li>
<li><p>Concurrent matching:</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>expect {
</span><span class='line'>    item1 {send cmd1}
</span><span class='line'>    item2 {send cmd2}
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<ul>
<li>In spawn process, use &ldquo;\r&rdquo; as the return key in send command;</li>
</ul>


<h1>Chapter 5</h1>

<ul>
<li>Section &ldquo;Using Parentheses For Feedback&rdquo; give a clear and concise explanations of how to get feedback in expect.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/expect 
</span><span class='line'>set timeout 60 
</span><span class='line'>expect -re "a(.*)c" 
</span><span class='line'>send "expect_out(buffer) = ${expect_out(buffer)}\n" 
</span><span class='line'>send "expect_out(0,string) = ${expect_out(0,string)}\n" 
</span><span class='line'>send "expect_out(1,string) = ${expect_out(1,string)}\n" 
</span><span class='line'>expect -re "e" 
</span><span class='line'>send "expect_out(buffer) = ${expect_out(buffer)}\n" 
</span><span class='line'>send "expect_out(0,string) = ${expect_out(0,string)}\n" 
</span><span class='line'>send "expect_out(1,string) = ${expect_out(1,string)}\n" </span></code></pre></td></tr></table></div></figure>


<p>Run this script, input &ldquo;junk abcbcdef&rdquo; and return, will produces:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./feedback.exp 
</span><span class='line'>junk abcbcdef 
</span><span class='line'>expect_out(buffer) = junk abcbc 
</span><span class='line'>expect_out(0,string) = abcbc 
</span><span class='line'>expect_out(1,string) = bcb 
</span><span class='line'>expect_out(buffer) = de 
</span><span class='line'>expect_out(0,string) = e 
</span><span class='line'>expect_out(1,string) = bcb </span></code></pre></td></tr></table></div></figure>


<p>You can see value of &ldquo;expect_out(&hellip;)&rdquo; will be refreshed when a expect matches (expect &ldquo;e&rdquo;). &ldquo;buffer&rdquo; are all things from last buffer (&ldquo;&hellip;cbc&rdquo;) to this match (&ldquo;e&rdquo;), which is &ldquo;de&rdquo; in this case. &ldquo;0,string&rdquo; means all matching strings (note &ldquo;0, string&rdquo; will raise a exception for the redundant blank). &ldquo;1,string&rdquo; means the first subgroup of &ldquo;0,string&rdquo;. If there is no subgroup (expressed as parentheses) in current match, (1,string) remains last value (&ldquo;bcb&rdquo; in this case). Even &ldquo;f&rdquo; at the end of input has been sent to expect, it will not be added to &ldquo;buffer&rdquo;, because it&rsquo;s not a part of the current match.</p>

<h1>Chapter 6</h1>

<ul>
<li>exp_continue is useful in many circumstances. See its code example in section &ldquo;Matching Multiple Times&rdquo; in chapter 6 and section &ldquo;Prompting For A Password On Behalf Of A Program&rdquo; in chapter 8;</li>
</ul>


<h1>Chapter 7 &amp; 8</h1>

<ul>
<li><p>some frequently used command:</p>

<pre><code>  log_file: write output of spawned process to a file; 
  log_user: send output of spawned process to/not to user; 
  send_user: expect script send messages to user;

  expect_user: continue communicating with the user even after a process has been spawned; 
  send: expect script send messages to spawned process; 
  send_log: only write to log (without writing to stdout); 
  send_error: expect script send messages to stderr; 
  exp_internal: enable/disable internal diagnostics to stdout or log file (see section "Logging Internal Diagnostics"); 
</code></pre></li>
<li><p>proc sendexpect in section &ldquo;The send_error Command&rdquo; is useful;</p></li>
<li><p>right-wrong-timeout switch in section &ldquo;The expect_user Command&rdquo;:</p>

<pre><code>  expect {
      right {
      } wrong {
          send_error error_message
          exit 1
      } timeout {
          send_error "time out!"
          exit 1
      }
  }
</code></pre></li>
<li><p>A program switch between character and line mode. Notice the usage of &ldquo;stty raw&rdquo;:</p>

<pre><code>  send_user "Now we are in line mode. You can use backspace to re-input.\n" 
  send_user "Continue? y or n\n" 
  expect_user -re "y|n" 
  send_user "you press $expect_out(0,string)\n" 
  stty raw 
  send_user "Now we are in character mode. You have no chance to re-input.\n" 
  send "Continue? Enter y or n: \r\n" 
  expect -re "y|n" 
  send_user "\nyou press $expect_out(0,string)" 
</code></pre></li>
<li><p>stty should be executed during times when the user is not typing, such as before a prompt rather than after, otherwise there is possibility of losing characters while switching modes. See the end of section &ldquo;Line Versus Character-Oriented And Other Terminal Modes&rdquo;;</p></li>
<li><p>In the modified version of su2 in section &ldquo;Echoing&rdquo;, I modified &ldquo;# &rdquo; to &ldquo; #&rdquo; in the last 3rd line, because on my platform (Mint Xfce 14) there are no space after &ldquo;#&rdquo; in the prompt of root user;</p></li>
<li><p>the get password procedure in section &ldquo;Echo&rdquo; is a must-have tool;</p></li>
<li><p>If you want exact Bourne-shell semantics, the simplest way is to call system. See section &ldquo;The system Command&rdquo;;</p></li>
</ul>


<h1>Chapter 9</h1>

<h2>arguments experiment after #!</h2>

<p>The echo.exp:</p>

<p>version 1:</p>

<pre><code>#!/usr/bin/expect 
set argc [llength $argv] 
for {set i 0} {$i&lt;$argc} {incr i} { 
    puts "arg $i: [lindex $argv $i]" 
} 
</code></pre>

<p>version 2:</p>

<pre><code>#!/usr/bin/expect --
...
</code></pre>

<p>version 3:</p>

<pre><code>#!/usr/bin/expect -f
...
</code></pre>

<p>Now run command <code>./echo.exp -c "puts hello" 1 2 3</code>, the output is:</p>

<p>version 1:</p>

<pre><code>arg 0: -c 
arg 1: puts hello 
arg 2: 1 
arg 3: 2 
arg 4: 3 
</code></pre>

<p>version 2:</p>

<pre><code>arg 0: -c 
arg 1: puts hello 
arg 2: 1 
arg 3: 2 
arg 4: 3 
</code></pre>

<p>version 3:</p>

<pre><code>hello 
arg 0: 1 
arg 1: 2 
arg 2: 3 
</code></pre>

<p>So it is clear that only when &ldquo;-f&rdquo; is specified, &ldquo;-c&rdquo; means &ldquo;take my arguments as a script&rdquo;. Otherwise &ldquo;-c&rdquo; will be treated as a common arguments of the script. &ldquo;&ndash;&rdquo; explicitly stop any arguments interpreting.</p>

<h1>Chapter 17</h1>

<ul>
<li>this chapter describes how to make expect script a server;</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/20/102248/">Exercies of Chapter 2 in `Exploring Expect`</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-20T10:22:48+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:22 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><ol>
<li>Write a procedure to reverse a string. If you wrote an iterative solution, now write a recursive solution or vice versa.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh</p>

<p> # iterative solution:</p>

<p> proc rev_str_iter { input } {
  for {set idx [string length $input]} {$idx > 0} {incr idx -1} {
   append res [string index $input [expr $idx-1]]
  }
  return $res
 }
 # recursive solution:
 proc rev_str_recur { input } {
  set len [string length $input]
  if {[expr $len - 1] > 0} {
   append res [rev_str_recur [string range $input 1 end]] \
             [string index $input 0]
  } else {
   set res $input
  }
  return $res
 }
 set m &ldquo;abcdefg&rdquo;
 set n [rev_str_iter $m]
 puts $n
 set n2 [rev_str_recur $m]
 puts $n2</p>

<blockquote><ol>
<li>Repeat the previous exercise but with a list instead of a string.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh
 # iterative solution:
 proc rev_list_iter { input } {
  for {set idx [llength $input]} {$idx > 0} {incr idx -1} {
   lappend res [lindex $input [expr $idx-1]]
  }
  return $res
 }
 # recursive solution:
 proc rev_list_recur { input } {
  set len [llength $input]
  if {[expr $len - 1] > 0} {
   set res [concat [rev_list_recur [lrange $input 1 end]] [lindex $input 0]]
  } else {
   set res $input
  }
  return $res
 }
 set m &ldquo;a b c d e g&rdquo;
 set n [rev_list_iter $m]
 puts $n
 set n2 [rev_list_recur $m]
 puts $n2</p>

<blockquote><ol>
<li>Write a procedure to rename all the files in a directory ending with .c to names ending in &ldquo;.cc“.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh
 foreach file_name [glob *.c] {
  file rename $file_name [append file_name c]
 }</p>

<blockquote><ol>
<li>Write a procedure that takes a list of variable names and a list of values, and sets each variable in the list to the respective value in the other list. Think of different alternatives to handle the case when the lists are of different lengths.</li>
</ol>
</blockquote>

<p> #!/usr/bin/tclsh
 proc assign {names values} {
  if {[llength $names] > [llength $values]} {
   set len [llength $values]
  } else {
   set len [llength $names]
  }
  for {set idx 0} {$idx&lt;$len} {incr idx} {
   set var_name [lindex $names $idx]
   set $var_name [lindex $values $idx]
   puts [concat $var_name = [set $var_name]]
  }
 }
 set names &ldquo;za bb ee dk&rdquo;
 set values &ldquo;11 32 53 94 5&rdquo;
 assign $names $values</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/20/101843/">Tcl Shell Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-20T10:18:43+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:18 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>Start origin tcl shell: tclsh (apt-get install tcl);</p></li>
<li><p>Start tcl shell with command history shortcuts (up arrow for previous command and other powerful command line shortcuts like alt+backspace, brackets matching, etc. on Ubuntu): rlwrap -c tclsh;</p></li>
</ul>


<p>For efficiency, add <code>alias tcl="rlwrap -c tclsh"</code> to ~/.zshrc;</p>

<p>Note: rlwrap is readline wrapper;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/16/174647/">Copy Full Path Name of a File in Ranger</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-16T17:46:47+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>5:46 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After version 1.4.0, ranger add a command &ldquo;yp&rdquo; to copy full path name of a file with xsel. So you have to install xsel (apt-get install xsel), then use middle-button of the mouse to paste it somewhere else (both console and GUI apps, and if you are using laptop, you can only paste to console with <code>xsel -o</code>). Because xsel is a &ldquo;global clipboard&rdquo;, you can use yp of ranger in one console, and get the path with middle button or <code>xsel -o</code> in another console.</p>

<p>Note: see man page of xsel for the concept of 3 different clipboard PRIMARY, SECONDARY and CLIPBOARD of X windows.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/15/103209/">CFEngine Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-15T10:32:09+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:32 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Based on: <a href="https://cfengine.com/archive/manuals/cf3-quickstart">CFEngine Quick Start Guide</a></p>

<ol>
<li><p>Use 10.21.3.23 as cfhub (server), 10.21.3.31 as cfhost (client);</p></li>
<li><p>Install cfengine on both cfhub and cfhost:</p>

<ol type="a">
<li><p>download cfengine-community_3.5.1-3_i386.deb;</p></li>
<li><p>Ensure OpenSSL, BerkeleyDB and PCRE are installed: <code>apt-get install libdb4.* libpcre3 libssl</code>, so weired that this can not be excecuted in zsh, but bash is ok;</p></li>
<li><p><code>sudo dpkg --install cfengine-community_3.5.1-3_i386.deb</code>;</p></li>
</ol>
</li>
<li><p>Start policy server: <code>/var/cfengine/bin/cf-agent -B 10.21.3.23</code>;</p></li>
<li><p>Start client: same as above;</p></li>
<li><p>On cfhub: create a file cftest1.cf at /var/cfengine/masterfiles;</p></li>
<li><p>Modify /var/cfengine/masterfiles/promises.cf file;</p></li>
<li><p>&hellip;</p></li>
</ol>


<h1>Uninstall CFEngine3</h1>

<p>$ sudo apt-get purge cfengine-community</p>

<p>$ sudo rm -rf /var/cfengine</p>

<h1>bcfg2</h1>

<ol>
<li><p>Use 10.21.3.31 as server: <code>apt-get install bcfg2-server</code>;</p></li>
<li><p>Use 10.21.3.23 as client: <code>apt-get install bcfg2</code>;</p></li>
<li><p><a href="http://docs.bcfg2.org/appendix/guides/ubuntu.html#initialize-your-repository">Initialize your repository</a></p></li>
</ol>


<h1>cdist</h1>

<ol>
<li><p>install python3: <code>apt-get install python3</code>;</p></li>
<li><p><code>git clone git://git.schottelius.org/cdist</code>;</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/14/160009/">Run Interactive Shell Command in Erlang</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-14T16:00:09+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>4:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The following simple Erlang netcat client demonstrates the communication between Erlang program and external OS process. The rc.erl start a netcat client to connect to a netcat server, and send some message to the server at a given time.</p>

<ol>
<li><p>Create Erlang server;</p>

<p> -module(rc).
 -export([cmd/1]).
 cmd(Cmd) ->
     Opt = [stream, exit_status, stderr_to_stdout, eof],
     P = open_port({spawn, Cmd}, Opt),
     get_data(P, [], 0).
 get_data(P, Sofar, 3) ->
     port_command(P, &ldquo;abcd&rdquo;),
     get_data(P, Sofar, 4);
 get_data(P, Sofar, Cnt) ->
     receive
         {P, {data, Bin}} ->
             io:format(&ldquo;rec Bin: ~p, Cnt=~p~n&rdquo;, [Bin, Cnt]),
             get_data(P, [Bin|Sofar], Cnt+1);
         {P, eof} ->
             port_close(P),
             receive
                 {P, {exit_status, N}} ->
                     {N, lists:reverse(Sofar)}
             end
     end.</p></li>
<li><p>Start netcat server: run command <code>nc -l 3333</code> at host 10.21.3.31;</p></li>
<li><p>Start netcat client:</p>

<p> $ erl
 &hellip;</p>

<p> 1> c(rc).</p>

<p> {ok,rc}
 2> rc:cmd(&ldquo;nc 10.21.3.31 3333&rdquo;).</p></li>
<li><p>Send message from server to client: press &ldquo;1<CR>2<CR>3<CR>4<CR>^C&rdquo;, client output as follows:</p>

<p> rec Bin: &ldquo;1\n&rdquo;, Cnt=0
 rec Bin: &ldquo;2\n&rdquo;, Cnt=1
 rec Bin: &ldquo;3\n&rdquo;, Cnt=2
 rec Bin: &ldquo;4\n&rdquo;, Cnt=4
 {0,[&ldquo;1\n&rdquo;,&ldquo;2\n&rdquo;,&ldquo;3\n&rdquo;,&ldquo;4\n&rdquo;]}
 3></p></li>
</ol>


<p>When you press <CR> after 3, you can receive &ldquo;abcd&rdquo; from netcat client.</p>

<p>The pattern of Erlang-Shell communication is:</p>

<ul>
<li><p>Use &ldquo;open_port&rdquo; to start a external shell process;</p></li>
<li><p>Use &ldquo;receive&rdquo; clause to receive output of the process;</p></li>
<li><p>Use &ldquo;port_command&rdquo; to send message to process;</p></li>
<li><p>Use &ldquo;port_close&rdquo; to close the shell;</p></li>
</ul>


<p>Notes:</p>

<ol>
<li><p>For non-interactive shell command, os:cmd/1 is a better choice;</p></li>
<li><p>If you want to catch the event that the peer close actively, add &ldquo;eof&rdquo; into option list of open_port; If you want to catch the exit value of the shell process, add &ldquo;exit_status&rdquo; to option list of open_port;</p></li>
<li><p>Not specify &ldquo;in&rdquo; in option list of open_port when you want to send the process some message, or a &ldquo;ebadf&rdquo; exception arises, because &ldquo;in&rdquo; means this process only used for input, and &ldquo;ebadf&rdquo; means the file is not open for reading or writing.</p></li>
<li><p><a href="http://www.cnblogs.com/gibbon/archive/2012/12/26/Erlang.html">Erlang port communicate with python</a> is a good demonstration of erlang calling a python script; Chapter 12 of &ldquo;Programming Erlang&rdquo; also concentrate Erlang interfacing techniques.</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/13/174638/">Myvimrc</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-13T17:46:38+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>5:46 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>set nocompatible
execute pathogen#infect()
call pathogen#helptags()
call pathogen#incubate()
imap jk <ESC>
vmap jk <ESC>
&ldquo; jj is not suitable <ESC> in visual mode
set nobackup</p>

<p>set noswapfile
colo ron
syntax on
set incsearch
set et
set sw=4
set ts=4
set nu
set nowrap
set colorcolumn=80 &ldquo; mark the margin, or &lsquo;cc=80&rsquo; for short, only for vim v7.3+
map <up> <nop>
map <down> <nop>
map <left> <nop>
map <right> <nop>
&rdquo; FuzzyFinder
nnoremap <C-o> :FufCoverageFile
let mapleader=&ldquo;,&rdquo;
&ldquo; taglist
let Tlist_Inc_Winwidth = 0
let Tlist_Show_One_File = 1
nmap <leader>to :TlistOpen<CR>
nmap <leader>tt :TlistToggle<CR>
filetype on
filetype plugin indent on
&#8220;nmap <silent> <leader>ev :e $MYVIMRC<CR>
&rdquo; use global mark mV and &lsquo;V to make this function
&ldquo;nmap <silent> <leader>sv :so $MYVIMRC<CR>
&rdquo; use :so % instead of above line
&ldquo;nnoremap ; :
&rdquo; ; is the key for repeating last inline search (f<char>)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/10/081522/">Hadoop 1.2.1 Up and Running</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-10T08:15:22+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:15 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Pseudo-distributed Mode</h1>

<ol>
<li><p>Download Oracle jdk-6u45-linux-i586.bin from Oracle website. Openjdk is unsuitable here because some package like sun.net.dns.ResolverConfiguration only exists in rt.jar of Oracle jdk;</p></li>
<li><p>Install (run <code>./jdk-6u45-linux-i586.bin</code> under ~/apps) this jdk at ~/apps with current user (do not install it into /opt with root user, because this will cause access restriction of rt.jar of jdk);</p></li>
<li><p>Add $JAVA_HOME and $CLASSPATH into /etc/profile and re-log into OS to validate:</p>

<pre><code> export JAVA_HOME=/home/lichao/apps/jdk1.6.0_45 
 export PATH=$PATH:$JAVA_HOME/bin 
 export CLASSPATH=$CLASSPATH:$JAVA_HOME/lib:$JAVA_HOME/jre/lib
</code></pre></li>
<li><p>Follow <a href="https://hadoop.apache.org/docs/stable/single_node_setup.html">Single Node Setup</a>.</p></li>
</ol>


<p>Verified this morning: 2013-8-9, Linux Mint 14 32bit, Hadoop 1.2.1.</p>

<h1>Distributed Mode</h1>

<ol>
<li><p>Create user hadoop in host 23, 31, 49 and 139;</p></li>
<li><p>Create apps and warez folder in home directory on all hosts above;</p></li>
<li><p>Copy jdk-6u45-linux-i586.bin from Oracle and hadoop-1.2.1.tar.gz to warez directory to all above hosts;</p></li>
<li><p>Unzip jdk6u45 and hadoop to ~/apps;</p></li>
<li><p>modify $JAVA_HOME as &ldquo;/home/hadoop/apps/jdk1.6.0_45&rdquo; in ~/apps/hadoop-1.2.1/conf/hadoop-env.sh;</p></li>
<li></li>
</ol>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/37">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/35">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/11/03/171108/">Spark任务自动执行脚本</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/11/03/134818/">SparkR in Action</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/31/092340/">Customize Login Screen of LinuxMint 17</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/29/094400/">Xen on LinuxMint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/28/182614/">DMShell Up and Running</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
