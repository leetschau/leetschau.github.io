
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Ubuntu You need to know the static IP, netmask and gateway IP. To test your network, set static IP temporarily: # ip addr // get the interface name: &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/23/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/04/173927/">Set Static IP on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-04T17:39:27+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:39 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Ubuntu</h1>

<p>You need to know the static IP, netmask and gateway IP. To test your network, set static IP temporarily:</p>

<pre><code># ip addr   // get the interface name: eth0
# ifconfig eth0 10.32.22.10 netmask 255.255.255.0
# route add default gw 10.32.22.254 eth0
</code></pre>

<p>Then test network with &ldquo;ping&rdquo; command. If it&rsquo;s OK, set it permanently:</p>

<pre><code># cat /etc/network/interfaces  // before modification: dhcp
auto eth0
iface eth0 inet dhcp
# cat /etc/network/interfaces  // after modification: static IP
auto eth0
iface eth0 inet static
address 10.32.22.10
netmask 255.255.255.0
gateway 10.32.22.254
</code></pre>

<p>Now reboot the static IP will take effect.</p>

<h1>Arch Linux</h1>

<pre><code># ip addr flush enp2s0
# ip addr add 10.32.22.10/24 dev enp2s0
# ip route add default via 10.32.22.254
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/03/105044/">Install 32bit Arch Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-03T10:50:44+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>10:50 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Partition Disk and Install 32bit Arch Linux</h1>

<ol>
<li><p>Create usb install key:</p>

<p> $ dd bs=4M if=warez/archlinux-2014.04.01-dual.iso of=/dev/sdb &amp;&amp; sync</p></li>
<li><p>Startup laptop with usb key and select &ldquo;Boot Arch Linux (i686)&rdquo;;</p></li>
<li><p>Connect wifi:</p>

<p> # wpa_supplicant -B -i wlp5s0 -c &lt;(wpa_passphrase TP-LINK_PocketAP_8344C2 py25)
 # dhcpcd wlp5s0</p></li>
<li><p>Partition disk:</p>

<p> # sgdisk &ndash;zap-all /dev/sda
 # cgdisk /dev/sda    // create 20G, 50G, 20G, 50G, 20G, 50G, 20G, 50G, 105G, totally 9 partitions
 // This is a gpt partition, where can&rsquo;t install Windows, because Windows only support MBR partition
 # parted /dev/sda print   // print the partition tables
 # mkfs.ext4 /dev/sda1
 # mkfs.ext4 /dev/sda2
 # lsblk -f                // display the current partition layout</p></li>
<li><p>Mount partition:</p>

<p> # mount /dev/sda1 /mnt
 # mkdir /mnt/home
 # mount /dev/sda2 /mnt/home</p></li>
<li><p>Select a mirror:</p>

<p> # vi /etc/pacman.d/mirrorlist</p></li>
<li><p>Install the base system: (so cool~)</p>

<p> # pacstrap -i /mnt base</p></li>
<li><p>Create fstab and chroot:</p>

<p> # genfstab -U -p /mnt >> /mnt/etc/fstab
 # arch-chroot /mnt /bin/bash</p></li>
<li><p>Set locale:</p>

<p> # vi /etc/locale.gen  // uncomment en_US.UTF-8 &amp; zh_CN.UTF-8
 # locale-gen
 # echo LANG=en_US.UTF-8 > /etc/locale.conf
 # export LANG=en_US.UTF-8
 # setfont Lat2-Terminus16 (optional)</p></li>
<li><p>Set time zone:</p>

<p> # ln -s /usr/share/zoneinfo/Hongkong /etc/localtime    // now <code>date</code> command will give corrent time
 # hwclock &ndash;systohc &ndash;utc</p></li>
<li><p>Set hostname:</p>

<p> # echo blackpad > /etc/hostname
 # vi /etc/hosts</p></li>
<li><p>Config wireless (modify the wireless name based on your machine):</p>

<p> # pacman -S iw wpa_supplicant dialog wpa_actiond
 # systemctl enable <a href="&#x6d;&#97;&#x69;&#x6c;&#116;&#111;&#58;&#110;&#x65;&#x74;&#99;&#116;&#x6c;&#45;&#x61;&#117;&#116;&#x6f;&#x40;&#x77;&#x6c;&#x70;&#x35;&#115;&#48;&#46;&#x73;&#x65;&#114;&#118;&#x69;&#x63;&#x65;">&#110;&#x65;&#x74;&#99;&#x74;&#x6c;&#x2d;&#97;&#x75;&#x74;&#111;&#64;&#x77;&#108;&#112;&#53;&#x73;&#x30;&#x2e;&#115;&#101;&#x72;&#118;&#105;&#99;&#101;</a></p></li>
<li><p>Set root passwd:</p>

<p> # passwd</p></li>
<li><p>Install and configure a bootloader:</p>

<p> # pacman -S gptfdisk
 # pacman -S syslinux     // install syslinux boot loader because we create gpt partition earlier. Install grub will produce an error.
 # syslinux-install_update -i -a -m
 # vi /boot/syslinux/syslinux.cfg     // modify &ldquo;APPEND root=/dev/sda1 rw&rdquo; in &ldquo;LABEL arch&rdquo; section</p></li>
<li><p>Shutdown, unplugged usb key and restart laptop;</p></li>
<li><p>Start wifi connection:</p>

<p> # wifi-menu wlp5s0     // get interface name with <code>iw dev</code></p></li>
</ol>


<p>Choose a SSID, enter the key, press &ldquo;OK&rdquo;, then you can see &ldquo;Interface wlp5s0 is controlled by netctl-auto&rdquo;, use <code>ip addr</code> or <code>ping ...</code> to verify network.</p>

<ol>
<li><p>Install SSH service:</p>

<p> # pacman -Syu openssh
 # systemctl start sshd
 # systemctl enable sshd.service</p></li>
</ol>


<h1>Install the second System</h1>

<ol>
<li><p>Start laptop with YUMI usb key;</p></li>
<li><p>Startup a openSUSE 13.1 live dvd, install system on /dev/sda3 and /dev/sda4, reboot;</p></li>
<li><p>startup laptop, it prints: multiple active partitions, start failed;</p></li>
<li><p>Startup labtop with Arch USB key, delete openSUSE partitions, reboot, Arch is back;</p></li>
<li><p>Startup a CentOS live DVD, install system on /dev/sda3 and /dev/sda4, rebuild boot loader, reboot;</p></li>
<li><p>Startup laptop, only CentOS can start, it print &ldquo;boot error&rdquo; when choose &ldquo;Arch Linux&rdquo; to start;</p></li>
<li><p>Startup labtop with Arch USB key, delete CentOS partitions, reboot, only a GNU Grub command line;</p></li>
</ol>


<p>This experiment failed.</p>

<h1>Install i3</h1>

<pre><code># useradd -m -s /usr/bin/bash chad
# pacman -S xorg-server xorg-server-utils xorg-xinit
# pacman -S dmenu i3
# pacman -S gnome     // this big one (almost 1GB) is necessary, only gnome-shell can't work
# pacman -S xf86-video-intel xf86-input-synaptics
// video and touchpad driver, there will be a "could not open module intel" error without them
// they take effect after installation without reboot
# su - chad
$ echo "exec i3" &gt;  ~/.xinitrc
$ startx
</code></pre>

<h1>Install Chinese IM</h1>

<pre><code># pacman -S ibus-libpinyin
# su - chad
$ ibus-setup
</code></pre>

<p>Then select &ldquo;Chinese - Intelligent Pinyin&rdquo; under &ldquo;Input Method&rdquo; tab, and click &ldquo;Preferences&rdquo; to customize it.
The package &ldquo;ibus-sunpinyin&rdquo; is OK, too.
&ldquo;ibus-pinyin&rdquo; can&rsquo;t work properly.
&ldquo;ibus-rime&rdquo; can only input traditional Chinese.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/02/133411/">Gentoo Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-02T13:34:11+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>1:34 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Install</h1>

<p>Follow <a href="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml">Gentoo Linux x86 Handbook</a>.</p>

<ol>
<li><p>Download gentoo install CD install-x86-minimal-20140415.iso from its website <a href="http://distfiles.gentoo.org/releases/x86/autobuilds/current-install-x86-minimal/">x86 minimal site</a>;</p></li>
<li><p>Create USB installer: <code>dd bs=4M if=warez/archlinux-2014.04.01-dual.iso of=/dev/sdb &amp;&amp; sync</code>;</p></li>
<li><p>Use this usb key start the laptop;</p></li>
<li><p>Create a wpa_supplicant conf file:</p>

<p> $ cat /etc/wpa_supplicant/wpa_supplicant.conf
 network={
     ssid=&ldquo;TP-LINK&hellip;&rdquo;
     psk=&ldquo;py&hellip;&rdquo;
     scan_ssid=1
     proto=WPA2
 }</p></li>
<li><p>Connect WiFi: <code>/etc/init.d/wpa_supplicant start</code>, verify: ping another host in your wifi network;</p></li>
<li><p>Test network with <code>ping www.baidu.com</code>, if you can&rsquo;t connect to it, config network:</p>

<p> # ifconfig wlp5s0 down
 # ifconfig wlp5s0 192.168.1.103 broadcast 192.168.1.255 netmask 255.255.255.0 up
 # route add default gw 192.168.1.253   // get gateway IP with <code>route -n</code> on another host</p></li>
</ol>


<p>If you still can&rsquo;t ping a internet website, run <code>dhcpcd wlp5s0</code> to generate nameservers(stored in /etc/resolv.conf);</p>

<ol>
<li><p>Partition disk;</p></li>
<li><p>The command &ldquo;emerge-webrsync&rdquo; in step &ldquo;Configuring Portage&rdquo; which download Portage snapshot from 163.com is very slow(about 15 minutes);</p></li>
<li><p>Config kernel manually: <code>make menuconfig</code>: Processor type and features -> Processor family: Core 2/newer Xeon, but there are many errors due to hardware info mismatch. So I give up and use &ldquo;genkernel&rdquo; utility to compile the kernel. It takes about 25 minutes;</p></li>
<li><p><code>ls /boot/kernel*</code>: /boot/kernel-genkernel-x86-3.12.13-gentoo; <code>ls /boot/initr*</code>: /boot/initramfs-genkernel-x86-3.12.13-gentoo</p></li>
<li><p>Install vim with <code>emerge vim</code>;</p></li>
<li><p><code>emerge sys-boot/grub</code> is slow;</p></li>
<li><p>After reboot, only loopback nic is detected wiht <code>ifconfig</code> command.</p>

<p> # modprobe wlp5s0
 modprobe: FATAL: Module wlp5s0 not found
 # ifconfig wlp5s0 up
 wlp5s0: ERROR while getting interface flags: No such device
 # dmesg | grep iwlwifi
 &hellip; request for firmware file &lsquo;iwlwifi-1000-5.ucode&rsquo; failed.
 &hellip;</p>

<p> # genkernel &ndash;menuconfig all
 mark &ldquo;Intel Wireless WiFi MVM Firmware support&rdquo;
 Device Drivers -> Network device support (NETDEVICES) -> Wireless LAN (WLAN) -> IEEE 802.11 for Host AP -> Support downloading firmw
                                                       -> ISDN Support -> Siemens Gigaset support
                                                       -> Ethernet driver support: all intel ethernet drivers
 # emerge -v iwlwifi-1000-5.ucode</p></li>
</ol>


<p>Start with usb key, Create a wpa_supplicant conf file;</p>

<pre><code># /etc/init.d/wpa_supplicant start  // connect to wifi.
# mount /dev/sda4 /mnt/gentoo  // 4.f: Mounting
# mkdir /mnt/gentoo/boot
# mount /dev/sda2 /mnt/gentoo/boot
# mount -t proc proc /mnt/gentoo/proc // 6.a. Chrooting: Mounting the necessary Filesystems;
# mount --rbind /sys /mnt/gentoo/sys
# mount --rbind /dev /mnt/gentoo/dev
# chroot /mnt/gentoo /bin/bash 
# source /etc/profile
# export PS1="(chroot) $PS1"
# emerge sys-apps/pciutils   // install lspci
# emerge ...      // install iwconfig
# ifconfig -a
wlp5s0 ...
# emerge net-wireless/wpa_supplicant
#ls /lib/firmware/
// there is no "iwlwifi-1000-5.ucode microcode.dat"
# emerge sys-kernel/linux-firmware
# ls /lib/firmware/iwlwifi*
/lib/firmware/iwlwifi-1000.5.ucode
# create the wpa_supplicant.conf file
# /etc/init.d/net.wlp5s0 start
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/01/121138/">Package Management on Arch Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-01T12:11:38+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>12:11 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Search packages: <code>pacman -Ss pkg1 pkg2 ...</code>;</p>

<p>Install packages with updated repo: <code>pacman -Syu pkg1 pkg2 ...</code>;</p>

<p>Remove a package and its dependencies which is not required by other installed packages: <code>pacman -Rs pkg1</code>;</p>

<p>Remove a package and leaving all its dependencies installed: <code>pacman -R pkg1</code>;</p>

<p>Remove all orphaned packages: <code>pacman -Rns $(pacman -Qtdq)</code>;</p>

<p>Ref: <a href="https://wiki.archlinux.org/index.php/pacman">pacman</a> on Arch Linux.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/01/112805/">I3 Window Manager on ArchLinux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-01T11:28:05+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>11:28 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>i3 is a good wm(window manager), it&rsquo;s powerful and easy to install. It supports system tray, app like golden-dict will have a icon in system tray after it&rsquo;s closed.</p>

<h1>Install</h1>

<pre><code># pacman -S xorg-server xorg-server-utils
# pacman -S xorg-xinit
# pacman -S dmenu
# pacman -Syu gnome    // use `pacman -Rsc gnome` to remove package and its dependencies
# pacman -S i3
$ echo "exec i3" &gt;  ~/.xinitrc
$ startx
</code></pre>

<h1>Configuration</h1>

<p>Config file: ~/.i3/config.</p>

<p>Define Alt key:</p>

<pre><code>set $mod Mod4
</code></pre>

<p>Define Win key:</p>

<pre><code>set $sup Mod1
</code></pre>

<p>Adjust the font of titlebar:</p>

<pre><code>font pango:Dejavu Sans Mono 11
</code></pre>

<p>Add custom keybindings:</p>

<pre><code>bindsym $sup+x exec /home/chad/apps/idea-IC-135.690/bin/idea.sh
</code></pre>

<h1>Application Autostart</h1>

<p>Add start command <strong>before</strong> &ldquo;exec i3&rdquo; in ~/.xinitrc.
For example, the following lines in ~/.xinitrc start USB stisk, clipboard and Chinese input method manager when i3wm startup:</p>

<pre><code>fcitx &amp;
parcellite &amp;
udiskie &amp;
xbindkeys
exec i3
</code></pre>

<h1>Search Application</h1>

<p>You can use dmenu as xfce4-appfinder on Xfce.
For example, after install R-Studio-Desktop with <code>yaourt -S rstudio-desktop-bin</code>,
input &lsquo;studio&rsquo; in dmenu (press Alt-D to invoke it),
you can find the full name of RStudio Desktop is &ldquo;rstudio-bin&rdquo;.</p>

<h1>Applications</h1>

<h2>Terminal and File Manager</h2>

<p>Xfce family is small and powerful. Install them with <code>pacman -S xfce4-terminal</code> and <code>pacman -S thunar</code>.
xfce4-terminal is much better for eyes than Terminator.</p>

<h2>Web Browser</h2>

<p>Install Chromium with <code>sudo pacman -S chromium</code>.
Install flash plugin for Chromium with <code>yaourt -S chromium-pepper-flash</code>.
Now you can use website which need flash support, such as <a href="http://pan.baidu.com/">Baidu Netdisk</a>.</p>

<h2>Text Editor</h2>

<p>Clipboard-support enabled vim: gvim;</p>

<h2>PDF Viewer</h2>

<p>Evince is small and poweroff. Install it with <code>sudo pacman -S evince</code>.</p>

<h2>Office Suite</h2>

<p><a href="http://www.wps.cn/">WPS</a> is OK, but the fcitx doesn&rsquo;t work in it.</p>

<p>Installed <a href="http://www.freeoffice.com/">FreeOffice</a>, it need providing Email to activate, give up.</p>

<p>fcitx can be used in Abiword. But Abiword is only a word processor, no spred sheets support.</p>

<h1>Wireless Card</h1>

<ol>
<li><p>Install wifi utilities: <code>pacman -S iw wpa_supplicant dialog wpa_actiond</code>;</p></li>
<li><p>List wireless card status: <code>iwconfig</code>;</p></li>
<li><p>Scan and Connect to hot point: <code>sudo wifi-menu</code></p></li>
<li><p>Remember this hot point for auto-connection later (modify the wireless name based on your machine): <code>systemctl enable netctl-auto@wlp5s0.service</code>;</p></li>
</ol>


<p>Ref:</p>

<p><a href="https://wiki.archlinux.org/index.php/Wireless_network_configuration">Wireless network configuration</a></p>

<p><a href="https://wiki.archlinux.org/index.php/Netctl">netctl</a></p>

<h1>Status Bar Customization</h1>

<p>For i3status, use <code>man i3status</code> to determine the configuration file position, here it&rsquo;s ~/.config/i3status/config.
Then <code>cp /etc/i3status.conf ~/.i3status.conf</code> as template. Modify the ethernet and wireless card name in <strong>both</strong> &ldquo;order += &hellip;&rdquo; and function definition line.</p>

<h1>Frequently used keybindings</h1>

<p>&ldquo;M&rdquo; means $mod key, &ldquo;S&rdquo; means Shift key.</p>

<ul>
<li><p>M-d: application launcher;</p></li>
<li><p>M-<Enter>: start a termianl;</p></li>
<li><p>M-f: full screen current app;</p></li>
<li><p>M-S-q: quit</p></li>
<li><p>M-S-c: reload config without restart;</p></li>
<li><p>M-2: jump to workspace 2;</p></li>
<li><p>M-S-2: move application to workspace 2;</p></li>
</ul>


<h1>USB Automount &amp; Unmount</h1>

<p>See note &ldquo;Automount USB Disk on Linux&rdquo;.</p>

<h1>Power Management</h1>

<p>First install polkit with <code>sudo pacman -S polkit</code>, which enable normal users run power management command without root privilege (sudo).
Then add a executable script into /usr/local/bin:</p>

<pre><code>cat /usr/local/bin/pm
#!/bin/sh
lock() {
    i3lock
}

case "$1" in
    lock)
        lock
        ;;
    logout)
        i3-msg exit
        ;;
    suspend)
        lock &amp;&amp; systemctl suspend
        ;;
    hibernate)
        lock &amp;&amp; systemctl hibernate
        ;;
    reboot)
        systemctl reboot
        ;;
    shutdown)
        systemctl poweroff
        ;;
    *)
        echo "Usage: $0 {lock|logout|suspend|hibernate|reboot|shutdown}"
        exit 2
esac

exit 0
$ sudo chmod 755 /usr/local/bin/pm
</code></pre>

<p>Now using <code>pm suspend</code> to suspend, <code>pm reboot</code> to reboot, and <code>pm shutdown</code> to shutdown computer.</p>

<p>Ref: <a href="https://wiki.archlinux.org/index.php/I3#Shutdown.2C_reboot.2C_lock_screen">i3 on Arch Wiki</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/01/093834/">Add Chinese Character Display Support on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-01T09:38:34+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>9:38 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If your termianl can&rsquo;t display UTF-8 character correctly, check the following:</p>

<ol>
<li><p>If this terminal is set to display UTF-8 character?</p>

<p> $ echo -e &lsquo;\xe2\x82\xac&rsquo;
 €</p></li>
</ol>


<p>If the euro sign can&rsquo;t be displayed, then ssh to this host via another host which can display UTF-8 character, and run this command remotely via ssh. If the euro sign displayed, it&rsquo;s verified your terminal do not support UTF-8, you have to install another UTF-8 supported terminal.</p>

<p>Ref: &ldquo;My terminal doesn&rsquo;t support UTF-8&rdquo; in <a href="https://wiki.archlinux.org/index.php/locale">Locale</a> of ArchLinux Documentation.</p>

<p>Otherwise it&rsquo;s the case of your settings.</p>

<h1>Ubuntu</h1>

<p>List all locales installed on the system:</p>

<pre><code>$ locale -a
</code></pre>

<p>Test result:</p>

<pre><code>$ LC_ALL=en_US.utf-8   // notice LC_ALL=en_US can't display UTF-8 charaters correctly!
</code></pre>

<p>Enable it permanently: add &ldquo;LANG=en_US.UTF-8&rdquo; or &ldquo;LC_ALL=en_US.UTF-8&rdquo; into /etc/default/locale, and refresh it:</p>

<pre><code>$ sudo locale-gen
</code></pre>

<h1>Arch Linux</h1>

<pre><code>$ sudo pacman -Syu vim  // install vim and xxd
</code></pre>

<h1>Convert file encodings</h1>

<pre><code>$ iconv -l | GBK
$ iconv -l | UTF-8
$ iconv -f gbk -t utf-8 &lt;filename&gt;
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/30/110339/">A Powerful Linux Command Line Calculator Based on Bc</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-30T11:03:39+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:03 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Create a shell script named my-calculator.sh under ~/apps:</p>

<pre><code>#!/bin/bash

# Example: ./my-calculator ih od 23A+34B =&gt; echo 'ibase=16;obase=10;23A+34B' | bc
#     where "ih" means "input is hex", "od" means "output is decimal"
#     ./my-calculator ih oh echo 'ibase=16;obase=10;A+A' | bc

if [[ $# -gt 3 ]]; then
    echo Bad format: more than 3 arguments found
    exit 1
fi
in=10
out=10
for op in $@; do
    if [[ $op = 'ib' ]]; then
        in=2
    elif [[ $op = 'id' ]]; then
        in=10
    elif [[ $op = 'ih' ]]; then
        in=16
    elif [[ $op = 'ob' ]]; then
        out=2
    elif [[ $op = 'od' ]]; then
        out=10
    elif [[ $op = 'oh' ]]; then
        out=16
    else 
        expr=$op
    fi
done
echo echo \"obase=$out\;ibase=$in\;$expr\" \| bc
echo "obase=$out;ibase=$in;$expr" | bc
</code></pre>

<p>Note: put obase BEFORE ibase, or the obase will based on ibase. For example, the result of</p>

<pre><code>echo "ibase=16;obase=10;A+A" | bc
</code></pre>

<p>is 14, but not 20. After &ldquo;ibase=16&rdquo;, the &ldquo;10&rdquo; in &ldquo;obase=10&rdquo; is actually a hex, not a decimal. To avoid interfered by ibase, we should always declare obase before ibase.</p>

<p>Now add &ldquo;alias mc=/home/chad/apps/my-calculator.sh&rdquo; into your ~/.zshrc, you can do hex calculation by:</p>

<pre><code>$ mc ih oh A+A
</code></pre>

<p>Add hex numbers and output to decimal:</p>

<pre><code>$ mc ih A+A
</code></pre>

<p>Convert a hex into decimal:</p>

<pre><code>$ mc ih 23B
</code></pre>

<p>Convert a decimal to hex:</p>

<pre><code>$ mc oh 23432
</code></pre>

<p>Some ordinary decimal calculation:</p>

<pre><code>$ mc 234+345
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/29/180645/">C++ Develop Environment With Vim on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-29T18:06:45+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>6:06 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>ctags</h1>

<h2>Install</h2>

<pre><code>$ sudo apt-get install exuberant-ctags
</code></pre>

<h2>Usage</h2>

<pre><code>$ cd $PROJECT_HOME
$ ctags -R *
$ vi MyApp.cpp
</code></pre>

<p>Some frequently used shortcuts:</p>

<ul>
<li><p>Go to definition: Ctrl-]</p></li>
<li><p>Jump back from definition: Ctrl-t</p></li>
<li><p>C-w C-]: Open the definition in a horizontal split</p></li>
<li><p>C-o/i: jump between items in jump list;</p></li>
<li><p>gf: &ldquo;go to file&rdquo;, open the file under the cursor;</p></li>
<li><p>gd: &ldquo;go to definition&rdquo;, go to the definition of a variable;</p></li>
</ul>


<p>Ref: <a href="http://stackoverflow.com/questions/563616/vim-and-ctags-tips-and-tricks">http://stackoverflow.com/questions/563616/vim-and-ctags-tips-and-tricks</a></p>

<h1>Buffer explorer</h1>

<h2>Install</h2>

<ol>
<li><p>Download bufexplorer-7.4.2.zip from <a href="http://www.vim.org/scripts/script.php?script_id=42">it&rsquo;s website</a>;</p></li>
<li><p>unzip it to ~/.vim/bundle/ (you have to install pathogen before hand);</p></li>
<li><p>restart vim;</p></li>
</ol>


<h2>Usage</h2>

<p>:h buffer-explorer</p>

<p><leader>be, <leader>bs, <leader>bv</p>

<p>I defined my <leader> key to comma(let mapleader=&ldquo;,&rdquo;) in .vimrc, so open buffer explorer window with &ldquo;,be&rdquo;.</p>

<h1>Tagbar</h1>

<p>This plugin is for C/C++ code outline.</p>

<p>Installation: Downlaod majutsushi-tagbar-v2.6.1-0-ge872e67.zip from <a href="http://majutsushi.github.io/tagbar/">it&rsquo;s website</a>, unzip to ~/.vim/bundle/ and restart vim.</p>

<p>:h tagbar</p>

<p>:TagbarToogle to open outline window; try <Enter>, p, <Space> in outline window.</p>

<h1>c.vim</h1>

<p>Download cvim.zip v6.1.1 from its <a href="http://www.vim.org/scripts/script.php?script_id=213">website</a>. Unzip it to ~/.vim/bundle.</p>

<p>Add the following line  to ~/.vimrc to override the default <leader> key:</p>

<pre><code>let g:C_MapLeader  = ','
</code></pre>

<p>Use &ldquo;,rc&rdquo; to save and compile. Use <code>:cn</code>, <code>:cp</code>, <code>:cfirst</code>, <code>:clast</code>, <code>:cc</code>, <code>:cclose</code>, <code>:copen</code> to traverse in quickfix list (see <code>:h quickfix</code> for full list of hotkeys).</p>

<p>Use F9 or &ldquo;,rr&rdquo; to run source file.</p>

<p>Use &ldquo;2. Usage without GUI&rdquo; and &ldquo; 3. Hotkeys&rdquo; in <code>:h csupport</code> for full list of hotkeys.</p>

<h1>Configuration for REPL</h1>

<ol>
<li><p>Add &ldquo;:nnoremap <F5> :<C-U>make %:r &amp;&amp; ./%:r<CR>&rdquo; to ~/.vimrc;</p></li>
<li><p>Open vim, copy the following c++ codes into it:</p>

<p> using namespace std;</p>

<p> int main() {
     cout &lt;&lt; &ldquo;hello C++.\n&rdquo;;
 }</p></li>
<li><p>Save the file, syntastic(search tag syntastic for installation and usage details) will report an error: ‘cout’ was not declared in this scope</p></li>
<li><p>Add &ldquo;#include <iostream>&rdquo; at the beginning of the file, save it, and press <F5>, you can see the result;</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/29/114303/">Java Bitwise Operations</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-29T11:43:03+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:43 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Some bitwise operations in groovy shell, better install this shell via gvm.</p>

<pre><code>$ groovysh
groovy:000&gt; bb = 205
===&gt; 205
groovy:000&gt; cc = -51
===&gt; -51
groovy:000&gt; Integer.toBinaryString(bb)
===&gt; 11001101
groovy:000&gt; Integer.toBinaryString(cc)
===&gt; 11111111111111111111111111001101
groovy:000&gt; Integer.toBinaryString(cc &gt;&gt; 2)
===&gt; 11111111111111111111111111110011
groovy:000&gt; Integer.toBinaryString(cc &gt;&gt;&gt; 2)
===&gt; 111111111111111111111111110011
groovy:000&gt; bb == (cc &amp; 0xFF)
===&gt; true
</code></pre>

<p>So Java use 4 bytes to represent a integer. The left-most bit is &ldquo;1&rdquo; when the integer is a negative, otherwise the position is &ldquo;0&rdquo;.
The &ldquo;var &amp; 0xFF&rdquo; converts the first 3 bytes to 0. In other words, this method converts var into 0~255.</p>

<p>Conversion between binary string and integer and bytes.</p>

<pre><code>groovy:000&gt; aa = 45
===&gt; 45
groovy:000&gt; aas = Integer.toBinaryString(aa)
===&gt; 101101
groovy:000&gt; aa == Byte.parseByte(aas, 2)
===&gt; true
groovy:000&gt; aa.getClass()
===&gt; class java.lang.Integer
groovy:000&gt; aas.getClass()
===&gt; class java.lang.String
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/29/093749/">Analyze Binary File in Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-29T09:37:49+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:37 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On Linux there are some utility to analyze binary files, such as xxd, od, hexdump, which are much convenient and powerful than UltraEdit on Windows.</p>

<pre><code>$ cat test
abcdefg
hijklmn
opq
rst
uvw
xyz

$ xxd test
0000000: 6162 6364 6566 670a 6869 6a6b 6c6d 6e0a  abcdefg.hijklmn.
0000010: 6f70 710a 7273 740a 7576 770a 7879 7a0a  opq.rst.uvw.xyz.

$ xxd -b test
0000000: 01100001 01100010 01100011 01100100 01100101 01100110  abcdef
0000006: 01100111 00001010 01101000 01101001 01101010 01101011  g.hijk
000000c: 01101100 01101101 01101110 00001010 01101111 01110000  lmn.op
0000012: 01110001 00001010 01110010 01110011 01110100 00001010  q.rst.
0000018: 01110101 01110110 01110111 00001010 01111000 01111001  uvw.xy
000001e: 01111010 00001010                                      z.

$ xxd -b -s 10 test
000000a: 01101010 01101011 01101100 01101101 01101110 00001010  jklmn.
0000010: 01101111 01110000 01110001 00001010 01110010 01110011  opq.rs
0000016: 01110100 00001010 01110101 01110110 01110111 00001010  t.uvw.
000001c: 01111000 01111001 01111010 00001010                    xyz.

$ xxd -b -s 0x10 test
0000010: 01101111 01110000 01110001 00001010 01110010 01110011  opq.rs
0000016: 01110100 00001010 01110101 01110110 01110111 00001010  t.uvw.
000001c: 01111000 01111001 01111010 00001010                    xyz.

$ xxd -b -s 3 -l 10 test
0000003: 01100100 01100101 01100110 01100111 00001010 01101000  defg.h
0000009: 01101001 01101010 01101011 01101100                    ijkl

$ xxd -b -s 3 -l 10 -c 1 test
0000003: 01100100  d
0000004: 01100101  e
0000005: 01100110  f
0000006: 01100111  g
0000007: 00001010  .
0000008: 01101000  h
0000009: 01101001  i
000000a: 01101010  j
000000b: 01101011  k
000000c: 01101100  l

$ xxd -p -s 3 -l 10 test
646566670a68696a6b6c
</code></pre>

<p>Compare hex and binary files line by line:</p>

<pre><code>$ xxd -b -c 2 binaryfile &gt; o1
$ xxd -c 2 binaryfile &gt; o2
$ paste o1 o2
0000000: 11001101 11001101  ..  0000000: cdcd  ..
0000002: 00000000 00101110  ..  0000002: 002e  ..
0000004: 10011000 00000011  ..  0000004: 9803  ..
0000006: 11101011 00100000  .   0000006: eb20  . 
0000008: 00000010 10001011  ..  0000008: 028b  ..
000000a: 01000011 00111000  C8  000000a: 4338  C8
000000c: 00001011 10111111  ..  000000c: 0bbf  ..
000000e: 10011011 01100101  .e  000000e: 9b65  .e
0000010: 10000111 00001111  ..  0000010: 870f  ..
0000012: 00100000 00100000      0000012: 2020    
0000014: 00000010 00011100  ..  0000014: 021c  ..
0000016: 01111001 00000001  y.  0000016: 7901  y.
0000018: 01110110 01011100  v\  0000018: 765c  v\
000001a: 00000000 00011011  ..  000001a: 001b  ..
000001c: 00101100 01111101  ,}  000001c: 2c7d  ,}
000001e: 00010001 00011011  ..  000001e: 111b  ..
0000020: 01100101 10001111  e.  0000020: 658f  e.
0000022: 10100010 01010100  .T  0000022: a254  .T
0000024: 10101000 01011011  .[  0000024: a85b  .[
0000026: 00101100 10010011  ,.  0000026: 2c93  ,.
0000028: 11100101 01110100  .t  0000028: e574  .t
000002a: 00100010 11011001  ".  000002a: 22d9  ".
000002c: 01100000 01100000  ``  000002c: 6060  ``
000002e: 11101001 00011111  ..  000002e: e91f  ..
0000030: 00000000 00000000  ..  0000030: 0000  ..
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/24">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/22">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/05/28/102822/">Penetrate GFW With Sshuttle</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/27/180718/">Store Small Images in MongoDB via Base64</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/26/174257/">Meteor基础知识之系统篇</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/15/142023/">Run MongoDB Server on Docker in VPS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/091733/">Git初体验</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
