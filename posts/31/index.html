
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Install pip sudo apt-get python-pip Install package with pip sudo pip install fabric List all installed packages pip freeze List some packages pip &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/31">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leetschau.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/04/101920/">Manage Python Packages With Pip</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-04T10:19:20+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:19 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Install pip</h1>

<pre><code>sudo apt-get python-pip
</code></pre>

<h1>Install package with pip</h1>

<pre><code>sudo pip install fabric
</code></pre>

<h1>List all installed packages</h1>

<pre><code>pip freeze
</code></pre>

<h2>List some packages</h2>

<pre><code>pip freeze | grep "[F|f]abric"
</code></pre>

<p>Note: Double quotes after grep is necessary;</p>

<h1>Uninstall packages with pip</h1>

<pre><code>sudo pip uninstall Fabric
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/02/161537/">Get Coverage Data for Standalone Server With Cobertura</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-02T16:15:37+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2013</span></span> <span class='time'>4:15 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Prerequisites</h1>

<p>Copy cobertura.jar (1.9.1), asm-3.0.jar, asm-tree-3.0.jar, jakarta-oro-2.0.8.jar, log4j-1.2.15.jar totally 5 jars to a folder (in this case it is: &ldquo;/home/lichao/apps/coberturaLib&rdquo;).</p>

<p>If using cobertura-2.0.3, copy cobertura.jar and all jars in folder &ldquo;lib&rdquo; to &ldquo;coberturaLib&rdquo;.</p>

<p>The current working directory is project home folder, under which there are 3 folders: cmd, conf, lib.</p>

<h1>Instrument</h1>

<p>Now we need instrument class files under &ldquo;class&rdquo; folder to &ldquo;instru&rdquo; folder:</p>

<p> java -cp &ldquo;/home/lichao/apps/coberturaLib/*&rdquo; net.sourceforge.cobertura.instrument.Main &ndash;destination instru class</p>

<p>Note the double quotes of &ldquo;/home&hellip;/coberturaLib/*&rdquo; is necessary.</p>

<p>If you use cobertura-2.0.3, add project dependencies ($PROJ_HOME/lib), too:</p>

<p> java -cp &ldquo;/home/lichao/apps/coberturaLib/<em>:../lib/</em>&rdquo; net.sourceforge.cobertura.instrument.Main &ndash;destination CalcServer &ndash;datafile CalcServer/cobertura.ser CalcServer.jar</p>

<p>Synopsis:</p>

<p> java -cp <Cobertura_lib> net.sourceforge.cobertura.instrument.Main &ndash;destination <dest_folder> &ndash;datafile <datafile_path> <target></p>

<p>If <target> is a folder containing class files, instrumented class files will be created under <dest_folder>. If <target> is a jar file, instrumented jar file will be created under <dest_folder>. If &ldquo;&ndash;destination <dest_folder> is not specified, the instrumented one will overwrite the origin.</p>

<h1>Start Server</h1>

<p>This step equals to &ldquo;unit test&rdquo; in junit-cobertura scenario. The start.sh is:</p>

<p> #!/bin/sh
 CoberturaJar=&ldquo;/home/lichao/apps/coberturaLib/cobertura-2.0.3.jar&rdquo;
 JARS=&ldquo;$CoberturaJar:conf:./<em>:lib/</em>&rdquo;
 java -cp $JARS -Dnet.sourceforge.cobertura.datafile=cobertura.ser com.boco.deploy.Main</p>

<p>Note: The instrumented jar must be add <strong>before</strong> uninstrumented jar in classpath.</p>

<p>Synopsis:</p>

<p> java -cp &lt;cobertura.jar_path>:<other_dependencies> -Dnet.sourceforge.cobertura.datafile=<datafile_path> Server.Main.Class.Name</p>

<h1>Merge Datafile</h1>

<p> java -cp &ldquo;coberturaLib-2.0.3/*&rdquo; net.sourceforge.cobertura.merge.Main &ndash;datafile GcpCollector/cmd/cobertura.ser GcpServerCore/cmd/cobertura.ser cobertura.ser</p>

<h1>Get Report</h1>

<p> java -cp &ldquo;/home/lichao/apps/coberturaLib/*&rdquo; net.sourceforge.cobertura.reporting.Main &ndash;datafile cobertura.ser &ndash;destination ../report ../../src</p>

<p>The report data will not be written to report files until the server process is down.</p>

<p>Synopsis:</p>

<p> java -cp <cobertura_lib> net.sourceforge.cobertura.reporting.Main &ndash;datafile <datafile_path> &ndash;destination <report_path> <source_folder></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/31/223240/">Network Promgramming in Clojure</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-31T22:32:40+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>10:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>TCP echo server: <a href="http://stackoverflow.com/questions/1223352/writing-a-multiplexing-server-in-clojure">http://stackoverflow.com/questions/1223352/writing-a-multiplexing-server-in-clojure</a></p></li>
<li><p>Asynchronous communication framework based on Netty: <a href="https://github.com/ztellman/aleph/wiki">aleph</a></p></li>
<li><p>System admin and deployment tool: <a href="https://github.com/killme2008/clojure-control">clojure-control</a></p></li>
<li><p>Cloud Automation Tool (build Hadoop cluster on Amazon EC2): <a href="http://palletops.com/">Pallet</a></p></li>
<li><p>SSH client based on jsch: <a href="https://github.com/hugoduncan/clj-ssh">clj-ssh</a></p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/30/180938/">Copy, Tag and Branch of Subversion</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-30T18:09:38+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:09 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Tag and branch are the same from the point of view of svn server. They are both the &ldquo;copy&rdquo; operation (this is why they use the same menu item in TortoiseSVN, they are actually the &ldquo;svn copy&rdquo; command). Copy operation of svn server will create a link to original revision. So create tag or branch will not double the disk space usage. The disk space usage is actually related with how many files are modified based on a specific revision.</p>

<p>What is the difference of tag and branch? When you create a &ldquo;tag&rdquo;, you mean you will save this link at a &ldquo;baseline area&rdquo; where it&rsquo;s prohibited to do checkout-modify-checkin operation. On the contrary, if you create a &ldquo;branch&rdquo;, you will do checkout-modify-checkin operation in the future for new feature development or bug fix.</p>

<p>Use &ldquo;svn help copy&rdquo; for explanations.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/29/210003/">Auto Deploy Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-29T21:00:03+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>9:00 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li>Write a property file: /home/bvt/docs/jenkinsEnv.properties:</li>
</ol>


<p> gcp.job.type=deliver
 gcp.deliver.ip=10.0.7.142
 gcp.deliver.user=gcp
 gcp.deliver.home=/home/gcp
 gcp.deliver.deployFolder=deploy
 gcp.deliver.prompt=gcp@cloud142</p>

<p>Note: Do <strong>not</strong> leave blanks between &ldquo;=&rdquo; and values in property file.</p>

<p> gcp.deliver.home = /home/gcp</p>

<p>will produce wrong value when gotten by expect script.</p>

<ol>
<li><p>Add this file to &ldquo;Build Environment -> Inject environment variables to the build process&rdquo; in Jenkins Job Configure panel with Environment Injector plugin.</p></li>
<li><p>Create a deploy script (deploy.exp) in project base folder:</p></li>
</ol>


<p> #!/usr/bin/expect
 set artifact [lindex $argv 0]
 spawn scp $artifact $env(gcp.deliver.user)@$env(gcp.deliver.ip):$env(gcp.del
 expect eof</p>

<ol>
<li>Create a &ldquo;Conditional step(single)&rdquo; with conditional-buildstep plugin.</li>
</ol>


<p> Run? Strings match</p>

<p>  String 1: ${ENV,var=&ldquo;gcp.job.type&rdquo;}</p>

<p>  String 2: deliver</p>

<p> Builder: Execute Shell</p>

<p>  Command: ./deploy.exp build/*.zip</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/28/181723/">Create Shortcut for SSH Hosts</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-28T18:17:23+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:17 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>You frequently visit host 10.0.7.141 for example. It&rsquo;s a waste to type &ldquo;ssh <a href="&#109;&#x61;&#x69;&#108;&#x74;&#111;&#58;&#103;&#x63;&#x70;&#64;&#49;&#48;&#x2e;&#x30;&#x2e;&#55;&#46;&#x31;&#52;&#x31;">&#103;&#x63;&#x70;&#x40;&#x31;&#48;&#x2e;&#x30;&#x2e;&#55;&#x2e;&#x31;&#52;&#x31;</a>&rdquo; every time you connect it. So you can create a file ~/.ssh/config, and add follow lines to it:</p>

<pre><code>Host 141 
Hostname 10.0.7.141 
User gcp 
[Port 22]
[IdentityFile ~/.ssh/id_rsa.pub]
</code></pre>

<p>Now you can use &ldquo;ssh 141&rdquo; to connect to this host.
Or use &ldquo;scp user@141:/home/user/&rdquo; to copy files.</p>

<p>With key authorization (see note &ldquo;Login SSH Server without Password&rdquo;), you can connect to this host without inputing password. You can copy local file to remote host with &ldquo;scp myfile 141:/target/path&rdquo;, and copy file on remote host to local folder with &ldquo;scp 141:/source/path/to/file /target/folder&rdquo;.</p>

<p>Note: IdentifyFile is the shortcut of &ldquo;-i /path/to/public-key&rdquo; option of &ldquo;ssh&rdquo; command;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/28/180743/">Create Shortcut to Get Jar File Meta Information</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-28T18:07:43+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:07 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>You have to get meta information of cobertura.jar with command &ldquo;unzip -q -c cobertura.jar META-INF/MANIFEST.MF&rdquo;. It&rsquo;s too long to write so we gonna create a shortcut &ldquo;getmeta&rdquo; for this command. Then we can use &ldquo;getmeta cobertura&rdquo; to get the same information.</p>

<p>In zsh, you can add following snippet into .zshrc:</p>

<p> getmeta() { unzip -q -c &ldquo;$*&rdquo;.jar META-INF/MANIFEST.MF }</p>

<p>You can also use command &ldquo;alias&rdquo; to define this. But it&rsquo;s not general like above.</p>

<p>In bash, add the following snippet to .bashrc or .bash_profile:</p>

<p> getmeta() { unzip -q -c &ldquo;$@&rdquo;.jar META-INF/MANIFEST.MF }</p>

<p>Ref:</p>

<p><a href="http://stackoverflow.com/questions/2904677/alias-with-parameters">http://stackoverflow.com/questions/2904677/alias-with-parameters</a></p>

<p><a href="http://stackoverflow.com/questions/4060880/shell-bash-passing-argument-to-alias">http://stackoverflow.com/questions/4060880/shell-bash-passing-argument-to-alias</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/28/111229/">Show Output and Internal Diagnostics of Expect Script in Different Terminals</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-28T11:12:29+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>11:12 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li><p>Start a terminal, run <code>tty</code> to get its device file name, &ldquo;/dev/pts/0&rdquo; in this case.</p></li>
<li><p>Start another terminal. Create a expect script &ldquo;testDebug.exp&rdquo;:</p>

<pre><code> #!/usr/bin/expect 
 set prompt "\\\[hadoop@49server\\s.*\\\]\\\$\\s" 
 spawn telnet 10.0.2.49 
 exp_internal 1 
 expect "login:" 
 send "hadoop\r" 
 expect "Password:" 
 send "h\r" 
 expect -re $prompt 
 send "df -h\r" 
 expect -re $prompt 
 send "exit\r" 
 expect eof
</code></pre></li>
<li><p>Give execution priority to testDebug.exp (using chmod) and run it: <code>./testDebug.exp 2&gt; /dev/pts/0</code>. You can see all diagnostics information are printed in the terminal &ldquo;/dev/pts/0&rdquo; while all &ldquo;normal&rdquo; informal are printed in the second terminal window.</p></li>
</ol>


<p>Explanation: the command &ldquo;exp_internal 1&rdquo; send all pattern diagnostics to standard error, which is specified as &ldquo;2> &hellip;&rdquo; in the command line. Meanwhile, a terminal&rsquo;s id can be get from &ldquo;tty&rdquo; command.</p>

<p>You can use &ldquo;exp_internal -f <log_file_name> 0&rdquo; instead of &ldquo;exp_internal 1&rdquo; to save all standard output and diagnostics information into file <log_file_name>. while only standard output can be seen on the terminal.</p>

<p>Reference: Section &ldquo;Enabling Internal Diagnostics&rdquo; and &ldquo;Logging Internal Diagnostics&rdquo; in chapter 7:&ldquo;Debugging Patterns And Controlling Output&rdquo; of &ldquo;Exploring Expect&rdquo; by Don Libes.</p>

<p>Notes: If you run command &ldquo;ls -l /dev/pts/*&rdquo;, you can get the following outputs:</p>

<pre><code>crw--w---- 1 lichao tty 136, 0 Aug 28 11:56 0
...
</code></pre>

<p>Notice that the file type are &ldquo;c&rdquo; (the first character of the line), which stands for &ldquo;character device&rdquo; (standard input/output, like keyboard and screen, relative to &ldquo;block device&rdquo;, like hard drives). See &ldquo;<a href="http://en.wikipedia.org/wiki/Unix_file_types#Device_file">http://en.wikipedia.org/wiki/Unix_file_types#Device_file</a>&rdquo; for details.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/27/111531/">Check Directory Existence in Shell</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-27T11:15:31+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>11:15 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The following command in one line can check if a directory exists. You can check the return value (&ldquo;yes or &#8220;no) then decide what to do.</p>

<p> $ if [ -d /home/gcp/deploy ] ; then echo &ldquo;yes&rdquo; ; else echo &ldquo;no&rdquo; ; fi</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/08/26/112747/">Get Tcl and Expect Version on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-26T11:27:47+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>11:27 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>tcl version</h1>

<p> $ tclsh</p>

<p> % puts $tcl_version
 8.5</p>

<h1>expect version</h1>

<p> $ expect -v</p>

<p> expect version 5.45</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/32">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/30">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/08/26/100107/">Build Redis on CentOS 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/24/110909/">Build Working Environment With I3 and Mint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/24/103023/">Install New Locale on Linux Mint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/21/113949/">Qtile on ArchLinux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/20/104236/">Closure in Different Languages</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
