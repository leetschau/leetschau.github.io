
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Ubuntu 11自带gcc和gdb，下面是使用gdb调试代码的过程： 首先写一个简单的hw.c程序： #include &lt;stdio.h> int main() { char str[] = &ldquo;hello, world&rdquo;; printf(&ldquo;%s\n& &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/70/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/11/131018/">Gdb Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-11T13:10:18+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>1:10 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ubuntu 11自带gcc和gdb，下面是使用gdb调试代码的过程：</p>

<ol>
<li><p>首先写一个简单的hw.c程序：</p>

<p> #include &lt;stdio.h>
 int main() {
     char str[] = &ldquo;hello, world&rdquo;;
     printf(&ldquo;%s\n&rdquo;,str);
     return 0;
 }</p></li>
<li><p>编译并运行源代码（gcc指令必须有-g选项，不能加-Wall选项，否则无法调试）：</p>

<p> chad@ubuntu:~/Documents$ gcc -g hw.c -o hw
 chad@ubuntu:~/Documents$ ./hw
 hello, world</p></li>
<li><p>用gdb调试编译出来的文件：</p>

<p> chad@ubuntu:~/Documents$ gdb hw
 GNU gdb (Ubuntu/Linaro 7.3-0ubuntu2) 7.3-2011.08
 &hellip;
 (gdb) b 3
 Breakpoint 1 at 0x8048449: file hw.c, line 3.
 (gdb) r
 Starting program: /home/chad/Documents/hw
 Breakpoint 1, main () at hw.c:3
 3   char str[] = &ldquo;hello, world&rdquo;;
 (gdb) p str
 $1 = &ldquo;\000\364\217*\000U&lt;\026\000\231\204\004\b&rdquo;
 (gdb) s
 4   printf(&ldquo;%s\n&rdquo;,str);
 (gdb) p str
 $2 = &ldquo;hello, world&rdquo;</p>

<p> (gdb) p str[1]=&lsquo;y&rsquo;   $3 = 121 &lsquo;y&rsquo;
 (gdb) p str
 $4 = &ldquo;hyllo, world&rdquo;</p>

<p> (gdb) p $2
 $5 = &ldquo;hello, world&rdquo;</p>

<p> (gdb) c
 Continuing.
 hello, world
 [Inferior 1 (process 3345) exited normally]
 (gdb) q
 chad@ubuntu:~/Documents$</p></li>
</ol>


<p>上述操作过程，代码前面的标号是行号。用户输入的指令，"b 3"表示在第3行打断点，r表示run，p表示print，s表示step（即step in），这里也可以用n（next，即step over），c表示continue，q表示quit。可以看到step指令之前打印str的值是一个随机值（因为还没有赋值），step之后（到第4行）就有了值；</p>

<p>p指令除了可以显示程序变量值，还可以修改变量值，如上面的p str[1]=&lsquo;y'；</p>

<p>gdb每次输出都被保持到了一个格式为$n的变量中，后面可以再引用这个变量，如上面的p $2；</p>

<p>可以用l(list)指令打印出完整的源代码。</p>

<h2>C++</h2>

<pre><code>$ g++ -g srcfile.cc -o rr
$ gdb rr
$ l
</code></pre>

<p>这里"-g"选项是必须的，否则gdb无法得到原文件信息。</p>

<h1>Windows平台</h1>

<p><a href="http://www.codeblocks.org/">Code::Blocks</a>是目前唯一实现了断点调试的Windows平台上C开发环境（它本身是跨平台的），带MinGW安装包100MB，不带MinGW的20MB多，比较符合轻量级的要求；</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/07/170351/">Pandoc笔记</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-07T17:03:51+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>5:03 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Mint 17上安装pandoc: <code>sudo aptitude install pandoc</code>;</p>

<p>将markdown文件转为MS Word docx文件：<code>pandoc -f markdown -t docx -o 开发者手册.docx dev-manual.md</code>;</p>

<h1>Pandoc的多级列表</h1>

<p>今天在用markdown写多级列表的时候发现markdown不支持多级列表，找了一番发现<a href="http://johnmacfarlane.net/pandoc/">Pandoc</a>是个比较好的替代工具。功能强（支持多级列表，配上插件可以生成pdf和docx文件），开源（GPL）。</p>

<h2>Hello World Demo (multi-level ordered list)</h2>

<ol>
<li><p>下载Pandoc for Windows；</p></li>
<li><p>写一个简单的示例demo.txt，内容如下：</p></li>
</ol>


<blockquote><ol>
<li>title one</li>
<li><p>sub one</p></li>
<li><p> sub sub one</p></li>
<li><p> sub sub two</p></li>
<li>sub two</li>
<li>title two</li>
<li>title three</li>
<li>sub three one</li>
<li>sub three two</li>
</ol>
</blockquote>

<ol>
<li>demo.txt所在路径下运行"pandoc -o demo.html demo.txt"，会在当前目录下生成demo.html文件，效果如下：</li>
</ol>


<p> title one
 sub one
 sub sub one sub sub two sub two title two title three
 sub three one sub three two</p>

<p>采用pandoc语法写多级列表的格式是：第2级列表行首缩进4格，以"i. &ldquo;开头，第3级多加4个空格，以"a. "开头。</p>

<h2>Multi-level bullet list</h2>

<p>demo.txt内容如下：</p>

<ul>
<li>this is list line 1</li>
<li>this is sub list 1</li>
<li> this is sub sub list 1</li>
<li>this is sub list 2</li>
<li>this is list 2</li>
</ul>


<p>输出结果：</p>

<p> this is list line 1
 this is sub list 1
 this is sub sub list 1 this is sub list 2 this is list 2</p>

<p>注意：</p>

<ul>
<li>GBK编码的文件中如果有中文，pandoc会报错退出，如果一定要显示中文，需要保存为UTF-8格式。</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/07/111330/">比较不同文件夹下源代码的内容差异</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-07T11:13:30+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>11:13 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>场景</h1>

<p>现有两个源代码文件夹："d:\workspace\GoduServer3.0\src"和"d:\workspace\Godu_Server_2.3\src"，分别包含多级子目录，需要比较所有子目录中文件内容的差异（不能只比较文件的大小和修改时间）。</p>

<h1>Linux</h1>

<p>diff -rq, see &ldquo; Diff Notes &rdquo;;</p>

<h1>解决方案</h1>

<h2>Windows</h2>

<h3>TotalCmd</h3>

<ol>
<li><p>分别打开要比较的两个文件夹，[Commands -> Synchronize dirs] (Shift+F12);</p></li>
<li><p>取消"Asymmetric"，选中"subdirs", &ldquo;by content&rdquo; and &ldquo;ignore date"，点击"compare&rdquo;;</p></li>
<li><p>TotalCmd会列出所有不同的文件，要比较不同的文件，选中然后右键 -> Compare Left &amp; Right (Ctrl+F3);</p></li>
<li><p>根据文件内容确定同步的方向，点击"Synchronize"；</p></li>
</ol>


<h3>UltraCompare</h3>

<p>用<a href="http://www.ultraedit.com/products/ultracompare.html">UltraCompare Pro</a>的绿色版，解压后在uc.exe所在目录下运行：
uc -d -r -ne -dmf -B d:\workspace\GoduServer3.0\src d:\workspace\Godu_Server_2.3\src</p>

<p>指令格式：uc [options] dir1 dir2</p>

<p>选项含义：</p>

<p>-d：文件夹比较模式（而不是文本比较）；</p>

<p>-r：包含所有子文件夹；</p>

<p>-ne：只显示不同的文件；</p>

<p>-dmf：文本比较模式（逐字节比较，另外还有：-dmb：基本比较模式，只比较文件大小和日期；-dms：智能比较模式）</p>

<p>-B：文本比较时忽略空行；</p>

<p>详见UltraCompare帮助文档“命令行选项”一节。</p>

<p>UC支持界面操作，上面各个选项在工具栏上都有图标，选中后点击两个路径输入框中间的绿色三角按钮就开始比较了（Ctrl+F5），比较完之后可以用工具栏上的各种合并按钮进行合并操作。</p>

<h3>备选方案</h3>

<ul>
<li>免费软件FreeFileSync也具备比较文件内容和子文件夹循环比较的能力，但只能找到不用的文件，不能对选定的文件进行文本比较。</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/06/092553/">关于Algorithm in Nutshell源代码</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-06T09:25:53+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>9:25 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>获取源码包</h1>

<p>&ldquo;Algorithm in Nutshell"的源码包<a href="http://examples.oreilly.com/9780596516246/Releases/ADK-1.0.zip">ADK-1.0.zip</a>在这本书<a href="http://shop.oreilly.com/product/9780596516246.do">主页</a>上"Download Example Code"页面的Releases目录中。</p>

<h1>构建源码</h1>

<p>构建ADK需要JDK6或者7，且源代码的文件编码为UTF-8，在Windows下编译失败，在47上写了一个脚本：</p>

<p> #!/bin/sh
 JAVA_HOME=/opt/jdk1.6.0_35
 PATH=$JAVA_HOME/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin
 export PATH
 ./no_ant.sh</p>

<p>然后运行这个脚本，编译出dist目录及下面的两个jar文件：ADK-1.0-ExamplesAndFigures.jar和ADK-1.0.jar。</p>

<h1>验证构建结果</h1>

<p>将dist目录拷贝回PC机上，运行“java -cp dist/ADK-1.0-ExamplesAndFigures.jar algs.chapter3.table1.Main”（参见源码包根目录下的Readme文件）</p>

<p>得到结果，证明编译成功。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/04/192133/">Notes About `Seven Languages in Seven Weeks`</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-04T19:21:33+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>7:21 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>day 1</h1>

<ul>
<li>Print the string “Hello, world.”
puts &ldquo;Hello, world.&rdquo;</li>
<li>For the string “Hello, Ruby,” find the index of the word “Ruby.”
&ldquo;Hello, Ruby.&rdquo;.index(&ldquo;Ruby&rdquo;)</li>
<li>Print your name ten times.
10.times{puts &ldquo;Li Chao&rdquo;}</li>
<li>Print the string “This is sentence number 1,” where the number 1 changes from 1 to 10.
(0..10).each do |i|
puts &ldquo;This is sentence number #{i}&rdquo;
end
or:
for i in 0..10
puts &ldquo;This is sentence number #{i}&rdquo;
end</li>
<li>Run a Ruby program from a file.
save ex.rb with:
for i in 0..10
puts &ldquo;This is sentence number #{i}&rdquo;
end
then run: jruby ex.rb</li>
<li>Bonus problem: If you’re feeling the need for a little more, write a program that picks a random number. Let a player guess the number, telling the player whether the guess is too low or too high.(Hint: rand(10) will generate a random number from 0 to 9, and gets will read a string from the keyboard that you can translate to an integer.)
target = rand(10)
puts &ldquo;Please input a number between 0~10:&rdquo;
i = gets.chomp.to_i
while i != target
if i&lt;target
 puts &ldquo;lower&rdquo;
else puts &ldquo;higher&rdquo;
end
i = gets.chomp.to_i
end
puts &ldquo;You got it: #{i}&rdquo;</li>
</ul>


<h1>day 2</h1>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/04/112943/">关于Java的国际化</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-04T11:29:43+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>11:29 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>见Cay S. Horstmann: &ldquo;Core Java: Advanced Features&rdquo;, chapter 5.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/04/103807/">About Nested Class, Inner Class and Anonymous Class</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-04T10:38:07+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>10:38 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>Concept about nested class: <a href="http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html">Nested Classes</a></p></li>
<li><p><a href="http://docstore.mik.ua/orelly/java-ent/jnut/ch03_12.htm">Anonymous Classes</a> explains how to construct a inner class with &ldquo;instance initializer&rdquo;.</p></li>
<li><p>See a more detailed explanation in section 13.2 &amp; 13.3 of Walter Savitch: &ldquo;Absolute Java&rdquo;.</p></li>
<li><p>&ldquo;Item 22: Favor static member classes over nonstatic&rdquo; in Joshua Bloch: &ldquo;Effective Java&rdquo;.</p></li>
<li><p>&ldquo;Inner Classes&rdquo; in section 6.6 of Jonathan Knudsen: &ldquo;Learning Java&rdquo;, 3rd Edition.</p></li>
<li><p>Book III, chapter 7 &ldquo;Using Inner Classes&rdquo; in Doug Lowe: &ldquo;Java All-In-One Desk Reference For Dummies&rdquo;, 2nd Edition.</p></li>
<li><p>Section &ldquo;Inner Classes&rdquo; of Bruce Eckel: &ldquo;Thinking in Java&rdquo; explains the relationship between inner classes and closure, callbacks.</p></li>
<li><p>Chapter 6 &ldquo;Interfaces and Inner Classses&rdquo; in Cay S. Horstmann: &ldquo;Core Java: Fundamentals&rdquo;.</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/04/081907/">Ruby笔记</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-12-04T08:19:07+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>8:19 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>Windows平台上的Ruby编译器首推<a href="http://rubyinstaller.org/">RubyInstaller</a>的7z绿色版，其次是exe安装包，最后还可以选择<a href="http://jruby.org/">JRuby</a>，需要jre才能运行，Windows上有zip和exe安装包两种方式供选择，Linux上有gz包。RubyInstaller的运行速度远高于JRuby。</p></li>
<li><p>跳出嵌套层次</p></li>
</ul>


<p>030后面的数字是嵌套层次，用end可以跳到上一级。
irb(main):030:2> end</p>

<p>irb(main):030:1></p>

<ul>
<li>Ruby语言模型(引自"3.2 The Ruby Universe" of Brian Marick: &ldquo;Everyday Scripting with Ruby&rdquo;)：</li>
</ul>


<p>When you run the inventory.rb script, you create a little Ruby universe. That universe, in essence, contains only three kinds of things: nouns, verbs, and names. The nouns are usually called objects. They are the “things” in the Ruby universe. Objects just sit there until they’re told to do something. That’s where the verbs come in. All the verbs in the Ruby universe are imperative: verbs like “sit!” and “stay!” and “roll over!” In Ruby, these verbs are called messages, and telling an object to do some-thing is called sending a message.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/19/145129/">Windows Server FTP工具</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-19T14:51:29+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>2:51 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>试用了<a href="http://www.freesshd.com/">freeFTPd</a>和<a href="http://www.coreftp.com/server/">mini sftp server on CoreFTP</a>。</p>

<p>freeFTPd的ftp server启动并上传/下载成功，sftp server能启动，也能接收用户登录，但无法上传/下载文件。</p>

<p>mini sftp server是一个绿色文件，只要在启动界面上配好用户名、密码、端口即可，非常方便，只能配一个用户，但这个用户可以与server建立多个连接，用ftp客户端上传/下载正常，但用Ant的scp指令上传文件时，在连接server时僵死。</p>

<p>总结：freeFTPd需要安装，还会生成一个服务，对系统影响比较大，如果只是用sftp做部署时上传的话，mini sftp够用了。</p>

<p>另：freeSSHd启动后用户无法登录，Windows对SSH以及SFTP的支持不好，需要测SSH服务的时候最好在Linux server上测。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/13/104147/">VirtualBox使用笔记</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-13T10:41:47+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>10:41 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>版本：VirtualBox 4.2.4；</p>

<ul>
<li><p>VirtualBox是开源软件（GPL），其安装文件只有90多MB，比vmware小多了；</p></li>
<li><p>支持的操作系统很全面，Windows, Linux, Max OS X, Solaris, BSD, IBM OS/2, DOS &hellip;</p></li>
<li><p>需要在全局设置中预先指定好虚拟电脑的位置，而不是像vmware那样安装虚拟机的时候再设置；</p></li>
<li><p>加载虚拟光驱盘片（如iso文件）和USB设备是虚拟机窗口中设定的；</p></li>
<li><p>中文界面的翻译质量令人满意；</p></li>
<li><p>主程序退出后不会驻留内存（如vmware-tray.exe），更轻量级；</p></li>
<li><p>初次使用整体感觉很好，容易上手；</p></li>
</ul>


<h1>Shared Folders</h1>

<p>首先要在虚拟机的Settings->Shared folders中添加一个shared folder，然后启动虚拟机，安装Guest Additions（Devices -> Install Guest Additions）</p>

<ul>
<li><p>WinXP虚拟机在网络邻居里可以看到Virtualbox shared folders；</p></li>
<li><p>Ubuntu虚拟机在/media下可以看到sf_xxx目录，这就是shared folder了，用root用户可以访问此目录，从中拷贝文件；</p></li>
</ul>


<h1>快捷键的使用方法</h1>

<p>VirtualBox管理窗口和各虚拟机是不同的窗体（而不像vmware那样是不同的标签），启动虚拟机后管理界面就可以关闭了。对虚拟机的操作可以使用快捷键，例如关闭虚拟机的快捷键是Ctrl+H（必须是右边的Ctrl键，因为这个快捷键实际上是Host（也叫“热键”）+H，而VirtualBox默认的Host键是右边的Ctrl键，可以在管理窗体主菜单【管理->全局设定->热键】中修改），在管理窗体主菜单【控制->退出->正常关机】后面可以看到快捷键定义，见下图。这样关闭虚拟机有3种方法，一种是在虚拟机里执行关机指令，另一种是在管理窗体上执行上面的菜单项，最后一种方法是在虚拟机窗体上右Ctrl+H，最后这种方法适用于管理界面已经关闭的情况下控制虚拟机。</p>

<h1>命令行用法</h1>

<p>假设通过图形界面建好了一个虚拟机叫uServer1204。</p>

<h2>完全命令行</h2>

<p>适用于启动只有命令行界面的虚拟机，例如Ubuntu Server，用VBoxHeadless.exe的startvm命令（vrde是远程桌面，因为没有图形界面，也就不需要启动远程桌面了）：</p>

<pre><code>E:\MyDoc\ahkFiles&gt;"C:\Program Files\Oracle\VirtualBox\VBoxHeadless.exe" --startvm uServer1204 --vrde off 
Oracle VM VirtualBox Headless Interface 4.2.8 
(C) 2008-2013 Oracle Corporation 
All rights reserved.
</code></pre>

<p>然后就可以用"ssh user@ip"登录这个虚拟机了，如果知道虚拟机的hostname，可以用"ssh user@hostname"连接，这样避免了连接前查IP地址的麻烦。需要关闭虚拟机时，新开一个命令行界面运行VBoxManage controlvm <vm_name> poweroff命令：</p>

<pre><code>E:\MyDoc\ahkFiles&gt;"C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" controlvm uServer1204 poweroff
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
</code></pre>

<p>这种方法启动Ubuntu Server大概消耗150~200MB左右内存，启动速度比较快，不占用单独的窗口（ConEmu的一个标签页），是启动Server的最佳方法，缺点是看不到启动过程，只能根据宿主机的内存和CPU消耗推断虚拟机是否启动，如果启动后一直连不上，可以用图形界面（或者下面介绍的方法）启动虚拟机，查看错误信息。</p>

<h2>命令行启动图形界面</h2>

<p>适用于启动有图形界面的虚拟机。用VBoxManage.exe的list vms子命令查看已有的虚拟机：</p>

<pre><code>E:\MyDoc\ahkFiles&gt;"C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" list vms
"Ubuntu11.10" {bfae3b28-7063-4c14-ae3f-47a46eb894be} 
"uServer1204" {faca3e8a-d27e-4ca4-bb92-3b03d07a753c} 
"GameXP" {609dfe66-6554-40dc-a2af-7526962bc6bb}
</code></pre>

<p>然后用startvm和controlvm <vm_name> poweroff两个子命令来启动和关闭虚拟机：</p>

<pre><code>E:\MyDoc\ahkFiles&gt;"C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" startvm uServer1204
Waiting for VM "uServer1204" to power on... 
VM "uServer1204" has been successfully started. 
E:\MyDoc\ahkFiles&gt;"C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" controlvm uServer1204 poweroff
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
</code></pre>

<p>试验发现启动和关闭速度高于图形界面，另外命令行操作可以实现一定程度的自动化（例如通过autohotkey脚本用快捷键启动和关闭虚拟机）。</p>

<p>用VBoxManage.exe &ndash;help（或者google &ldquo;virtualbox VBoxManage"，或者查看随机文档VirtualBox-4.2.4-UserManual.pdf第8章）查看详细使用方法。</p>

<h1>Clone and Portability</h1>

<p>// 2014-7-2更新</p>

<p>VirtualBox的Clone分为full clone和linked clone两种方式，前者的优点是源的完全拷贝，可以独立地运行，由于它的虚拟磁盘包括VM的所有信息，比较费磁盘空间，后者正好相反，它的虚拟盘只保存相对于源盘的增量部分，所以节省空间，但必须与源处于同一主机上。</p>

<p>VirtualBox目前支持的导入/导出格式是ova文件，结合这两点，在Linux上使用Windows虚拟机的方法是：</p>

<ol>
<li><p>创建一个干净的Windows虚拟机，将其导出为ova格式文件保存；</p></li>
<li><p>在需要使用Windows的主机上，安装VirtualBox和对应版本的Extension Pack（否则虚拟机无法使用USB设备），导入这个ova文件，形成一个基准系统，例如名为Win7Base；</p></li>
<li><p>为这个基准系统做Linked Clone：在Win7Base上右键->Clone，选择Linked clone；</p></li>
</ol>


<p>注意不要在Win7Base上安装软件，它只作基准系统，clone生成的VM才是工作VM，可以为Win7Base制作多个clone，比如一个主要做文档处理，就只安装Office，另一个做C#开发，则安装Visual Studio，当软件安装好后别忘了制作一个snapshot，这样当软件出问题时无需重装，只要简单地"Restore Snapshot"就OK了，然后导出为ova文件保存；</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/71">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/69">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/08/05/125922/">Meteor实施案例</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/02/113417/">Meteor Development Collaboration</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/31/160627/">Chinese Characters Can't Be Displayed Correctly in Git Log</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/23/121622/">Development Collaboration With Pull Request</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/22/082040/">Running Meteor and Node App on Ubuntu 14.04 VPS</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
