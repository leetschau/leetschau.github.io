
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="使用源代码版本的ansible 按照Running From Source,
首先安装依赖包 (sudo pip install paramiko PyYAML Jinja2 httplib2 six),
clone ansible的github repo, 然后配置环境变量， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/4/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/08/125827/">Ansible Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-08T12:58:27+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:58 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>使用源代码版本的ansible</h1>

<p>按照<a href="http://docs.ansible.com/ansible/intro_installation.html#running-from-source">Running From Source</a>,
首先安装依赖包 (<code>sudo pip install paramiko PyYAML Jinja2 httplib2 six</code>),
clone ansible的github repo, 然后配置环境变量，就可以使用ansible的各个版本了。</p>

<pre><code>git clone git://github.com/ansible/ansible.git --recursive $HOME/apps
</code></pre>

<p>需要使用ansible时，运行：</p>

<pre><code>source $HOME/apps/ansible/hacking/env-setup
</code></pre>

<p>默认是devel分支，如果要切换到稳定版分支，首先列出所有分支：<code>git branch -ra</code>，
然后切换到此分支上：</p>

<pre><code>cd $HOME/apps/ansible
git checkout origin/stable-2.0.1
source $HOME/apps/ansible/hacking/env-setup
</code></pre>

<p>更新代码库：</p>

<pre><code>cd $HOME/apps/ansible
git pull --rebase
git submodule update --init --recursive
</code></pre>

<h1>lookup ini plugin</h1>

<p>通过pip安装的ansible是1.9.4版本，这一版没有lookup ini plugin.
在<a href="http://docs.ansible.com/ansible/playbooks_lookups.html#the-ini-file-lookup">The INI File Lookup</a>
下可以看到 &ldquo;New in version 2.0.&rdquo;.</p>

<p>运行下面的task时，</p>

<pre><code>- debug: msg="User in integration is "
</code></pre>

<p>会报错：</p>

<blockquote><p>lookup plugin (ini) not found</p></blockquote>

<p>用pip安装后，所有的lookup plugin的安装目录是
/usr/local/lib/python2.7/dist-packages/ansible/runner/lookup_plugins
下面没有ini.py.</p>

<p>解决方法见上节使用源代码版本的ansible.</p>

<p>有了ini lookup plugin, 可以在ansible的roles/<role-name>/tasks/main.yml中
引用ansible变量和外部ini文件：</p>

<pre><code>- name: download codes to laptop
  local_action: &gt;
    command
</code></pre>

<p>相关的文件：</p>

<pre><code>cat $ANSIBLE_PRJ_HOME/roles/deploy/vars/main.yml 
repo_base: "~/temp"
timestamp: ""
repo_name: "-"
local_repo: "/"
target_branch: "develop"
ext_path: "/"
nodejs_bin_path: ":/opt/node-v0.10.40-linux-x64/bin"
app_settings: "~/docs/website/v3/settings.json"
env_settings: "~/docs/website/v3/serverEnv.ini"

cat ~/docs/website/v3/serverEnv.ini
[common]
PORT=3000

[p21.newfairs-inc.com]
MONGO_URL=mongodb://dba:dba@192.168.100.3:27017/production
ROOT_URL=http://www.newfairs.net
GIT_REPO=git clone ssh://git@git.newfairs-inc.com/diffusion/NEWFAIRS/newfairs.git

[p22.newfairs-inc.com]
MONGO_URL=mongodb://dba:dba@192.168.100.3:27017/production
ROOT_URL=http://www.newfairs.net
GIT_REPO=git clone ssh://git@git.newfairs-inc.com/diffusion/NEWFAIRS/newfairs.git

[beta-app.newfairs-inc.com]
MONGO_URL=mongodb://dba:dba@192.168.100.3:27017/production
ROOT_URL=http://beta.newfairs.com
GIT_REPO=git clone ssh://git@git.newfairs-inc.com/diffusion/NEWFAIRS/newfairs.git

[console.newfairs-inc.com]
MONGO_URL=mongodb://dba:dba@192.168.100.3:27017/console
ROOT_URL=http://console.newfairs-inc.com
GIT_REPO=git clone ssh://git@git.newfairs-inc.com/diffusion/CONSOLE/newfairs-console.git
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/30/162805/">Wordpress中文文章详情页无法打开问题</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-30T16:28:05+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>4:28 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Wordpress Dashboard -> Settings -> Permalinks -> Common Settings:
Plain（或者Numeric）。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/29/134651/">青云的负载均衡器</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-29T13:46:51+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>1:46 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>青云把负载均衡器抽象成了三个概念：一是负载均衡器本身；二是监听器，三是后端主机。
监听器代表负载均衡器对外提供的协议类型和端口；
后端主机页面上的"端口"指的是后端主机上服务进程监听的端口。</p>

<p>只要用户创建负载均衡器、监听器、主机，就可以在界面里头完成负载均衡器的所有操作。</p>

<p>一条转发策略，代表一条从域名到主机和端口的关联规则，所以如果是同一个服务有多个域名，
可以配置在同一个转发策略里。
如果是两个不同的服务，即使是同一IP不同端口，也要配置在不同的转发策略里。</p>

<h1>示例</h1>

<h2>添加第一个服务</h2>

<p>需要将内网中的一台服务器作为beta服务器，
外部用户可以通过域名 beta.nufair.com 从公网访问，实现方法：</p>

<ol>
<li><p>在青云控制台 [计算与网络 -> 公网IP]中购买IP地址 nufairIP: 123.234.34.5</p></li>
<li><p>在域名 (nufair.com) DNS配置中增加一条A记录：beta -> 123.234.34.5</p></li>
<li><p>新建 [路由器] nufairRouter, 绑定nufairIP;</p></li>
<li><p>新建 [私有网络] nufairNet, 绑定nufairRouter;</p></li>
<li><p>新建 [主机] beta-app.nufair.com, IP: 192.168.100.121, 加入 nufairNet;</p></li>
<li><p>在 beta-app.nufair.com 中部署应用，服务监听端口 3000;</p></li>
<li><p>新建 [负载均衡器] nufairLB, IP：192.168.100.4, 绑定nufairNet;</p></li>
<li><p>[nufairRouter -> 端口转发]中添加规则 http-route: tcp 80 -> 192.168.100.4 80</p></li>
<li><p>[nufairRouter -> 基本属性]中点击[防火墙]，在其中增加规则：允许80端口下行；</p></li>
<li><p>[nufairLB -> 转发策略] 中新建转发策略:</p>

<blockquote><p>名称：app-beta
匹配方式：匹配任意规则</p></blockquote>

及其规则：

<blockquote><p>规则类型: 按域名转发
规则内容: beta.nufair.com</p></blockquote></li>
<li><p>nufairLB 中新建一个[监听器] http-listener, 为其[添加后端]，</p>

<blockquote><p>名称：beta
网络：受管私有网络
主机：192.168.100.121
端口：3000</p></blockquote>

<p>创建完成后，在[转发策略]一栏中点击[绑定]，选择[app-beta].</p></li>
</ol>


<h2>添加第二个服务</h2>

<p>需要将内网中另一台服务器作为生产服务器，通过域名nufair.com和www.nufair.com访问。</p>

<ol>
<li><p>青云控制台中购买一台主机，IP: 192.168.100.21, 在上面部署生产应用，服务监听端口3000;</p></li>
<li><p>在域名 (nufair.com) DNS配置中增加两条A记录：
@ -> 123.234.34.5
www -> 123.234.34.5</p></li>
<li><p>[nufairLB -> 转发策略] 中新建转发策略:</p>

<blockquote><p>名称：app-production
匹配方式：匹配任意规则</p></blockquote>

及其规则：

<blockquote><p>规则类型: 按域名转发
规则内容: nufair.com www.nufair.com</p></blockquote></li>
<li><p><a href="">nufairLB -> http-listener -> 添加后端</a>:</p>

<blockquote><p>名称：prod
网络：受管私有网络
主机：192.168.100.21
端口：3000</p></blockquote>

<p>创建完成后，在[转发策略]一栏中点击[绑定]，选择[app-production].</p></li>
</ol>


<p>说明：</p>

<p>转发策略的规则里，如果是按域名转发，注意一级域名，如nufair.com，
它实际上是<code>*.nufair.com</code>，当监听器的某个后端绑定了这样的规则后，
它后面的后端再绑定这个一级域名下的二级域名将无效，
例如将test.nufair.com指向100.21服务器的4500端口，</p>

<p>[nufairLB -> 转发策略] 中新建转发策略:</p>

<blockquote><p>名称：app-test
匹配方式：匹配任意规则</p></blockquote>

<p>  及其规则：</p>

<blockquote><p>规则类型: 按域名转发
规则内容: test.nufair.com</p>

<p>名称：test
网络：受管私有网络
主机：192.168.100.21
端口：4500</p></blockquote>

<p>  创建完成后，在[转发策略]一栏中点击[绑定]，选择[app-test].</p>

<p>应用修改后，test.nufair.com仍然指向3000端口上的服务，
原因是它作为nufair.com的二级域名，被app-production中的一级域名覆盖了，
解决方法是，从app-production中去掉"nufair.com".</p>

<p>修改负载均衡器IP地址后需要注意：
要相应修改路由器中端口转发中目标（也就是负载均衡器）的IP地址。</p>

<p>参考：</p>

<p><a href="http://network.51cto.com/art/201504/472491.htm">青云QingCloud：云上最强负载均衡服务</a></p>

<p><a href="https://docs.qingcloud.com/guide/loadbalancer.html">负载均衡器指南</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/27/185843/">Move Some Commit From One Repo to Another</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-27T18:58:43+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>6:58 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We need move all commit between origin/develop to develop in an old repo
to a new repo.</p>

<p>Export all commits in old repo:</p>

<pre><code>cd /path/to/old-repo
git format-patch origin/develop..develop
</code></pre>

<p>Now you have many .patch files in old repo.
Each patch file represents a commit between origin/develop and develop.</p>

<p>Apply these patches in new repo:</p>

<pre><code>cd /path/to/new-repo
git checkout develop
git am /path/to/old-repo/*.patch
</code></pre>

<p>Ref:</p>

<p><a href="http://stackoverflow.com/questions/5062389/getting-started-with-git-am">Getting started with git-am</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/25/102101/">WebSocket Error 400 in Meteor App</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-25T10:21:01+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:21 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I deploy a Meteor app, and proxy it with nginx.
When connect to the app server, there&rsquo;s a websocket error:</p>

<p>WebSocket connection to &lsquo;ws://prod-app-192-168-100-21.newfairs-inc.com/sockjs/311/ud_4e5xf/websocket&rsquo; failed:
Error during WebSocket handshake: Unexpected response code: 400</p>

<p>Solution:</p>

<pre><code>cat /etc/nginx/sites-enabled/newfairs
server {
  server_name prod-app-192-168-100-21.newfairs-inc.com;
  location / {
    proxy_pass http://localhost:3000/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
  }
}
</code></pre>

<p>Ref:</p>

<p><a href="http://stackoverflow.com/questions/17014969/meteor-websocket-handshake-error-400-with-nginx">Meteor WebSocket handshake error 400 with nginx</a></p>

<p><a href="http://nginx.org/en/docs/http/websocket.html">WebSocket proxying</a></p>

<p><a href="http://stackoverflow.com/questions/30171179/meteor-websocket-connection-to-ws-websocket-failed-error-during-websock">http://stackoverflow.com/questions/30171179/meteor-websocket-connection-to-ws-websocket-failed-error-during-websock</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/23/030734/">Install Wordpress on Ubuntu 14.04</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-23T03:07:34+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>3:07 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>MySQL database is installed on the host when installing
Phabricator. We use this database as backend of our new
Wordpress service.</p>

<pre><code>$ sudo useradd -m -s /bin/bash wordpress
$ sudo su - wordpress
$ mysql -u root -p'NewFairs0910'
&gt; CREATE DATABASE wordpress;
&gt; CREATE USER nfadmin@localhost IDENTIFIED BY 'nfMysQL2015';
&gt; GRANT ALL PRIVILEGES ON wordpress.* TO nfadmin@localhost;
&gt; FLUSH PRIVILEGES;
&gt; exit
$ wget http://wordpress.org/latest.tar.gz
$ tar zxf latest.tar.gz
$ sudo apt-get update
$ sudo apt-get install php5-gd libssh2-php
$ cd ~/wordpress
$ cp wp-config-sample.php wp-config.php
</code></pre>

<p>Modify wp-config.php according to above values for mysql:</p>

<pre><code>define('DB_NAME', 'wordpress');
define('DB_USER', 'nfadmin');
define('DB_PASSWORD', 'nfMysQL2015');
define('DB_HOST', 'localhost');
</code></pre>

<p>Create file /etc/apache2/sites-available/wordpress.conf:</p>

<pre><code>&lt;VirtualHost *:80&gt;
  ServerName cms.newfairs-inc.com
  DocumentRoot /home/wordpress/wordpress
&lt;/VirtualHost&gt;

&lt;Directory "/home/wordpress/wordpress"&gt;
  Require all granted
&lt;/Directory&gt;
</code></pre>

<p>Enable it:</p>

<pre><code>cd /etc/apache2/sites-enabled
ln -s /etc/apache2/sites-available/wordpress.conf wordpress.conf
</code></pre>

<p>Then restart apache server: <code>sudo service apache2 restart</code>.</p>

<p>Open &ldquo;cms.newfairs-inc.com&rdquo; in browser, start wordpress installation.</p>

<pre><code>website title: Newfairs CMS
username: nfcms
pwd: nEwfAIrsAt6102
</code></pre>

<p>Note: A &ldquo;Forbidden. You don&rsquo;t have permission to access /&rdquo; error appears
without &ldquo;Require all granted&rdquo;.</p>

<p>After installation, install wordpress plugin &ldquo;WordPress REST API (Version 2)&rdquo;
with <a href="http://wp-cli.org/">wp-cli.phar</a>:</p>

<pre><code>curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
chmod 755 wp-cli.phar
mv wp-cli.phar /usr/local/bin/wp
wp --info
sudo su - wordpress
cd wordpress
wp plugin list
wp plugin search rest
wp plugin install rest-api
</code></pre>

<p>Note:</p>

<p>We can&rsquo;t install plugin &ldquo;WordPress REST API (Version 2)&rdquo; through
&ldquo;Plugin -> Add New&rdquo; in Wordpress web page.</p>

<p>It need ssh/ftp username and password. And the ssh port must be 22.
While our ssh port is 222.</p>

<p>Ref:</p>

<p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-on-ubuntu-14-04">https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-on-ubuntu-14-04</a></p>

<h1>Reset Wordpress Admin password</h1>

<pre><code>su - wordpress
cd $HOME/wordpress    # which is $WP_HOME
wp user list          # where you can find the administrator's name is nfcms
wp user update nfcms --user_pass=nEwfAIrsAt6102
</code></pre>

<p>Ref:</p>

<p><a href="http://codex.wordpress.org/Resetting_Your_Password">Resetting Your Password</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/10/165329/">A Lightweight Message Queue</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-10T16:53:29+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>4:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>RSMQ</h1>

<p><a href="http://smrchy.github.io/rsmq/">RSMQ</a> is a lightweight message queue
based on Redis.</p>

<h2>Setup Redis Server on Docker</h2>

<p>Start Redis server on docker:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>docker run --name myredis -d redis
</span><span class='line'>                  -------
</span><span class='line'>                     A
</span></code></pre></td></tr></table></div></figure>


<p>Connect to the server with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>docker run -it --link myredis:redis --rm redis bash -c <span class="s1">&#39;redis-cli -h redis&#39;</span>
</span><span class='line'>                      ------- -----                                  -----
</span><span class='line'>                         A      B                                      B
</span></code></pre></td></tr></table></div></figure>


<p>or the full version:
<code>docker run -it --link myredis:redis --rm redis bash -c 'exec redis-cli -h "$REDIS_PORT_6379_TCP_ADDR" -p "$REDIS_PORT_6379_TCP_PORT"'</code>.</p>

<p>Now in redis console, use <code>info</code> to get the server&rsquo;s version;</p>

<p><code>keys *</code> to list all keys;
<code>set mykey "hello"</code> to add a key/value pair.
<code>get mykey</code> to fetch the key&rsquo;s value.</p>

<p>Note:</p>

<ol>
<li>Names labled with &ldquo;A&rdquo; is the container&rsquo;s name of Redis server.
Names labled with &ldquo;B&rdquo; is the name alias of Redis server container used
by Redis client container.</li>
</ol>


<h2>Setup Redis on Metal Host</h2>

<p>Install Redis on Ubuntu 14.04 with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>apt-get install -y python-software-properties <span class="c"># optional</span>
</span><span class='line'>add-apt-repository -y ppa:rwky/redis
</span><span class='line'>apt-get update
</span><span class='line'>apt-get install -y redis-server
</span></code></pre></td></tr></table></div></figure>


<p>Install rsmq: in project root folder, run<code>npm install rsmq</code>;</p>

<p>Install rsmq-cli: <code>npm install -g rsmq-cli</code>;</p>

<pre><code>rsmq config ls
rsmq create -q payment            // create a new queue named "payment"
rsmq ls                           // list all queues
rsmq stats -q payment             // print stats of queue "payment"
rsmq send "pay $1000" -q payment  // send a message to "payment"
rsmq receive -q payment           // receive a message from "payment"
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/23/005959/">Linux上的API文档搜索工具</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-23T00:59:59+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>12:59 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Devdocs</h1>

<p>Mac上的Dash是一款很方便的API文档搜索工具，经过一番查找，
发现了<a href="https://github.com/Thibaut/devdocs">devdocs</a>这个很好的替代品。</p>

<p>devdocs是一款浏览器插件，可以安装在Chrome或者Firefox上，
所以不论那种操作系统，只要能安装这两款浏览器就可以使用它。</p>

<p>支持地址栏搜索：在地址栏输入"dev"，出现"devdocs.io"自动补全时，按Tab键，
再输入"meteor createuser"并回车，就可以直接跳转到Meteor的
Accounts.createUser()方法上。</p>

<p>支持离线下载和自动更新，有夜间模式。</p>

<p>常用的快捷键包括：</p>

<ul>
<li><p>ESC: 重新搜索；</p></li>
<li><p>Tab: 二次筛选，例如输入javascript<Tab>，再输入map，则只在JavaScript中寻找map.</p></li>
<li><p>Enter: 执行搜索；</p></li>
</ul>


<p>完整的快捷键和说明文档见<a href="http://devdocs.io/help">Help</a>.</p>

<h1>Zeal</h1>

<p>2015.11.20发布的Zeal v0.2.1在Ubuntu 14.04 Unity下运行正常，
但下载一些docset后无法启动，原因不明。</p>

<p>增加新的Docsets的方法：File -> Options -> Docsets.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/22/225751/">Use Postman as the RESTful Tools</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-22T22:57:51+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>10:57 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Find <a href="https://chrome.google.com/webstore/search/postman">Postman</a> in chrome web store.
Install it.
Open &ldquo;chrome://apps&rdquo; in chrome, click Postman&rsquo;s icon.</p>

<p>That&rsquo;s it.</p>

<p>To send a post with Postman,</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/22/212852/">MongoDB Client</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-22T21:28:52+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>9:28 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>MongoChef</h1>

<p><a href="http://3t.io/mongochef/">MongoChef</a> is a cross platform MongoDB GUI client.
Its free version only for non-commercial use.
It&rsquo;s the best choice I found so far.</p>

<h1>RockMongo</h1>

<h2>Install and Setup</h2>

<p><a href="http://rockmongo.com/">RockMongo</a> is a PHP MongoDB client.</p>

<p>It can&rsquo;t update complicated (nested) data structure, useless.</p>

<p>Install bitnami Nginx Stack;</p>

<p>Run <code>$STACK_HOME/php/bin/pecl install mongo</code>;</p>

<p>Add <code>extension=mongo.so</code> into <code>$STACK_HOME/php/etc/php.ini</code>;</p>

<p>Run <code>mkdir $STACK_HOME/apps/rockmongo</code>;</p>

<p>Download rockmongo-1.1.7.zip, extract to <code>$STACK_HOME/apps/rockmongo</code>;
and <code>mv rockmongo-1.1.7 htdocs</code>;</p>

<p>In folder <code>$STACK_HOME/apps</code>, run <code>cp -r demo/conf rockmongo/</code>;</p>

<p>In folder <code>$STACK_HOME/apps</code>, replace all <code>demo</code> in <code>rockmongo/conf/nginx-prefix.conf</code>
to <code>rockmongo</code>;</p>

<p>Add <code>include "/home/leo/apps/nginxstack-1.9.7-0/apps/rockmongo/conf/nginx-prefix.conf";</code>
into <code>$STACK_HOME/nginx/conf/bitnami/bitnami-apps-prefix.conf</code>;</p>

<p>Modify mongodb connection parameters in <code>$STACK_HOME/apps/rockmongo/htdocs/config.php</code>:
modify &ldquo;mongo_name&rdquo;, &ldquo;mongo_host&rdquo; and &ldquo;mongo_port&rdquo; as your target value,
modify &ldquo;mongo_auth&rdquo; and &ldquo;ui_hide_system_collections&rdquo; to &ldquo;true&rdquo;.</p>

<p>Start nginx server: <code>$STACK_HOME/ctlscript.sh start</code>;</p>

<p>Open &ldquo;localhost:8080/rockmongo&rdquo; in your browser, login with your mongodb auth params.</p>

<p>You can add a new mongodb with codes below in apps/rockmongo/htdocs/config.php:</p>

<pre><code>$MONGO["servers"][$i]["mongo_name"] = "AliDB";
$MONGO["servers"][$i]["mongo_host"] = "123.57.188.18";
$MONGO["servers"][$i]["mongo_port"] = "15515";
$MONGO["servers"][$i]["mongo_auth"] = true;
$MONGO["servers"][$i]["ui_hide_system_collections"] = true;
$i ++;
</code></pre>

<p>And validate with <code>./ctlscript.sh restart nginx</code>.</p>

<p>Note:</p>

<ol>
<li><p>The nginx listening port (here is 8080) is defined in
<code>$STACK_HOME/nginx/conf/bitnami/bitnami.conf</code>;</p></li>
<li><p>If you logged in with a previous user in browser, click &ldquo;logout&rdquo; button
in upper-right corner to logout. Specify target username, passowrd and database
in login page.</p></li>
</ol>


<h2>Usage</h2>

<p>You have to write regex query in this way: <code>{ "chnName": { "$regex": "98" } }</code>,
and it didn&rsquo;t accept this form: <code>{ "chnName": /98/ }</code>.</p>

<p>Specify which fields will be shown in the results at the &ldquo;Fields&rdquo; dropdown list
below the query box.</p>

<h1>UMongo</h1>

<p><a href="http://edgytech.com/umongo/">UMongo</a> can only setup 1 connection,
and if the user is not root, it will give a auth failed error.</p>

<h1>MongoVUE</h1>

<p>Only for Windows. I tested v1.6.9 on Windows 7 64bit.
It can&rsquo;t connect to mongo replica set. (Always auth failed).
When connected with a local mongodb server,
searching and &ldquo;copy as json text&rdquo; function is ok.
But crash and quit when copy a part in a document.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/5">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/3">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/04/09/204200/">Note About Rest Client</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/29/183444/">MongoDB Schema Analysis</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/21/075937/">Toggle Syntastic Mode to Speedup Vim</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/21/004603/">Persist Tmux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/17/140426/">Git Submodule的同步问题</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
