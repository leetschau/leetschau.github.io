
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Build macro for batch manipulate Excel Files Now I have to add a security mark for many many excel files. I use the following the following VBA codes &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/22/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/08/144818/">Add Security Mark for Many Excel Files</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-08T14:48:18+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:48 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Build macro for batch manipulate Excel Files</h1>

<p>Now I have to add a security mark for many many excel files. I use the following the following VBA codes to achieve this.</p>

<ol>
<li><p>Run Excel 2010, save the new blank file as &ldquo;Excel Macro-Enabled Workbook&rdquo;, named &ldquo;AddMark.xlsm&rdquo; (via [File -> Save as]);</p></li>
<li><p>Open &ldquo;Developer&rdquo; ribbon: [File -> Options -> Customize ribbon], check &ldquo;Developer&rdquo; in right panel, press &ldquo;OK&rdquo; to close the dialog, you can see &ldquo;Developer&rdquo; ribbon now;</p></li>
<li><p>In &ldquo;developer&rdquo; ribbon, click &ldquo;Visual Basic&rdquo; to open the VBA IDE (or use shortcut &ldquo;Alt-F11&rdquo;);</p></li>
<li><p>In visual basic IDE, add &ldquo;Microsoft Scripting Run-time&rdquo; and &ldquo;Microsoft Scriptlet Library&rdquo; in [Tools -> References] of main menu;</p></li>
<li><p>Add the following codes to [VBAProject -> Microsoft Excel Objects -> This Workbook]:</p>

<p> Option Explicit
 Sub InsertMark2Excels()
     Dim fso As New FileSystemObject
     Dim folder As Object
     Set folder = fso.GetFolder(ActiveWorkbook.Path)
     LoopFolder folder
     Call WriteLog(&ldquo;Creation Date: &rdquo; &amp; Now)
     Call WriteLog(&ldquo;Log over.&rdquo;)
 End Sub
 Sub LoopFolder(FF As Scripting.folder)
     Dim F As Scripting.File
     Dim SubF As Scripting.folder
     Dim fso As New FileSystemObject
     For Each F In FF.Files
         Dim fext As String
         fext = fso.GetExtensionName(F)
         If fext = &ldquo;xls&rdquo; Or fext = &ldquo;xlsx&rdquo; Then
             InsertMark F.Path
         End If
     Next F
     For Each SubF In FF.SubFolders
         LoopFolder SubF
     Next SubF
 End Sub
 Sub InsertMark(target As String)
     Workbooks.Open target
     ActiveWorkbook.Sheets(1).Activate
     ActiveWorkbook.Sheets(1).Rows(&ldquo;1:1&rdquo;).Select
     Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
     Range(&ldquo;A1&rdquo;).Select
     ActiveCell.FormulaR1C1 = &ldquo;保密&rdquo;
     ActiveWorkbook.Save
     ActiveWorkbook.Close
     Call WriteLog(&ldquo;Insert mark to &rdquo; &amp; target)
 End Sub
 Sub WriteLog(log As String)
     Open ActiveWorkbook.Path &amp; &ldquo;\insertmark.log&rdquo; For Append As #1
     Print #1, log
     Close #1
 End Sub</p></li>
<li><p>Add shortcut for macro &ldquo;InsertMark2Excels&rdquo;: in ribbon Developer -> Macro, then click &ldquo;Options&rdquo;, assign Ctrl-d to this macro;</p></li>
</ol>


<p>Now you can copy AddMark.xlsm to another host, open this file, press Ctrl-d to run the macro.</p>

<h1>Open Office Macro in LibreOffice</h1>

<ol>
<li><p>Open xlsm file with LibreOffice Calc, or simply <code>thunar filename.xlsm</code>;</p></li>
<li><p>Tools -> Macros -> Organize Macros -> LibreOffice Basic, select [AddMark.xlsm -> VBA Project -> Document Objects -> ThisWorkbook] in &ldquo;Macro from&rdquo;, then select a macro in &ldquo;Existing macros&rdquo;, then click &ldquo;Edit&rdquo; button.</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/03/185755/">Manipulate Word and Excel Files in a Folder</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-03T18:57:55+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>6:57 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ref:
<a href="http://excelexperts.com/VBA-Tips-List-Files-In-A-Folder">21. VBA Tips - List Files In A Folder</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/30/162439/">Convert Markdown Files to PDF Files on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-30T16:24:39+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:24 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want convert my resume file (markdown files) to pdf files. On Linux system, I use pandoc to convert md files to html:</p>

<pre><code># apt-get install pandoc
$ pandoc myresume.md -f markdown -t html -s -o resume.html
</code></pre>

<p>or simply &ldquo;pandoc myresume.md -s -o resume.html&rdquo;, the &ldquo;-s&rdquo; option is necessary, or Chinese characters will be massed up.</p>

<p>The personal information section (name, address, email, mobiles, etc) is left-aligned, while they should be centered. However there isn&rsquo;t &ldquo;centering&rdquo; format in markdown, so I have to add this format  manually in created html files:</p>

<pre><code>$ vi resume.html
// add "&lt;DIV ALIGN=CENTER&gt;" before the centering section
// add "&lt;/DIV&gt;" after the centering section
</code></pre>

<p>Then convert the html files to pdf, there several ways to achieve this:</p>

<h1>MS Office Word</h1>

<p>Copy contents of html file generated last step, paste it into a blank word file, centering personal information, modify margin, font (consolas is good) and other layout elements, such as adding page break before section title, etc.
Then save it as PDF format (if using Word 2007, you have to install the pdf plugin of MS Word).</p>

<h1>wkhtmltopdf</h1>

<p>The wkhtmltopdf can&rsquo;t convert hyperlinks in html to pdf files properly. So this is not a valid options.</p>

<h1>Texlive for Pandoc</h1>

<pre><code># apt-get install texlive   // this package maybe is huge, 281MB to download
# apt-get install texlive-xetex lmodern etoolbox
$ pandoc MyResume.md -o Resume.pdf --latex-engine=xelatex -V mainfont='WenQuanYi Micro Hei'
</code></pre>

<p>Get all installed fonts with <code>fc-list</code> on Linux Mint.</p>

<p>Note1: If there no Unicode characters (such as Chinese characters) in the markdown file, use &lsquo;DejaVu Sans Mono&rsquo; instead of WenQuanYi, much better than the latter.</p>

<p>Note2: <code>pandoc myresume.md -s -o test1.pdf</code> met &ldquo;Error producing PDF from TeX source.  ! Package inputenc Error&hellip;&rdquo; on Linux Mint 17, i3wm.</p>

<p>Note3: The page margin of the default pdf file is too large. Don&rsquo;t know how to set margin yet.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/30/114910/">Get Overall CPU Usage on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-30T11:49:10+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:49 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Run the following command to get the overall CPU usage from command line:</p>

<pre><code>top -bn2|grep "Cpu(s)"|sed "s/.*, *\([0-9.]*\)%* *id.*/\1/"|awk '{print 100 - $1 "%"}'|sed -n 2p
</code></pre>

<p>You can see the result is extracted from &ldquo;top&rdquo; command. You can study this command section by section. The first step is <code>top -bn2</code>, which print 2 frame of &ldquo;top&rdquo; command to console instead of to curses window.</p>

<p>Here we use &ldquo;-bn2&rdquo; instead of &ldquo;-bn1&rdquo; is because the first ouput is always inaccurate. See comments in <a href="http://stackoverflow.com/questions/9229333/how-to-get-overall-cpu-usage-e-g-57-on-linux#9229692">How to get overall CPU Usage (e.g. 57%) on Linux</a> for details.</p>

<p>The second step is <code>top -bn2|grep "Cpu(s)"</code>, the 3rd step is <code>top -bn2|grep "Cpu(s)"|sed "s/.*, *\([0-9.]*\)%* *id.*/\1/"</code>, etc.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/30/085736/">Virtual Windows on Xpra</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-30T08:57:36+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:57 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want run a virtual machine (Windows 7 system, named &ldquo;Win7Office&rdquo;)  on a remote PC (10.32.1.81).</p>

<h1>Modify VM config</h1>

<p>Start VirtualBox GUI (locally via physical monitor and keyboard connected with host 81, or via VNC). Check &ldquo;Auto-resize Guest Display&rdquo; in vm&rsquo;s Settings -> View menu. Then start Win7Office, verify if vm run properly. Once OK, close this vm.</p>

<h1>Use VM remotely</h1>

<p>On client, run following commands:</p>

<pre><code>ssh 81
xpra start :111 --start-child="VBoxManage startvm Win7Office"
exit
xpra attach ssh:81:111
</code></pre>

<p>Once done, use <code>xpra detach ssh:81:111</code> to detach from this VM.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/27/101004/">Awesome on Arch Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-27T10:10:04+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:10 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Install</h1>

<pre><code># pacman -S awesome
# pacman -S terminator
# pacman -S firefox
# pacman -S gvim
# su - chad
$ echo "exec awesome" &gt; ~/.xinitrc
$ mkdir -p ~/.config/awesome/
$ cp /etc/xdg/awesome/rc.lua ~/.config/awesome/
// modify value of "terminal" from "xterm" to "terminator" in ~/.config/awesome/rc.lua
$ startx
</code></pre>

<p>Or:</p>

<pre><code># pacman -S awesome guake chromium gvim
...
</code></pre>

<h1>Frequently Used Shortcuts</h1>

<p>M-r: run command
M-<Enter>: run terminal defined in ~/.config/awesome/rc.lua
M-<space>: change to next layout
M-Shift-c: close window
M-Ctrl-r: reload awesome config
Alt-<Enter>: full screen</p>

<p>Ref:
<a href="https://wiki.archlinux.org/index.php/Awesome">awesome in arch linux</a>;
<a href="http://awesome.naquadah.org/wiki/Getting_started">some frequently used shortcuts</a>;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/27/100720/">CoLinux Failed on Windows</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-27T10:07:20+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:07 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I downloaded coLinux-0.7.9.exe, installed it, then run command:</p>

<pre><code>cd c:\Program Files\coLinux;
colinux-daemon.exe @example.conf
</code></pre>

<p>The computer restart. So I uninstalled CoLinux.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/26/180252/">Customize Vim Statusline</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-26T18:02:52+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>6:02 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The purpose of the customization is mainly to add full path to vim&rsquo;s statusline. I use <a href="https://github.com/bling/vim-airline">bling/vim-airline</a> to fulfill this.</p>

<h1>Install with Pathogen</h1>

<pre><code>git clone https://github.com/bling/vim-airline ~/.vim/bundle/vim-airline
</code></pre>

<h1>Customize Statusline</h1>

<p>Add the following 2 lines to ~/.vimrc:</p>

<pre><code>set laststatus=2
let g:airline_section_c='%F'
</code></pre>

<p>See <code>:h laststatus</code> for the meaning of &ldquo;laststatus&rdquo;.
See &ldquo;CUSTOMIZATION&rdquo; section of <code>:h airline</code> for the meaning of every section and its default contents.
See <code>:h statusline</code> for the meaning of &ldquo;%F&rdquo; and the name of all statusline items.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/25/114456/">Run GUI Application on Remote Host</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-25T11:44:56+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:44 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Install: <code>apt-get install xpra</code>;</p>

<p>I want to run Thunderbird on host 10.32.1.81:</p>

<pre><code>ssh chad@10.32.1.81 xpra start :100 --start-child=thunderbird
xpra attach ssh:10.32.1.81:100
</code></pre>

<p>Now Thunderbird window appears. You can use &ldquo;Attach&rdquo; to add attachment from the disk of remote server, which means all GUIs from the &ldquo;root&rdquo; GUI can be accessed remotely.</p>

<p>When it&rsquo;s done, press &ldquo;Ctrl-c&rdquo; in the terminal window to close Thunderbird window. Do not click &ldquo;close&rdquo; button, it will kill the Thunderbird window in DISPLAY 100, and you can&rsquo;t visit it any more.</p>

<p>If you want visit this window later:</p>

<pre><code>ssh chad@10.32.1.81 xpra list    // so you get the $DISPLAY number 100
xpra attach ssh:10.32.1.81:100   // run this command in AppFinder (Alt-F2) instead of terminal
xpra detach ssh:81:100           // run this command in AppFinder (Alt-F2) instead of terminal
</code></pre>

<p>If you want clear all:</p>

<pre><code>ssh chad@10.32.1.81 xpra stop :100        // run this command on remote server
</code></pre>

<p>If you want to attach to a xpra server on localhost, run <code>xpra attach :100</code>;</p>

<h1>Use ssh alias</h1>

<p>Add 81 as alias of &ldquo;<a href="&#x6d;&#x61;&#x69;&#108;&#116;&#x6f;&#x3a;&#99;&#104;&#97;&#100;&#x40;&#49;&#x30;&#46;&#x33;&#x32;&#x2e;&#49;&#x2e;&#56;&#49;">&#x63;&#x68;&#97;&#100;&#64;&#49;&#x30;&#x2e;&#51;&#50;&#46;&#x31;&#46;&#56;&#49;</a>&rdquo; in ~/.ssh/config. Then you can use xpra in the following way:</p>

<pre><code>ssh 81 xpra start :111 --start-child=gedit
xpra attach ssh:81:111
ssh 81 xpra list
ssh 81 xpra stop :111
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/24/120847/">Dual Monitors on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-24T12:08:47+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:08 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>Connect VGA cable to laptop;</p></li>
<li><p>List all monitors' name: <code>xrandr -q</code>, or <code>ls /sys/class/drm/</code> if &ldquo;-q&rdquo; doesn&rsquo;t work.</p></li>
<li><p>Open this monitor: <code>xrandr --output VGA1 --auto</code>, now there should be same output on VGA1 and laptop screen;</p></li>
<li><p>Put scrren of laptop (LVDS1) under the screen of 19 inches monitor (VGA1) : <code>xrandr --output LVDS1 --below VGA1 --auto</code>;</p></li>
<li><p>Move an <a href="http://i3wm.org/">i3</a> workspace to monitor VGA1: <code>i3-msg move workspace to output VGA1</code>,
of course you can use any monitor name instead of &ldquo;VGA1&rdquo;.
Use a i3 shortcut instead of command to move workspace between monitors: add the following codes into ~/.i3/config</p>

<pre><code>  # move workspace to left/right screen
  bindsym $mod+Shift+Left move workspace to output left
  bindsym $mod+Shift+Right move workspace to output right
  bindsym $mod+Shift+Up move workspace to output up
  bindsym $mod+Shift+Down move workspace to output down
</code></pre></li>
<li><p>Close a monitor: <code>xrandr --output VGA1 --off</code>;</p></li>
</ul>


<p>These settings worked both on Xfce and <a href="http://i3wm.org/">i3 wm</a>.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/23">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/21">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/09/24/185036/">Add a Local Meteor Package</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/23/123748/">Stack Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/104351/">Using Webstorm as Meteor IDE</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/22/092543/">Autosave in Webstorm</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/21/092600/">Convert a Folder Into Meteor App in Webstorm</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
