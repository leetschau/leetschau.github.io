
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Some bitwise operations in groovy shell, better install this shell via gvm. $ groovysh
groovy:000&gt; bb = 205
===&gt; 205
groovy:000&gt; cc = -51 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/22">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leetschau.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/29/114303/">Java Bitwise Operations</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-29T11:43:03+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:43 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Some bitwise operations in groovy shell, better install this shell via gvm.</p>

<pre><code>$ groovysh
groovy:000&gt; bb = 205
===&gt; 205
groovy:000&gt; cc = -51
===&gt; -51
groovy:000&gt; Integer.toBinaryString(bb)
===&gt; 11001101
groovy:000&gt; Integer.toBinaryString(cc)
===&gt; 11111111111111111111111111001101
groovy:000&gt; Integer.toBinaryString(cc &gt;&gt; 2)
===&gt; 11111111111111111111111111110011
groovy:000&gt; Integer.toBinaryString(cc &gt;&gt;&gt; 2)
===&gt; 111111111111111111111111110011
groovy:000&gt; bb == (cc &amp; 0xFF)
===&gt; true
</code></pre>

<p>So Java use 4 bytes to represent a integer. The left-most bit is &ldquo;1&rdquo; when the integer is a negative, otherwise the position is &ldquo;0&rdquo;.
The &ldquo;var &amp; 0xFF&rdquo; converts the first 3 bytes to 0. In other words, this method converts var into 0~255.</p>

<p>Conversion between binary string and integer and bytes.</p>

<pre><code>groovy:000&gt; aa = 45
===&gt; 45
groovy:000&gt; aas = Integer.toBinaryString(aa)
===&gt; 101101
groovy:000&gt; aa == Byte.parseByte(aas, 2)
===&gt; true
groovy:000&gt; aa.getClass()
===&gt; class java.lang.Integer
groovy:000&gt; aas.getClass()
===&gt; class java.lang.String
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/29/093749/">Analyze Binary File in Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-29T09:37:49+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:37 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On Linux there are some utility to analyze binary files, such as xxd, od, hexdump, which are much convenient and powerful than UltraEdit on Windows.</p>

<pre><code>$ cat test
abcdefg
hijklmn
opq
rst
uvw
xyz

$ xxd test
0000000: 6162 6364 6566 670a 6869 6a6b 6c6d 6e0a  abcdefg.hijklmn.
0000010: 6f70 710a 7273 740a 7576 770a 7879 7a0a  opq.rst.uvw.xyz.

$ xxd -b test
0000000: 01100001 01100010 01100011 01100100 01100101 01100110  abcdef
0000006: 01100111 00001010 01101000 01101001 01101010 01101011  g.hijk
000000c: 01101100 01101101 01101110 00001010 01101111 01110000  lmn.op
0000012: 01110001 00001010 01110010 01110011 01110100 00001010  q.rst.
0000018: 01110101 01110110 01110111 00001010 01111000 01111001  uvw.xy
000001e: 01111010 00001010                                      z.

$ xxd -b -s 10 test
000000a: 01101010 01101011 01101100 01101101 01101110 00001010  jklmn.
0000010: 01101111 01110000 01110001 00001010 01110010 01110011  opq.rs
0000016: 01110100 00001010 01110101 01110110 01110111 00001010  t.uvw.
000001c: 01111000 01111001 01111010 00001010                    xyz.

$ xxd -b -s 0x10 test
0000010: 01101111 01110000 01110001 00001010 01110010 01110011  opq.rs
0000016: 01110100 00001010 01110101 01110110 01110111 00001010  t.uvw.
000001c: 01111000 01111001 01111010 00001010                    xyz.

$ xxd -b -s 3 -l 10 test
0000003: 01100100 01100101 01100110 01100111 00001010 01101000  defg.h
0000009: 01101001 01101010 01101011 01101100                    ijkl

$ xxd -b -s 3 -l 10 -c 1 test
0000003: 01100100  d
0000004: 01100101  e
0000005: 01100110  f
0000006: 01100111  g
0000007: 00001010  .
0000008: 01101000  h
0000009: 01101001  i
000000a: 01101010  j
000000b: 01101011  k
000000c: 01101100  l

$ xxd -p -s 3 -l 10 test
646566670a68696a6b6c
</code></pre>

<p>Compare hex and binary files line by line:</p>

<pre><code>$ xxd -b -c 2 binaryfile &gt; o1
$ xxd -c 2 binaryfile &gt; o2
$ paste o1 o2
0000000: 11001101 11001101  ..  0000000: cdcd  ..
0000002: 00000000 00101110  ..  0000002: 002e  ..
0000004: 10011000 00000011  ..  0000004: 9803  ..
0000006: 11101011 00100000  .   0000006: eb20  . 
0000008: 00000010 10001011  ..  0000008: 028b  ..
000000a: 01000011 00111000  C8  000000a: 4338  C8
000000c: 00001011 10111111  ..  000000c: 0bbf  ..
000000e: 10011011 01100101  .e  000000e: 9b65  .e
0000010: 10000111 00001111  ..  0000010: 870f  ..
0000012: 00100000 00100000      0000012: 2020    
0000014: 00000010 00011100  ..  0000014: 021c  ..
0000016: 01111001 00000001  y.  0000016: 7901  y.
0000018: 01110110 01011100  v\  0000018: 765c  v\
000001a: 00000000 00011011  ..  000001a: 001b  ..
000001c: 00101100 01111101  ,}  000001c: 2c7d  ,}
000001e: 00010001 00011011  ..  000001e: 111b  ..
0000020: 01100101 10001111  e.  0000020: 658f  e.
0000022: 10100010 01010100  .T  0000022: a254  .T
0000024: 10101000 01011011  .[  0000024: a85b  .[
0000026: 00101100 10010011  ,.  0000026: 2c93  ,.
0000028: 11100101 01110100  .t  0000028: e574  .t
000002a: 00100010 11011001  ".  000002a: 22d9  ".
000002c: 01100000 01100000  ``  000002c: 6060  ``
000002e: 11101001 00011111  ..  000002e: e91f  ..
0000030: 00000000 00000000  ..  0000030: 0000  ..
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/28/201252/">Arch Linux Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-28T20:12:52+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:12 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>按照<a href="https://wiki.archlinux.org/index.php/Beginners%27_guide">Beginners&#8217; guide on Arch LInux</a>在虚拟机上安装了Arch Linux，文档写得非常好，首先从<a href="https://www.arcHlinux.org/download/">Arch Linux Downloads</a>下载的镜像文件archlinux-2014.04.01-dual.iso，然后在VirtualBox中新建虚拟机，加载这个镜像，然后根据&#8221;Beginners&#8217; guide on Arch Linux&#8221;一步一步做完就行了，感觉对Linux的认识又深入了。</p>

<p>其中配置网络部分&#8221;2.9 Configure the network&#8221;没有做，重启之后发现网络不通，又按照dhcp方法用netctl工具重做了这一节，重启后网络可用。</p>

<p>大概两个半小时装好了base系统，163有arch Linux mirror，所以包下载速度很快。然后安装窗口管理器。</p>

<p>首先安装X系统：pacman -S xorg-server xorg-server-utils</p>

<p>然后安装display manager: pacman -S xorg-xinit</p>

<p>然后安装Awesome window manager: pacman -S awesome</p>

<p>安装i3: pacman -S i3</p>

<p>修改.xinitrc文件，登录后执行startx命令就进入了图形界面。</p>

<h1>安装SSH服务</h1>

<pre><code># pacman -S openssh
# systemctl start sshd
# systemctl enable sshd.service
</code></pre>

<p>之后就可以用Kitty连接192.168.1.102:22端口了。</p>

<p>用pacman安装fabric和vagrant都是最新版本，so cool.</p>

<hr />

<p>4月28日更新：</p>

<p>按照<a href="https://wiki.archlinux.org/index.php/USB_Flash_Installation_Media">USB Flash Installation Media</a>介绍的方法，首先把U盘插到机器上，然后用</p>

<pre><code>$ ls -la /dev/sd*
</code></pre>

<p>找到U盘的设备文件名：sdb</p>

<p>然后用下面的命令创建了启动U盘：</p>

<pre><code>$ dd bs=4M if=warez/archlinux-2014.04.01-dual.iso of=/dev/sdb &amp;&amp; sync
</code></pre>

<p>无需使用root帐号。几分钟就OK了，奇怪的是做好的U盘在笔记本（联想V480）上无法启动，在DELL PC机上却能够正常启动。</p>

<p>注意/dev/sd*这个设备后面不能有数字，比如如果of=/dev/sdb1,则做出来的U盘不能启动系统。</p>

<hr />

<p>4月29日更新：</p>

<p>晚上在家折腾Arch Linux，搞定了内核安装，主要是配置无线网络部分花了很多时间：</p>

<p>netctl disable my-network
verify: ls /etc/systemd/system/multi-user.target.wants/
reboot
$ iw dev
=> wlp5s0</p>

<p>$ wpa_supplicant -B -i wlp5s0 -c &lt;(wpa_passphrase TP-LINK_PocketAP_8344C2 py25)
Successfully &hellip;</p>

<p>iw dev wlp5s0 link
凌晨之后尝试多次后又搞定了桌面环境，首先尝试I3，失败，估计是由于很多必须的组件还没有装，然后尝试enlightenment，失败，然后尝试安装完整的GNOME，这次居然成功了：</p>

<pre><code> # pacman -S gnome
 # startx
</code></pre>

<p>如果报startx未找到，说明没装X环境，安装下面的包：</p>

<p>lspci | grep VGA
=> intel
pacman -S xf86-video-intel
pacman -S xorg-server xorg-server-utils
pacman -S xorg-xinit</p>

<hr />

<p>5月1日：</p>

<p>使用Win Key作为i3的Mod1键运行i3系统成功，Win+Enter启动terminal，Win+Shift+E退出i3；</p>

<p>用<code>pacman -S xf86-input-synaptics</code>为K27安装触摸板驱动成功，似乎没有Mint自动装的驱动的鼠标乱跳现象；</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/23/114357/">Console Web Browser Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-23T11:43:57+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>11:43 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>lynx</h1>

<p>On Mint: <code>sudo apt-get install lynx</code>.</p>

<ul>
<li><p>Getting help: Shift + /;</p></li>
<li><p>Configuration: o (open VI mode here), the configuration file is ~/.lynxrc;</p></li>
<li><p>Move cursor to previous/next link: up/down arrow keys, or j/k if &ldquo;vi mode&rdquo; turned on;</p></li>
<li><p>Line up/down: Ctrl-p/n;</p></li>
<li><p>Move backward in history (like backspace in Firefox): left arrow key;</p></li>
<li><p>Quit lynx: q;</p></li>
<li><p>Copy text: drag mouse button;</p></li>
<li><p>Add bookmark: a</p></li>
<li><p>Goto bookmark: v</p></li>
</ul>


<p>lynx bookmark can remember file and page position.
While bookmark of elinks only remember file, and always load the first page.
Copying text need only draging mouse, while elinks need pressing shift key at the same time.
So lynx is more convenient than elinks.</p>

<h1>elinks</h1>

<p>On Mint: <code>sudo apt-get install elinks</code>.</p>

<p>Config key bindings in ~/.elinks/elinks.conf.
Append the following lines into it:</p>

<pre><code>bind "main" "j" = "move-cursor-down"
bind "main" "k" = "move-cursor-up"
bind "main" "K" = "keybinding-manager"
</code></pre>

<p>You can use mouse as in the GUI browser.</p>

<ul>
<li><p>Show menu: press <ESC> key;</p></li>
<li><p>Show keybindings: K;</p></li>
<li><p>Line up/down: Ctrl-p/n;</p></li>
<li><p>Quit elinks: q;</p></li>
<li><p>Move cursor to previous/next link: j/k or up/down arrow keys;</p></li>
<li><p>Copy text: press Shift key and drag mouse;</p></li>
<li><p>Copy current page URL(Ctrl-L on Firefox): =, then copy URL;</p></li>
<li><p>Add/Show bookmark: s;</p></li>
<li><p>Set a mark: m followed by a single character, for example &ldquo;ma&rdquo;, or &ldquo;mz&rdquo;. The mark only exists within a elinks session. It won&rsquo;t exist after elinks restart.</p></li>
<li><p>Goto a mark: &lsquo;(single quote). For example: &#8216;a, or &#8216;z. It only works when cursor is in the same frame as it&rsquo;s set.</p></li>
<li><p>Jump to next frame: tab;</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/23/113830/">Add Vim Mode for Eclipse With Vrapper</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-23T11:38:30+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>11:38 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Installation</h1>

<p>Install vrapper 0.42.0 in market place of eclipse.</p>

<h2>Install with proxy (in Linux)</h2>

<ol>
<li><p>Run commands:</p>

<p> $ cd $ECLIPSE_HOME
 $ export http_proxy=<a href="http://127.0.0.1:8087">http://127.0.0.1:8087</a>
 $ export https_proxy=<a href="http://127.0.0.1:8087">http://127.0.0.1:8087</a>
 $ ./eclipse</p></li>
<li><p>After eclipse startup, install vrapper as usual. The proxy will work for eclipse automatically. Uninstall vrapper and other plugin in main menu of eclipse -> Help -> About Eclipse -> Installation Details.</p></li>
</ol>


<h1>Usage</h1>

<p>Ref: <a href="http://vrapper.sourceforge.net/documentation">Vrapper Documentation</a></p>

<ul>
<li>Configuration file: ~/.vrapperrc</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/22/182822/">Shutdown VirtualBox VM Forcibly When It's Stuck in Stopping Status</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-22T18:28:22+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>6:28 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I shutdown a VM using vagrant command <code>vagrant halt</code>, it&rsquo;s stuck in &ldquo;stopping&rdquo; status, and when I use <code>VBoxManage controlvm &lt;vm-name&gt; poweroff</code> to shutdown it, it raise an error:</p>

<pre><code>VBoxManage: error: The virtual machine is being powered down
VBoxManage: error: Details: code VBOX_E_INVALID_VM_STATE (0x80bb0002), component Console, interface IConsole, callee nsISupports
VBoxManage: error: Context: "PowerDown(progress.asOutParam())" at line 224 of file VBoxManageControlVM.cpp
</code></pre>

<p>So the only solution is kill the VM process:</p>

<pre><code>$ ps -ef|grep VBox
</code></pre>

<p>And a process named &ldquo;/opt/VirtualBox/VBoxHeadless &ndash;comment &hellip; &ndash;startvm &hellip;&rdquo; is the target (identified by the comment). Kill it then.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/22/143559/">Install Package on openSUSE</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-22T14:35:59+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>2:35 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The best options of the method to install packages in openSUSE in orders are:</p>

<ol>
<li><p>Use YaST/Zypper to install from an openSUSE repo;</p></li>
<li><p>Use YaST/Zypper to install from a community repo;</p></li>
<li><p>Search at software.openSUSE.org;</p></li>
<li><p>Download rpm file and use YaST to install it;</p></li>
<li><p>Download rpm file and use rpm at a CLI to install it;</p></li>
<li><p>Download, compile and install source;</p></li>
<li><p>Use a one-click install found at software.openSUSE.org with CAUTION;</p></li>
<li><p>Use <a href="http://joeyh.name/code/alien/">alien</a> and deb with CAUTION;</p></li>
<li><p>Use any other one-click install anywhere on the net with CAUTION;</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/22/122449/">BVT Environment Based on Vagrant</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-22T12:24:49+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>12:24 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Process</h1>

<ol>
<li><p>Install common software in provision script, such as JDK, Ant;</p></li>
<li><p>Write a shell script for a given build task;</p></li>
<li><p>Run this script in Jenkins;</p></li>
</ol>


<h1>Use Case</h1>

<h2>Vagrantfile</h2>

<pre><code>config.vm.box = "precise64"
config.vm.define "bs" do |bvtserver|
  bvtserver.vm.hostname = "bvt-server"
  bvtserver.vm.network "private_network", ip: "192.168.50.3",
      virtualbox__intnet: "gcptest-network"
  bvtserver.vm.provider :virtualbox do |vbox|
    vbox.customize ["modifyvm", :id, "--natnet1", "10.3/16"]
  end 
  bvtserver.vm.provision :shell, path: "bvtprov.sh", privileged: false
end 
</code></pre>

<h2>bvtprov.sh</h2>

<p>This script install Subversion, zip, JDK and Ant on this VM.</p>

<pre><code>#!/bin/sh
sudo ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
sudo dpkg -i /vagrant/packages/svn_amd64_ubuntu12.04/*.deb
sudo dpkg -i /vagrant/packages/zip_3.0-4_amd64.deb
mkdir /home/vagrant/apps
cd /home/vagrant/apps
chmod 755 /vagrant/packages/jdk-6u45-linux-x64.bin
sh /vagrant/packages/jdk-6u45-linux-x64.bin
tar jxf /vagrant/packages/apache-ant-1.9.3-bin.tar.bz2
export PATH=$PATH:/home/vagrant/apps/jdk1.6.0_45/bin:/home/vagrant/apps/apache-ant-1.9.3/bin
export LC_ALL=en_US.UTF-8
</code></pre>

<h2>A build task: build-gcp-web-6.1_P2_GZ.sh</h2>

<p>This script checkout codes from Subersion server and compile, make zip for a specific project.</p>

<pre><code>export PATH=$PATH:/home/vagrant/apps/jdk1.6.0_45/bin:/home/vagrant/apps/apache-ant-1.9.3/bin
export LC_ALL=en_US.UTF-8

projname="GCP6.1_P2_GZ"

svnprefix='svn co --non-interactive --no-auth-cache --username bvt --password mypwd'
svnroot='http://10.0.2.59:8118/svn/gcp/Development-Area'
$svnprefix ${svnroot}/7-Tools/deployment/packages/pubs /vagrant/packages
$svnprefix ${svnroot}/3-SCL/Branch/$projname /vagrant/codes/$projname

rm -rf /vagrant/codes/*.zip

web_build=/vagrant/codes/web_build
rm -rf $web_build;  mkdir $web_build
tar zxf /vagrant/packages/apache-tomcat-6.0.39.tar.gz -C $web_build/
mv $web_build/apache-tomcat-6.0.39 $web_build/web_server
cp -r /vagrant/codes/$projname/WebRoot $web_build/web_server/webapps/$projname
src_dir=/vagrant/codes/$projname/src
class_dir=$web_build/web_server/webapps/$projname/WEB-INF/classes
lib_dir=/vagrant/codes/$projname/WebRoot/WEB-INF/lib
find $src_dir -type f -name "*.java" -exec javac -cp "$lib_dir/*:$src_dir" -d $class_dir {} \;
rsync -auC --exclude='*.java' $src_dir/ $class_dir/

cd /vagrant/codes/web_build;  zip -q ../$projname.zip -r web_server -x "*/.svn/*"

pkg_prefix=/vagrant/codes/${projname}-
rm -rf ${pkg_prefix}*
pkgs=${pkg_prefix}$(date +%Y%m%dT%H%M)
mkdir $pkgs
cp /vagrant/codes/*.zip $pkgs
</code></pre>

<h2>Run this task on Jenkins</h2>

<p>Add the following shell commands in the &ldquo;GCP-Web-6.1_P2_GZ&rdquo; project in Jenkins:</p>

<pre><code>cd ~/docs/bvtvm
vagrant ssh [vm-name] -c 'sh /vagrant/build-gcp-web-6.1_P2_GZ.sh'
</code></pre>

<p>The [vm-name] is the VM you want ssh to, &ldquo;bs&rdquo; in this case. If you have only one vm defined in Vagrantfile, you can omit the it, or you can get the value of it via <code>vagrant status</code>;</p>

<p>Note: Try to avoid usage of relative path in scripts. If you have to(sush as make a tar file), use &lsquo;cd -&rsquo; to jump back after operations.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/21/163107/">openSUSE Notes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-21T16:31:07+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>4:31 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Install Vagrant and VirtualBox on openSUSE GNOME 13.1</h1>

<ol>
<li><p>Download VirtualBox-4.3.10-93012-Linux_amd64.run from VirtualBox website;</p></li>
<li><p>Update zypper: $ zypper update;</p></li>
<li><p>Install components to compile VirtualBox: $ zypper in gcc kernel-devel kernel-desktop kernel-desktop-devel</p></li>
<li><h1>reboot</h1></li>
<li><p>Run the downloaded .run file to install VirtualBox;</p></li>
<li><p>Download vagrant_1.4.3_x86_64.rpm from Vagrant website;</p></li>
<li><p>Install it with <code>rpm -ivh vagrant_1.4.3_x86_64.rpm</code>;</p></li>
</ol>


<h1>Other issues</h1>

<ul>
<li><p>You need start network service manually at system startup in openSUSE GNOME 13.1: <code>service NetworkManager start</code>;</p></li>
<li><p>Enable SSH Server on openSUSE: YaST -> Firewall, add SSH Server to &ldquo;Allowed Services&rdquo;.</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/21/160442/">Package Management on openSUSE 13.1</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-21T16:04:42+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>4:04 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Add zypper proxy:
Add http and https proxy in file /etc/sysconfig/proxy;</p>

<p>YaST:</p>

<p>Find a fast repo:
<a href="http://mirrors.opensuse.org/">http://mirrors.opensuse.org/</a>
<a href="http://mirrors.hust.edu.cn/opensuse/">http://mirrors.hust.edu.cn/opensuse/</a> ->  <a href="http://mirrors.hust.edu.cn/opensuse/update/13.1/">http://mirrors.hust.edu.cn/opensuse/update/13.1/</a></p>

<p>add repo:
zypper ar -c <a href="http://mirrors.ustc.edu.cn/opensuse/update/13.1/">http://mirrors.ustc.edu.cn/opensuse/update/13.1/</a> ustc</p>

<p>list repo with priority:
zypper lr -p</p>

<p>modify repo priority:
zypper mr -p 100 ustc
zypper mr &ndash;help</p>

<p>Refresh repo:
zypper ref ustc</p>

<p>Update or install from a specific repo:
zypper up -r ustc
Average 200KB/s.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/23">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/21">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/04/18/140631/">4月17日讲座文字稿</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/17/151844/">Linux Mint System Provision</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/16/172913/">Fzf让命令行更方便</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/15/105035/">How to Sync a Fork on Github</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/08/161006/">Python的Generator和yield</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
