
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Swap Caps lock and Escape Key Write the following text into file swapCapsEsc: remove Lock = Caps_Lock keysym Escape = Caps_Lock keysym Caps_Lock = &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/30">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leetschau.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/24/193318/">Define Keymap on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-24T19:33:18+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>7:33 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Swap Caps lock and Escape Key</h1>

<p>Write the following text into file swapCapsEsc:</p>

<pre><code>remove Lock = Caps_Lock 
keysym Escape = Caps_Lock 
keysym Caps_Lock = Escape 
add Lock = Caps_Lock
</code></pre>

<p>$ xmodmap swapCapsEsc</p>

<p>Ref: <a href="http://vim.wikia.com/wiki/Map_caps_lock_to_escape_in_XWindows">http://vim.wikia.com/wiki/Map_caps_lock_to_escape_in_XWindows</a></p>

<h1>Swap Ctrl and Alt Key</h1>

<pre><code>remove mod1 = Alt_L Alt_R 
remove control = Control_L Control_R 
keycode 64 = Control_L 
keycode 37 = Alt_L 
keycode 108 = Control_R 
keycode 105 = Alt_R 
add control = Control_L Control_R 
add mod1 = Alt_L Alt_R 
</code></pre>

<p>64, 37, etc are determined by &ldquo;xev&rdquo; command, see below for usage.</p>

<h1>Reset Key Map to Initial State</h1>

<p>setxkbmap -layout us</p>

<h1>Define key swap shortcuts</h1>

<p>It&rsquo;s mainly for emacs operation convenience to swap Ctrl and Alt key, and vi operation convenience to swap Caps Lock and Escape key. When you are not in emacs and vi, swap keys always lead confusions. So it&rsquo;s necessary to switch key definition quickly. The following are some basic method to achieve key swap shortcuts</p>

<ol>
<li><p>Create a file named &ldquo;swapCapsEsc&rdquo; in /home/lichao/docs/swapkeys</p>

<p> remove Lock = Caps_Lock
 keysym Escape = Caps_Lock
 keysym Caps_Lock = Escape
 add Lock = Caps_Lock</p></li>
</ol>


<p>and a file named &ldquo;swapCtrlAlt&rdquo; in /home/lichao/docs/swapkeys:</p>

<pre><code>remove mod1 = Alt_L Alt_R 
remove control = Control_L Control_R 
keycode 64 = Control_L 
keycode 37 = Alt_L 
keycode 108 = Control_R 
keycode 105 = Alt_R 
add control = Control_L Control_R 
add mod1 = Alt_L Alt_R 
</code></pre>

<ol>
<li><p>Create keyboard shortcuts in &ldquo;Application Finder (Alt + F3) -> Preferences -> Custom Actions&rdquo;:</p>

<p> Type: Regular Expression; Pattern: swce; Command: xmodmap /home/lichao/docs/swapkeys/swapCapsEsc
 Type: Regular Expression; Pattern: swca; Command: xmodmap /home/lichao/docs/swapkeys/swapCtrlAlt
 Type: Regular Expression; Pattern: swres; Command: setxkbmap -layout us</p></li>
</ol>


<p>Now you can use [Alt-F2 swce] to swap Caps lock and escape key, use [Alt-F2 swca] to swap Ctrl and Alt key, use [Alt-F2 swres] to make all keys to their original state (If you have swaped ctrl and alt key, the shortcut is [Ctrl-F2 swres]).</p>

<h1>Usage of xev</h1>

<p>Run &ldquo;xev&rdquo; in command line. A little window appear. Make it active window and press some key, the keycode will show in the window.</p>

<h1>Usage of xmodmap</h1>

<p>Run &ldquo;xmodmap -pm&rdquo; we got:</p>

<p>shift  Shift_L (0x32), Shift_R (0x3e)
lock  Caps_Lock (0x42)
control  Control_L (0x25), Control_R (0x69)
mod1  Alt_L (0x40), Alt_R (0x6c), Meta_L (0xcd)
mod2  Num_Lock (0x4d)
mod3
mod4  Super_L (0x85), Super_R (0x86), Super_L (0xce), Hyper_L (0xcf)
mod5  ISO_Level3_Shift (0x5c), Mode_switch (0xcb)</p>

<p>Here the names in the left column (shift, lock, control, etc) are called &ldquo;Modifier Name&rdquo;, while the names in the right column (Shift_L, Caps_Lock, Control_R, Meta_L, etc) are called keysym. Shift_L means left shift key, while Shift_R means right shift key. Every physical key (on keyboard) has a identity (integer number) called keycode. You can use &ldquo;xmodmap -pk&rdquo; to investigate these relationships. And use <code>xmodmap -e "keycode &lt;to_be_modified&gt; = &lt;target_key&gt;"</code> to modify these relationships. For example, the following command make F2 key print &ldquo;m&rdquo; in gedit panel:</p>

<pre><code>xmodmap -e "keycode 68 = m":
</code></pre>

<p>Before command:</p>

<p> 58   0x006d (m)
 68   0xffbf (F2)</p>

<p>(get by &ldquo;xmodmap -pk&rdquo;). After command:</p>

<p> 58   0x006d (m)
 68   0x006d (m)</p>

<p>Use <code>xmodmap -e "keycode 68 = F2"</code> to modify F2 back to F2 key.</p>

<p>The right hand side of this assignment is keysym name. So</p>

<pre><code>xmodmap -e "keycode 16 = 7"
</code></pre>

<p>will map character &ldquo;7&rdquo; to physical key which has keycode 16.</p>

<p>&ldquo;clear <ModifierName>&rdquo; means all keysyms will be detached from this <ModifierName>. So after <code>xmodmap -e "clear control"</code>, all control keys (left and right) are disabled.</p>

<p>&ldquo;remove <ModifierName> = <keysym>&rdquo; means remove <keysym> from the list of current keysym list of the <ModifierName>. So after <code>xmodmap -e "remove Control = Control_R"</code> makes right control key be disabled. When you run <code>xmodmap -e "add Control = Control_R"</code>, the right control key is enabled again. You can use &ldquo;xmodmap -pm&rdquo; to verify.</p>

<p>&ldquo;keysym name1=name2&rdquo; means binding the keys (previous binded to name2) to name1;</p>

<h1>Auto load xmodmap files when system start</h1>

<p>xmodmap ~/.Xmodmap</p>

<p>Ref: <a href="http://earthviaradio.wordpress.com/2012/02/06/swapping-the-left-alt-and-ctrl-keys-in-ubuntu-11-10/">http://earthviaradio.wordpress.com/2012/02/06/swapping-the-left-alt-and-ctrl-keys-in-ubuntu-11-10/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/24/183100/">Use W3m as Web Browser</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-24T18:31:00+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:31 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Installation: apt-get install w3m.</p>

<p>use &ldquo;a&rdquo; to input text, &ldquo;tab&rdquo; to jump between hyper-links, &ldquo;enter&rdquo; to click the hyper-link.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/24/165410/">Package Managemnet in Emacs</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-24T16:54:10+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>4:54 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Use &ldquo;M-x list-packages&rdquo; go to package-menu-mode. Then use up/down arrow key traverse items, use &ldquo;i&rdquo; mark the current item for installation, use &ldquo;d&rdquo; for uninstallation, use &ldquo;u&rdquo; for unmark, &ldquo;x&rdquo; for execute installaiton/remove.</p>

<p>Or use &ldquo;M-x package-install&rdquo; to install a package.</p>

<p>Ref: <a href="http://ergoemacs.org/emacs/emacs_package_system.html">A Guide on Emacs 24 Package System</a></p>

<h1>Modify repository and take effect</h1>

<p>Modify ~/.emacs to add repository like the followings, then run &ldquo;M-x eval-buffer&rdquo;.</p>

<h2>Use MELPA repository</h2>

<pre><code>(require 'package) 
(add-to-list 'package-archives 
   '("melpa" . "http://melpa.milkbox.net/packages/") t) 
(package-initialize)
</code></pre>

<p>This works in Yiyang intranet.</p>

<h2>Use Marmalade Repository</h2>

<pre><code>(require 'package) 
(add-to-list 'package-archives 
   '("marmalade" . "http://marmalade-repo.org/packages/")) 
(package-initialize)
</code></pre>

<p>This doesn&rsquo;t work in Yiyang intranet.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/24/154755/">Evil Extension of Emacs</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-24T15:47:55+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>3:47 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.emacswiki.org/emacs/Evil">Evil</a> is vi mode in emacs.</p>

<ul>
<li><p>Use &ldquo;y&rdquo; to copy text into system clipboard and paste them somewhere else, vice versa.</p></li>
<li><p>Use :bd to kill buffer, much faster than &lt;<C-x k RET>>;</p></li>
<li><p>Use :q to leave Emacs, much faster than C-x C-c; Be careful to use these 2 commands for they providing no confirmaiton for modifications of buffers;</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/24/111911/">Batch Rename in Zsh</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-24T11:19:11+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>11:19 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are many mp3 files with initial &ldquo;Various - &hellip;&rdquo;, like:</p>

<pre><code>Various - Beethoven:Symphony No.5-Allegro Con Brio.mp3
</code></pre>

<p>Now I want to remove the &ldquo;Various - &rdquo; in the file name, to &ldquo;Beethoven:Symphony No.5-Allegro Con Brio.mp3&rdquo;.</p>

<p>In zsh we have a tool called zmv can do this job. Firstly we have to use <code>autoload zmv</code> to activate it. Then use &ldquo;-n&rdquo; option to print the result without actually performing the rename operation. When it is ok, remove the -n option to rename all the files:</p>

<pre><code>zmv -n '(*).mp3' '${1//Various\ -\ /}.mp3'
zmv '(*).mp3' '${1//Various\ -\ /}.mp3'
</code></pre>

<p>Ref: <a href="http://www.drbunsen.org/batch-file-renaming/">http://www.drbunsen.org/batch-file-renaming/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/24/100219/">Rip CD on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-24T10:02:19+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:02 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>用Mint自带的banshee可以把CD转换为ogg文件，[Media -> Import Media]，然后选择Audio CD，但只能转换为ogg格式，好像不能自动获取ID3标签；比较好的方法是使用RipperX，它可以把CD转换为wav, ogg, mp3, flac等格式，Ubuntu自带了ogg编码器，需要转为MP3的话需要手工下载编码器：</p>

<pre><code>sudo apt-get install lame libmp3lame0
</code></pre>

<h1>设置</h1>

<p>包括输出格式，参数，路径等。在RipperX里面的[Config -> Mp3]下&#8221;Encoder plugin&#8221;选择&#8221;Lame MP3 Encoder&#8221;，然后在[Config -> General]下设置好MP3文件的输出目录（Target Directory），然后就可以转换了。</p>

<h1>获取ID3标签</h1>

<p>ID3标签会在播放设备中显示，所以还是很重要的。RipperX提供了在线获取ID3标签的方法，只要点击面板上面的&#8221;CDDB&#8221;按钮就可以自动获取了，包括CD的Artist和Album名称，各轨道名称等，如果获取不到就只能手工输入了，</p>

<h1>辅助工具</h1>

<p>转换完成后用eyeD3查看转换出来的mp3文件ID3 tag是否正确。安装此工具：</p>

<pre><code>sudo pip install eyeD3
</code></pre>

<p>如果报已安装，但eyeD3命令不可用，用</p>

<pre><code>sudo pip install eyeD3 --upgrade
</code></pre>

<p>试一下；查看mp3 tag的指令是<code>eyeD3 &lt;file_name&gt;</code>，也可以用它来设置（修改）ID3标签，格式是：</p>

<p> eyeD3 -a <artist_name> -A <album_name> -t <title> -n <track_num> file_name</p>

<p>查询和修改都支持通配符；</p>

<p>Ref:</p>

<p><a href="http://www.pauljoyceuk.com/codex/2012/ripperx-not-encoding-mp3s/">http://www.pauljoyceuk.com/codex/2012/ripperx-not-encoding-mp3s/</a></p>

<p><a href="http://eyed3.nicfit.net/">http://eyed3.nicfit.net/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/23/192656/">Use Conque and Clojure REPL as Clojure IDE</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-23T19:26:56+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2013</span></span> <span class='time'>7:26 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://code.google.com/p/conque/">conque</a> is a vim plugin which allows you to run shell in a vim buffer.</p>

<p>To install, download conque_2.3.tar.gz and extract it into ~/.vim/bundle (yes you have to use pathogen to manage your vim plugins). Start vim, input &ldquo;:Con<tab>&rdquo;, it will be extract to &ldquo;:ConqueTerm &rdquo;, then input the command you want to run, like bash, clojure, python, etc.</p>

<p>Other commands include ConqueTermSplit, ConqueTermTab, ConqueVSplit.</p>

<p>The workflow is:</p>

<ol>
<li><p>Start vi and &ldquo;:ConqueTerm clojure&rdquo;;</p></li>
<li><p>Input something;</p></li>
<li><p>Back to normal mode and use &ldquo;:w mylog&rdquo; to save your script.</p></li>
</ol>


<p>Note: you have to add file name after :w every time saving the script for the &ldquo;buftype&rdquo; attribute is &ldquo;nofile&rdquo;.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/23/163218/">Using Emacs as Clojure IDE</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-23T16:32:18+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2013</span></span> <span class='time'>4:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li><p>Open emacs24;</p></li>
<li><p>Change CWD to parent folder of project home: M-x cd<CR> ~/docs/tmp<CR>;</p></li>
<li><p>Build a leiningen project: M-! lein new calc-cov (see Run Shell Command in Emacs for other method to run shell command in emacs);</p></li>
<li><p>Change CWD to project home: M-x cd<CR> calc-cov<CR>;</p></li>
<li><p>Start nrepl server: M-x nrepl-jack-in;</p></li>
<li><p>Open source file in another window: C-x 2 C-x C-f src/&hellip;/core.clj;</p></li>
<li><p>Change the namespace of the REPL to the namespace of the file you are in: C-c M-n;</p></li>
<li><p>Evaluate the whole source file: C-c C-k, evaluate a s-exp before the cursor: C-x C-e;</p></li>
<li><p>Open clojure doc of the function under the cursor: C-c C-d</p></li>
<li><p>Run test: C-c C-,</p></li>
</ol>


<h1>Frequently used keyboard shortcuts and commands</h1>

<ul>
<li><p>Toggle focus between nrepl window and clojure source file window: C-c C-z (you should add &ldquo;(add-to-list &lsquo;same-window-buffer-names &rdquo;<em>nrepl</em>&ldquo;)&rdquo; to ~/.emacs;</p></li>
<li><p>Always pretty printing in the REPL: M-x nrepl-toggle-pretty-printing</p></li>
<li><p>Move over sexp: C-M-b/C-M-f;</p></li>
<li><p>Interrupt any pending evaluations: C-c C-b;</p></li>
</ul>


<h1>Evaluate a sexp without evaluate all file</h1>

<ol>
<li><p>Add this sexp into source file (unnecessary to save source file);</p></li>
<li><p>Use following methods to evaluate the sexp:</p></li>
<li><p>Move cursor to the sexp for test, C-M-x (or C-c C-c) to evaluate the top-level form (such as a defn expression) under the cursor; If you want insert the evaluation result to current buffer, use C-u C-M-x;</p></li>
<li><p>If the the target form is not a &ldquo;top-level&rdquo; form, move the cursor to the <strong>end</strong> of this sexp, C-x C-e to evaluate it, See more shortcuts at <a href="https://github.com/clojure-emacs/nrepl.el">nrepl official site</a>;</p></li>
</ol>


<p>Then this sexp has been added to the repl, you can use it in repl;</p>

<p>This is very helpful in some circumstances. For example, I want debug function &ldquo;cell-block&rdquo; (see p141 in &ldquo;Clojure Programming&rdquo;), add</p>

<pre><code>(println "[left mid right] is:") 
(println [left mid right]) 
</code></pre>

<p>before &ldquo;(window (map &hellip;)&rdquo;. But You can&rsquo;t evaluate the whole file because there are some lazy sequences and evaluate whole file will cause JVM heap out of memory; So I only evaluate this modified version with C-x C-e, test it in repl. After I figure out how this function works, undo my modification and move on.</p>

<p>Note:</p>

<ul>
<li><p>In clojure mode with Evil, you have to switch to insert state and put the cursor <strong>after</strong> the last parenthsis, then evaluate the expression with C-x C-e. If you put the cursor <strong>on</strong> the last parenthesis in normal state, The result will be wrong.</p></li>
<li><p>It unnecessary to put your clojure file in a leiningen-created project, which is more flexible than vim-fireplace;</p></li>
<li><p>The value of expression will be output to the <em>message</em> area (bottom of the emacs window), while the output by &ldquo;println&rdquo; will be output to nrepl buffer;</p></li>
<li><p>Switch cursor between windows: C-x o;</p></li>
<li><p>Clear repl output: C-c M-o;</p></li>
<li><p>Indent code blocks intelligently: C-M-q</p></li>
<li><p>All the keyboard shortcuts will be more convenient if you swap CapsLock key and Escape key, together with Ctrl key and Alt key, see Define Keymap on Ubuntu for detail;</p></li>
</ul>


<p>Ref: <a href="http://stackoverflow.com/questions/3636364/can-i-clean-the-repl">http://stackoverflow.com/questions/3636364/can-i-clean-the-repl</a></p>

<p>Ref: <a href="http://cojure-doc.org/articles/tutorials/emacs.html">Clojure with Emacs</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/22/175355/">Use Vim as Clojure Development Environment</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-22T17:53:55+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2013</span></span> <span class='time'>5:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Build IDE in vim</h1>

<ol>
<li><p>Install leiningen 2.x;</p>

<p> verify: <code>lein repl</code> produces something like &ldquo;nREPL server started on port&hellip;&rdquo;;</p></li>
<li><p>Install <a href="https://github.com/tpope/vim-fireplace">vim-fireplace</a> with pathogen:</p>

<pre><code> cd ~/.vim/bundle
 git clone git://github.com/tpope/vim-fireplace.git 
 git clone git://github.com/tpope/vim-classpath.git 
 git clone git://github.com/guns/vim-clojure-static.git
</code></pre></li>
<li><p>Create a new clojure project: <code>lein new myproj</code>;</p></li>
<li><p>Run &ldquo;lein repl&rdquo; under myproj (to download necessary jar files), then quit repl (if you met some errors at next step, try not to quit repl);</p></li>
<li><p>edit a clojure file (*.clj) with vi, using &ldquo;:Eval&rdquo; to evaluate the expression under cursor, using &ldquo;:%Eval&rdquo; to evaluate current namespace;</p></li>
</ol>


<p>Note 1: the clj file must be one of the source files (under &ldquo;src&rdquo; folder)of a clojure project created by leiningen. And the first line of this file (a clojure module actually) must be &ldquo;(ns project-name.module-name)&rdquo;;</p>

<p>Note 2: <code>lein repl</code> (to start nREPL server when evaluating expression in vi) and adding &ldquo;[org.clojure/tools.nrepl &#8220;0.2.3&rdquo;]&ldquo; to project.clj are unnecessary;</p>

<p>Ref:</p>

<p><a href="http://clojure-doc.org/articles/tutorials/vim_fireplace.html">http://clojure-doc.org/articles/tutorials/vim_fireplace.html</a></p>

<p><a href="http://www.boxuk.com/blog/unboxing-vim-fireplace/">http://www.boxuk.com/blog/unboxing-vim-fireplace/</a></p>

<h1>Define Shortcuts for Efficiency</h1>

<p>Add &ldquo;autocmd FileType clojure nnoremap <buffer> <F5> :Eval<CR>&rdquo; in .vimrc (before &ldquo;filetype on&rdquo;).</p>

<p>Explanation: &ldquo;autocmd <event> <command>&rdquo; means when <event> happens, run command <command>. Here <event> is &ldquo;FileType clojure&rdquo;, <command> is &ldquo;nnoremap <buffer> <F5> :Eval<CR>&rdquo;. The <buffer> options here is &ldquo;buffer local map&rdquo;, which means this keymapping only take effect on the current buffer. See <a href="http://learnvimscriptthehardway.stevelosh.com/chapters/11.html">Buffer-Local Options and Mappings in Learn Vimscript the Hard Way</a> for explanations.</p>

<p>To determine FileType name (here is clojure), you should open a target file (here is any file with &ldquo;.clj&rdquo; extension) in vi, then run &ldquo;:set filetype&rdquo;.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/09/22/114517/">MIT Scheme Development on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-09-22T11:45:17+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2013</span></span> <span class='time'>11:45 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li><p><code>sudo apt-get mit-scheme</code>;</p></li>
<li><p>run &ldquo;scheme&rdquo; then you enter the command line scheme repl;</p></li>
<li><p><code>sudo apt-get emacs</code>;</p></li>
<li><p>modify &ldquo;(setq scheme-program-name &#8220;scm&rdquo;)&ldquo; in .emacs to &rdquo;(setq scheme-program-name &ldquo;scheme&rdquo;)&ldquo;, because our scheme command is &#8220;scheme&rdquo;;</p></li>
<li><p>install quack with <code>apt-get install emacs-goodies-el</code>;</p></li>
<li><p>open emacs and create a new buffer with &ldquo;C-x C-f myfile.scm&rdquo;;</p></li>
<li><p>input following code:</p>

<pre><code> (define (mydouble x) 
     (+ (* x 2) 10))
</code></pre></li>
<li><p>save file: C-x C-s;</p></li>
<li><p>split window: C-x 2;</p></li>
<li><p>switch to bottom window: C-x o;</p></li>
<li><p>start scheme repl at bottom window: M-x run-scheme</p></li>
<li><p>switch back to top window: C-x o;</p></li>
<li><p>parse code: C-x C-e;</p></li>
<li><p>switch back to bottom window(C-x o) and run &ldquo;(mydouble 3)&rdquo;, you got 16;</p></li>
<li><p>modify source file in upper window and parse it again (C-x C-e);</p></li>
<li><p>run &ldquo;(mydouble 3)&rdquo; again, now you get another value;</p></li>
</ol>


<p>Ref: <a href="http://community.schemewiki.org/?emacs-tutorial">A tutorial for using Emacs with Scheme</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/31">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/29">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/10/02/005047/">Clojure Web Development</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/01/210506/">Dmenu Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/27/113819/">A Simple Ring Server</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/24/073009/">Xen on CentOS 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/20/105816/">Lightweight Web Browser Dwb</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
