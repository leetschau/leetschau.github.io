
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="[chad@chadpc527:~/docs/tmp/mytest] % workon test (test)[chad@chadpc527:~/docs/tmp/mytest]
% pip install nose
&hellip; (test)[chad@chadpc527:~/docs/ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/posts/18">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leetschau.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/13/101242/">Use Nose as Unit Test Framework</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-13T10:12:42+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:12 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>[chad@chadpc527:~/docs/tmp/mytest]</p>

<p>% workon test</p>

<p>(test)[chad@chadpc527:~/docs/tmp/mytest]
% pip install nose
&hellip;</p>

<p>(test)[chad@chadpc527:~/docs/tmp/mytest]
% tree
.
|&ndash; mytest
| |&ndash; <strong>init</strong>.py
| |&ndash; mytest.py
| <code>-- test
|  |-- __init__.py
| </code>&ndash; test_mytest.py
`&ndash; setup.py
2 directories, 5 files</p>

<p>(test)[chad@chadpc527:~/docs/tmp/mytest]
% python setup.py nosetests
running nosetests
running egg_info
creating mytest.egg-info
writing mytest.egg-info/PKG-INFO
writing top-level names to mytest.egg-info/top_level.txt
writing dependency_links to mytest.egg-info/dependency_links.txt
writing manifest file &lsquo;mytest.egg-info/SOURCES.txt&rsquo;
reading manifest file &lsquo;mytest.egg-info/SOURCES.txt&rsquo;
writing manifest file &lsquo;mytest.egg-info/SOURCES.txt&rsquo;
running build_ext</p>

<h2>. </h2>

<p>Ran 1 test in 0.007s
OK</p>

<p>(test)[chad@chadpc527:~/docs/tmp/mytest]
% cat setup.py</p>

<h1>import multiprocessing</h1>

<p>from setuptools import setup
setup(name=&lsquo;mytest&rsquo;,
  version=&lsquo;0.1.0&rsquo;,
  tests_require=[&lsquo;nose&rsquo;])</p>

<p>(test)[chad@chadpc527:~/docs/tmp/mytest]
% cat mytest/mytest.py
def myadd(x,y):
 return 10<em>x+y
(test)[chad@chadpc527:~/docs/tmp/mytest]
% cat mytest/test/test_mytest.py
from unittest import TestCase
from mytest.mytest import myadd
class TestMyadd(TestCase):
 def test_myadd(self):
  actual = myadd(3,5)
  self.assertTrue(actual==10</em>3+5)</p>

<p>Or, you can use &ldquo;python setup.py test&rdquo; in this way:</p>

<ol>
<li><p>Add &ldquo;import multiprocessing&rdquo; in setup.py;</p></li>
<li><p>Add &ldquo;test_suite=&lsquo;nose.collector&rsquo;&rdquo; as a parameter in setup() function in setup.py;</p></li>
</ol>


<p>If you run &ldquo;python setup.py test&rdquo; without &ldquo;import multiprocessing&rdquo;, you will get a &ldquo;Error in atexit._run_exitfuncs&rdquo; error with nose 1.3.0 and Python 2.7.3.</p>

<p>Ref: <a href="https://groups.google.com/forum/#!topic/nose-users/fnJ-kAUbYHQ">https://groups.google.com/forum/#!topic/nose-users/fnJ-kAUbYHQ</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/10/102952/">Publish and Install Python Applications</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-10T10:29:52+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:29 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Publish to PyPI</h1>

<p>Follow <a href="http://www.scotttorborg.com/python-packaging/index.html">How To Package Your Python Code</a>.</p>

<h2>Register</h2>

<p>I ran &ldquo;python setup.py register&rdquo; twice. Firstly I use option 2 to register a new account, then ran it again and use option 1 to upload the &ldquo;funniest&rdquo; package. Then I saw this package in my account on PyPI. In the management page, there is a &ldquo;remove&rdquo; button for delete this package.</p>

<pre><code>$ python setup.py register
</code></pre>

<h2>Create a source distribution</h2>

<pre><code>$ python setup.py sdist
</code></pre>

<p>This is create a tar.gz file under dist folder. If you like, copy that file to another host, unpacking it and install it with &ldquo;python setup.py install&rdquo;.</p>

<h2>Upload source distribution</h2>

<pre><code>$ python setup.py sdist upload
</code></pre>

<p>After modification of source codes and version number in setup.py (say, modify it to 0.2) run last command again to refresh distribution on PyPI. You can see it at &ldquo;<a href="https://pypi.python.org/simple/">https://pypi.python.org/simple/</a><app-name>/&rdquo;.</p>

<p>On another host, use &ldquo;pip install <app-name>==0.2&rdquo; to install this app, for example: &ldquo;pip install funniestlc==0.2&rdquo;.</p>

<h1>Publish in LAN</h1>

<h2>On the develop host</h2>

<ol>
<li><p>Edit source code;</p></li>
<li><p>Create new source code distribution package: <code>python setup.py install sdist</code>;</p></li>
</ol>


<h2>On the deploy host</h2>

<ol>
<li><p>Startup a virtual environment: <code>workon test</code>;</p></li>
<li><p>Write a install script:</p>

<p> #!/bin/bash
 scp lichao@10.21.2.7:/home/lichao/docs/python_projects/donno/dist/donno-0.1.10.tar.gz .
 tar zxvf donno-0.1.10.tar.gz
 cd donno-0.1.10
 python setup.py install
 cd ..</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/09/183148/">Note About Virturalenvwrapper</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-09T18:31:48+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>6:31 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Installation</h1>

<pre><code>$ sudo pip install virtualenvwrapper
</code></pre>

<p>Add following lines into ~/.zshrc:</p>

<pre><code>source /usr/local/bin/virtualenvwrapper.sh

export WORKON_HOME=~/apps/virenv_home

export PROJECT_HOME=~/docs/python_projects
</code></pre>

<h1>Usage</h1>

<p>There are two concepts in virturalenvwrapper. One is &ldquo;virtual environment&rdquo;, which has its own python executables. The other is &ldquo;project&rdquo;, where your source codes resides. They are n-to-n relationship.</p>

<p>&ldquo;mkvirtualenv env1&rdquo; will create a new &ldquo;virtual environment&rdquo; in $WORKON_HOME, regardless your CWD.</p>

<p>&ldquo;mkproject proj1&rdquo; will create both a &ldquo;virtual environment&rdquo; named &ldquo;proj1&rdquo; in $WORKON_HOME and a &ldquo;proj1&rdquo; folder in $PROJECT_HOME. Then go to $PROJECT_HOME/proj1, then activate the virtual environment proj1. So &ldquo;mkproject proj1&rdquo; equals to:</p>

<pre><code>$ mkvirtualenv proj1

$ mkdir $PROJECT_HOME/proj1

$ cd $PROJECT_HOME/proj1

$ workon proj1
</code></pre>

<p>Associate an existing virtualenv and an existing project with command</p>

<pre><code>$ setvirtualenvproject virtualenv_path project_path
</code></pre>

<p>Under the hood, virturalenvwrapper create a &ldquo;.project&rdquo; file under the root of the virtualenv, in which is the project path.</p>

<p>List site packages:</p>

<pre><code>$ lssitepackages
</code></pre>

<p>Run a command in all virtualenvs under WORKON_HOME:</p>

<pre><code>$ allvirtualenv command with arguments
</code></pre>

<p>Change the current working directory to the site-packages of current virtualenv($VIRTUAL_ENV):</p>

<pre><code>$ cdsitepackages
</code></pre>

<p>Remove virtualenv:</p>

<pre><code>$ rmvirtualenv &lt;env_name&gt;
</code></pre>

<h1>Verification</h1>

<p>In a virtualenv, all python executables are in $WORKON_HOME.</p>

<pre><code>[lichao@lichao480:~] 
% workon 
env1 
env2 
proj1 
[lichao@lichao480:~] 
% which python 
/usr/bin/python 
[lichao@lichao480:~] 
% workon env1 
(env1)[lichao@lichao480:~] 
% which python 
/home/lichao/apps/virenv_home/env1/bin/python 
(env1)[lichao@lichao480:~] 
% workon env2 
(env2)[lichao@lichao480:~PROJECT_HOME/proj2] 
% which python 
/home/lichao/apps/virenv_home/env2/bin/python
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/09/164727/">Write Groovy Codes Instead of Java</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-09T16:47:27+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:47 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Writing Java codes in terminal is a pain for tons of boilerplate. But sometimes you have to. So we can write groovy instead.</p>

<p>Origin Java codes (Convert.java):</p>

<pre><code>import java.io.BufferedReader; 
import java.io.FileReader; 
import java.io.IOException; 
import org.apache.commons.lang3.StringEscapeUtils; 
public class Convert { 
    public static void main(String[] args) throws IOException { 
        BufferedReader reader = new BufferedReader(new FileReader("target")); 
        String line = reader.readLine(); 
        System.out.println("file content: "+line); 
        String out = StringEscapeUtils.unescapeJava(line); 
        System.out.println("from string to char: " + out); 
        String out2 = StringEscapeUtils.escapeJava(out); 
        System.out.println("from char to string : " + out2); 
    } 
} 
</code></pre>

<p>$ javac -cp commons-lang3-3.2.1.jar:. Convert.java</p>

<p>$ java -cp commons-lang3-3.2.1.jar:. Convert</p>

<p>Corresponding Groovy codes (convert.groovy):</p>

<pre><code>import org.apache.commons.lang3.StringEscapeUtils 
def reader = new BufferedReader(new FileReader("target")) 
def line = reader.readLine() 
println "file content: $line" 
def out = StringEscapeUtils.unescapeJava(line) 
println "from string to char: $out" 
def out2 = StringEscapeUtils.escapeJava(out) 
println "from char to string: $out2" 
</code></pre>

<p>Run it: groovy -cp commons-lang3-3.2.1.jar convert.groovy</p>

<p>Key points to writing groovy codes:</p>

<ol>
<li><p>Dynamic type but with &ldquo;def&rdquo; (see &ldquo;<a href="http://stackoverflow.com/questions/184002/groovy-whats-the-purpose-of-def-in-def-x-0">http://stackoverflow.com/questions/184002/groovy-whats-the-purpose-of-def-in-def-x-0</a>&rdquo; for its reason);</p></li>
<li><p>No need to import Java built-in library;</p></li>
<li><p>No need to take care of the exceptions;</p></li>
<li><p>semi-colon at the end of line is optional;</p></li>
<li><p>Use &ldquo;println&rdquo; instead of &ldquo;System.out.println&hellip;&rdquo;;</p></li>
</ol>


<p>Ref:</p>

<p><a href="http://stackoverflow.com/questions/764416/why-would-one-use-groovy-over-java">http://stackoverflow.com/questions/764416/why-would-one-use-groovy-over-java</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/09/105408/">Python Development Workflow of Jeff</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-09T10:54:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:54 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Based on <a href="http://www.jeffknupp.com/blog/2013/08/16/open-sourcing-a-python-project-the-right-way/">http://www.jeffknupp.com/blog/2013/08/16/open-sourcing-a-python-project-the-right-way/</a></p>

<h1>Workflow</h1>

<p>The first release(v0.1): see Publish and Install Applications via PyPI for how to commit to PyPI;</p>

<p>After uploading your first release to PyPI, the basic workflow is:</p>

<ol>
<li><p>Do some work on your package (i.e. fix bugs, add features, etc);</p></li>
<li><p>Make sure the tests pass;</p></li>
<li><p>&ldquo;Freeze&rdquo; your code by creating a release branch in git-flow;</p></li>
<li><p>Update the <strong>version</strong> number in your package&rsquo;s <strong>init</strong>.py file;</p></li>
<li><p>Run &ldquo;python setup.py sdist upload&rdquo; to upload the new version of your package to PyPI;</p></li>
</ol>


<h1>git-flow</h1>

<h2>Installation git-flow-completion for zsh (Optional)</h2>

<p>Follow <a href="https://github.com/bobthecow/git-flow-completion;">https://github.com/bobthecow/git-flow-completion;</a></p>

<ol>
<li><p>Download <a href="http://sourceforge.net/p/zsh/code/ci/master/tree/Completion/Unix/Command/_git?format=raw">_git</a> and replace /usr/share/zsh/functions/Completion/Unix/_git;</p></li>
<li><p>Download <a href="https://raw2.github.com/bobthecow/git-flow-completion/master/git-flow-completion.zsh">git-flow-completion.zsh</a>, save it as ~/.git-flow-completion.zsh;</p></li>
<li><p>Add &ldquo;source ~/.git-flow-completion.zsh&rdquo; into ~/.zshrc;</p></li>
</ol>


<h2>Install git-flow and gitk on Mint 14</h2>

<pre><code>$ sudo apt-get install git-flow

$ sudo apt-get install gitk
</code></pre>

<h2>Usage</h2>

<p>The following paragraphs is from [Why aren&rsquo;t you using git-flow?}(<a href="http://jeffkreeftmeijer.com/2010/why-arent-you-using-git-flow/">http://jeffkreeftmeijer.com/2010/why-arent-you-using-git-flow/</a>).</p>

<p>Branch &ldquo;master&rdquo; is always &ldquo;production ready&rdquo; code. Commits are never made directly to master. Rather, code on master only gets there after a production release branch is created and &ldquo;finished&rdquo; (more on that in a sec). Thus the code on master is always able to be released to production. Also, master is always in a predictable state, so you never need to worry if master (and thus production) has changes one of your other branches doesn&rsquo;t.</p>

<p>&ldquo;develop&rdquo; is the branch you&rsquo;ll be doing most of your work off of; it&rsquo;s also the branch that represents the code to be deployed in the next release. feature branches represent non-trivial features and fixes that have not yet been deployed (a completed feature branch is merged back into develop). Updating master is done through the creation of a release.</p>

<p>Most of your work is done on the develop branch. This branch contains all of the completed features and bug fixes yet to be released; nightly builds or continuous integration servers should target develop, as it represents the code that will be included in the next release. For one-off commits, feel free to commit to develop directly.</p>

<pre><code>$ git flow init  // Convert an existing git repo to git-flow style:

$ git flow feature start &lt;feature-name&gt;

$ git commit -m "now finish this feature"

// if you want cancel this feature:
$ git checkout develop  // switch to "develop" branch
$ git branch  // list current branches
$ git branch -d feature/&lt;feature-name&gt;   // "feature/" is the default prefix of all feature branches
$ git branch  // verify the feature is deleted

$ git flow feature finish &lt;feature-name&gt;  // do not add "feature/" prefix before feature name
// This command merge feature branch back into develop branch, so the feature branch disappear from now on.
// If you don't want save your feature branch into remote repo, push to remote AFTER you finish your feature with this "finish" command.

$ git flow release start v0.1.0

$ git flow release finish v0.1.0
</code></pre>

<p><a href="http://danielkummer.github.io/git-flow-cheatsheet/">git-flow cheatsheet</a> is a excellent visual illustration of basic usage of git-flow.</p>

<h1>virtualenv and virtualenvwrapper</h1>

<p>See Note about virturalenvwrapper.</p>

<h1>Publish a Python Application</h1>

<p>Add a &ldquo;command_line.py&rdquo; in <project-name> module, and &ldquo;entry_points&rdquo; in setup.py. See the 4th step &ldquo;Command Line Scripts&rdquo; in <a href="http://www.scotttorborg.com/python-packaging/index.html">How To Package Your Python Code</a> for details.</p>

<h2>Necessary Files</h2>

<h3>setup.py</h3>

<p>Some necessary parameters:</p>

<ul>
<li><p>entry_points: for defind executables;</p></li>
<li><p>install_requires: for defining dependencies, get this from &ldquo;pip freeze&rdquo; command (exculde the application itself);</p></li>
</ul>


<h3>MANIFEST.in</h3>

<p>  Add &ldquo;inculde README.md&rdquo; (and other necessary files for installation) in this file, or README.md will note be packaged into installer, and in installation a &ldquo;README.md not found&rdquo; error raises because you read this file in setup.py.
  (see <a href="https://wiki.python.org/moin/Distutils/Tutorial">https://wiki.python.org/moin/Distutils/Tutorial</a> for explanation)</p>

<h2>All available classifiers</h2>

<pre><code>https://pypi.python.org/pypi?%3Aaction=list_classifiers
</code></pre>

<h2>Create requirements automatically</h2>

<pre><code>$ pip freeze &gt; requirements.txt
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/08/152300/">Create Executable Links in Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-08T15:23:00+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:23 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For example, as a common user we want to use application &ldquo;pandoc&rdquo; installed by root. We can achieve this by copy a soft link to /usr/bin.</p>

<pre><code># cd /usr/bin
# ln -s ~/.cabal/bin/pandoc
</code></pre>

<p>Now we can use &ldquo;pandoc&rdquo;. If it complains &ldquo;Permission Denied&rdquo;, use it with &ldquo;sudo&rdquo;.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/07/105230/">Write Markdown in Vim</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-07T10:52:30+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:52 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Markdown Plugin</h1>

<p>Use <a href="https://github.com/plasticboy/vim-markdown/blob/master/after/ftplugin/mkd.vim">plasticboy/vim-markdown</a>
This plugin enable markdown syntax highlighting, folding/unfolding and some navigation shortcuts.</p>

<h1>Frequently used shortcuts</h1>

<h2>Foldings</h2>

<p>zc: close one-level fold at cursor;
zo: open one-level fold at cursor;
zn: unfold all (n for none);
zm: fold all (m for more);
zj: go to the next fold;
zk: go to the previous fold;
[z: go to the start of the fold at cursor;
]z: go to the end of the fold at cursor;</p>

<h2>Markdown</h2>

<p>]]: go to next header;
[[: go to previous header;
]c: go to current header;
]u: go to parent header;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/04/105849/">Some Notetaking Softwares</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-04T10:58:49+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:58 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I install Springseed and NixNote on the black laptop (Linux MInt Cinnamon 15) and try them.</p>

<h1>Springseed</h1>

<p> The sparkling features include:</p>

<ul>
<li><p>It&rsquo;s open source;</p></li>
<li><p>Synchronize with Dropbox;</p></li>
<li><p>Supporting markdown syntax, and distinguishes &ldquo;Save&rdquo; and &ldquo;edit&rdquo; statuses. So It can preview the note.</p></li>
<li><p>Cool interface;</p></li>
</ul>


<p> But it&rsquo;s a GUI style app without keyboard shortcuts.</p>

<h1>NixNote</h1>

<p> NixNote is an open source Evernote client on Linux. It is more GUI style than Evernote Windows client. For example, it doesnot support ESC to close note window. It can be closed to system tray but you have to open it with mouse. Its interface is a little better than Evernote Windows client in wine.</p>

<p> These 2 app are all not the ideal solutions. I will keep on develop pynote.</p>

<p> # Everpad</p>

<p> It works on Mint Cinnamon 15. But it has no search function, and its synchronization is very slow (1 hour for 1000 notes).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/03/111321/">Run Shell Commands in Python</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-03T11:13:21+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>11:13 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>subprocess.call</h1>

<p>This is the recommended way to run shell commands in Python compared with old-fashioned os module.
This is a realtime method, which means you can get the shell output on the fly, compared with following &ldquo;subprocess.check_output&rdquo; method, which collect all output in its return value.
This method return the return value of the command, for example:</p>

<pre><code>ret = subprocess.call('ls -l')
</code></pre>

<p>where ret=0, while</p>

<pre><code>ret = subprocess.call('cd aaa')
</code></pre>

<p>ret=2 when there isn&rsquo;t &ldquo;aaa&rdquo; subfolder under CWD.</p>

<p>For ease of use, write a shorthand function:</p>

<pre><code>import subprocess
def run(cmd):
    ret = subprocess.call(cmd, shell=True)
    if ret != 0:
        sys.exit('Exec cmd %s error, return value: %s' %(cmd, str(ret)))
</code></pre>

<p>Then you can simply use &ldquo;run(cmd)&rdquo; as a shell interface. &ldquo;run&rdquo; print command stdout stderr to console stdout, and if there&rsquo;s something wrong during execution, we interrupt it.</p>

<h1>subprocess.check_output</h1>

<p>A more safe way to run shell command is using &ldquo;check_output&rdquo; function. If the return value if not 0, a exception raised, otherwise return the command output.</p>

<pre><code>$ cat myrun.py
import subprocess
def run(cmd):
    return subprocess.check_output(cmd, shell=True)
$ python -i myrun.py
&gt;&gt;&gt; ret = run('ls -l|grep donno')
&gt;&gt;&gt; ret
'drwxr-xr-x 6 chad chad 4096 Jan 26 18:18 donno-0.1.10\n-rw-r--r-- 1 chad chad 8716 Jan 27 15:53 donno-0.1.10.tar.gz\n'
&gt;&gt;&gt; ret = run('cd aaa')
/bin/sh: 1: cd: can't cd to aaa
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "shtest.py", line 3, in run
    return subprocess.check_output(cmd, shell=True)
  File "/usr/lib/python2.7/subprocess.py", line 544, in check_output
    raise CalledProcessError(retcode, cmd, output=output)
subprocess.CalledProcessError: Command 'cd aaa' returned non-zero exit status 2
</code></pre>

<h1>subprocess.Popen</h1>

<p>If you want some more powerful tools, use this. You can&rsquo;t use pipe directly in this form. Instead, You have to use subprocess.PIPE:</p>

<pre><code>&gt;&gt;&gt; import subprocess
&gt;&gt;&gt; lsres = subprocess.Popen(['ls','-l'], stdout=subprocess.PIPE)
&gt;&gt;&gt; grepres = subprocess.Popen(['grep', 'Do'], stdin=lsres.stdout, stdout=subprocess.PIPE)
&gt;&gt;&gt; res = grepres.communicate()
</code></pre>

<p>communicate() interact with process: Send data to stdin. Read data from stdout and stderr, until end-of-file is reached. Wait for process to terminate. It returns a tuple (stdoutdata, stderrdata).</p>

<h2>Full solution of running shell command</h2>

<p>If you want realtime output, while saving output and return code in variables, you should use Popen:</p>

<pre><code>from subprocess import Popen, PIPE, STDOUT
cmd = 'vmstat 2 3'
cmd2 = 'exit 3'

p = Popen(cmd, close_fds=True, shell=True, stdout=PIPE, stderr=STDOUT)

line = ''
while p.poll() is None:
    out = p.stdout.read(1)
    if out=='\n':
        print(line)
        line = ''
    else:
        line = line + out
print('--------\nret is: %d' % p.returncode)
</code></pre>

<p>The Popen.stdout is a file object, so its &ldquo;read(size)&rdquo; method here means read every 1 byte.
&ldquo;close_fds=True&rdquo; is maybe unnecessary, but I keep it for safe.</p>

<h1>os.system</h1>

<p>If it&rsquo;s unnecessary to save command output, this is most convenient way. The output will output to console. You can use space and pipe in command:</p>

<pre><code>&gt;&gt;&gt; import os 
&gt;&gt;&gt; ret = os.system('ls -l|grep D') 
</code></pre>

<p>And it will return after the command complete:</p>

<pre><code>&gt;&gt;&gt; ret = os.system('vmstat 3 3')
</code></pre>

<h1>os.popen</h1>

<p>Use this form if you want to save command output.</p>

<pre><code>&gt;&gt;&gt; retfile = os.popen('pwd')
&gt;&gt;&gt; ret = retfile.read() 
&gt;&gt;&gt; ret 
'/home/lichao\n' 
&gt;&gt;&gt; retfile 
&lt;open file 'pwd', mode 'r' at 0xb74aad30&gt;
</code></pre>

<p>or write it more compact:</p>

<pre><code>&gt;&gt;&gt; result = os.popen('ls|grep enex').read()
</code></pre>

<h2>Deprecated</h2>

<ul>
<li><p>commands.getoutput()</p></li>
<li><p>commands.getstatusoutput()</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/02/144055/">Search Available Package on Remote Repository</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-02T14:40:55+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>2:40 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>Debian-based distro</h1>

<p>First update your system cache:</p>

<pre><code>apt-get update
</code></pre>

<p>Then you can use one of the following ways to search available packages:</p>

<pre><code>apt-cache search &lt;package-name&gt;
</code></pre>

<p>There is only package names and simple descriptions.</p>

<pre><code>aptitude search &lt;package-name&gt;
</code></pre>

<p>The command provide more information than above one. The first character of the output indicate the package status on your host machine: &ldquo;i&rdquo; means installed, &ldquo;p&rdquo; otherwise. If the third character is &ldquo;A&rdquo; other than space, it means the package is auto installed.</p>

<p>Use &ldquo;aptitude why <package-name>&rdquo; to get the explanation of why the package should be installed on the system.</p>

<h1>RPM-based distro</h1>

<pre><code>yum list &lt;package-name&gt;
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/19">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/17">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/08/30/104928/">Docker Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/27/180124/">Spark Notes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/26/100107/">Build Redis on CentOS 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/24/110909/">Build Working Environment With I3 and Mint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/24/103023/">Install New Locale on Linux Mint</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
