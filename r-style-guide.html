<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="rlang, znbt, Tech, " />

<meta property="og:title" content="R Style Guide"/>
<meta property="og:url" content="http://leetschau.github.io/r-style-guide.html" />
<meta property="og:description" content="R Style Guide 综述 R 使用了 Java/C 基于大括号的自由编码风格，对不规范的编码格式容忍度较高。 但为了提高代码可读性，开发者仍然应遵守社区的最佳实践规范。 作为一种面向数据分析的编程语言，尽量使用 tidyverse 包实现应用功能， 配合使用 styler 和 lintr 做格式化检查工具。 命名规则 有效的命名风格： lowercase lower_case_with_underscores UPPERCASE UPPER_CASE_WITH_UNDERSCORES CapWords 文件 文件名使用 lower_case_with_underscores 风格，并以 R 作为扩展名： # Good fit_models.R utility_functions.R # Bad fit models.R foo.r stuff.r 语法 变量和函数名称 …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2019-07-15T15:13:08+08:00" />
<meta property="" content="2019-07-15T15:13:08+08:00" />
<meta name="twitter:title" content="R Style Guide">
<meta name="twitter:description" content="R Style Guide 综述 R 使用了 Java/C 基于大括号的自由编码风格，对不规范的编码格式容忍度较高。 但为了提高代码可读性，开发者仍然应遵守社区的最佳实践规范。 作为一种面向数据分析的编程语言，尽量使用 tidyverse 包实现应用功能， 配合使用 styler 和 lintr 做格式化检查工具。 命名规则 有效的命名风格： lowercase lower_case_with_underscores UPPERCASE UPPER_CASE_WITH_UNDERSCORES CapWords 文件 文件名使用 lower_case_with_underscores 风格，并以 R 作为扩展名： # Good fit_models.R utility_functions.R # Bad fit models.R foo.r stuff.r 语法 变量和函数名称 …">

        <title>R Style Guide · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://leetschau.github.io/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://leetschau.github.io">Home</a></li>
                            <li ><a href="http://leetschau.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://leetschau.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://leetschau.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://leetschau.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://leetschau.github.io/r-style-guide.html"> R Style Guide </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>R Style Guide</h1>
<h2>综述</h2>
<p>R 使用了 Java/C 基于大括号的自由编码风格，对不规范的编码格式容忍度较高。
但为了提高代码可读性，开发者仍然应遵守社区的最佳实践规范。</p>
<p>作为一种面向数据分析的编程语言，尽量使用 <a href="http://tidyverse.org/">tidyverse</a> 包实现应用功能，
配合使用 <a href="http://styler.r-lib.org/">styler</a> 和 <a href="https://github.com/jimhester/lintr">lintr</a>
做格式化检查工具。</p>
<h2>命名规则</h2>
<p>有效的命名风格：</p>
<ul>
<li>
<p>lowercase</p>
</li>
<li>
<p>lower_case_with_underscores</p>
</li>
<li>
<p>UPPERCASE</p>
</li>
<li>
<p>UPPER_CASE_WITH_UNDERSCORES</p>
</li>
<li>
<p>CapWords</p>
</li>
</ul>
<h2>文件</h2>
<p>文件名使用 lower_case_with_underscores 风格，并以 <em>R</em> 作为扩展名：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">fit_models</span><span class="p">.</span><span class="n">R</span>
<span class="n">utility_functions</span><span class="p">.</span><span class="n">R</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">fit</span> <span class="n">models</span><span class="p">.</span><span class="n">R</span>
<span class="n">foo</span><span class="p">.</span><span class="n">r</span>
<span class="n">stuff</span><span class="p">.</span><span class="n">r</span>
</code></pre></div>


<h2>语法</h2>
<h3>变量和函数名称</h3>
<p>变量和函数名使用 lower_case_with_underscores 风格，
变量一般为名词，函数一般为动词：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">day_one</span>
<span class="n">day_1</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">DayOne</span>
<span class="n">dayone</span>
</code></pre></div>


<p>不要使用 <code>.</code> 作为名称内部分隔符。</p>
<p>避免使用常用的函数名作为变量名，例如：</p>
<div class="highlight"><pre><span></span><code><span class="n">mean</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>


<h3>空格</h3>
<p>逗号前面不要有空格，后面保证有且只有一个空格：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">x</span><span class="p">[,</span> <span class="mi">1</span><span class="p">]</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">x</span><span class="p">[,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span><span class="p">[</span> <span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span><span class="p">[</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div>


<p>函数调用时，括号两侧不要有空格：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">na</span><span class="p">.</span><span class="n">rm</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">)</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">mean</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">na</span><span class="p">.</span><span class="n">rm</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">)</span>
<span class="n">mean</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">na</span><span class="p">.</span><span class="n">rm</span> <span class="o">=</span> <span class="k">TRUE</span> <span class="p">)</span>
</code></pre></div>


<p><code>if</code>, <code>for</code>, <code>while</code> 语句的括号两侧保留一个空格：</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="p">(</span><span class="n">debug</span><span class="p">)</span> <span class="err">{</span>
  <span class="k">show</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="err">}</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="err">{</span>
  <span class="k">show</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="err">}</span>
</code></pre></div>


<p>函数定义时，参数列表和函数体中间保留一个空值：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="err">{}</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="k">function</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="err">{}</span>
<span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="err">{}</span>
</code></pre></div>


<p>二元操作符两侧各保留一个空格：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Good</span>
<span class="n">height</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">feet</span> <span class="o">*</span> <span class="m">12</span><span class="p">)</span> <span class="o">+</span> <span class="n">inches</span>
<span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>

<span class="c1"># Bad</span>
<span class="n">height</span><span class="o">&lt;-</span><span class="n">feet</span><span class="o">*</span><span class="m">12</span><span class="o">+</span><span class="n">inches</span>
<span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="m">10</span><span class="p">)</span>
</code></pre></div>


<p>行尾不要留有空格。</p>
<h3>代码块</h3>
<p>R 的代码块书写规则：</p>
<ul>
<li>
<p>左大括号是一行代码的结尾字符，不要单起一行；</p>
</li>
<li>
<p>每层缩进使用两个空格；</p>
</li>
<li>
<p>右大括号单起一行，且只有这一个字符；</p>
</li>
</ul>
<p>示例：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Good</span>
<span class="nf">if </span><span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="n">debug</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">message</span><span class="p">(</span><span class="s">&quot;y is negative&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">if </span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
    <span class="nf">message</span><span class="p">(</span><span class="s">&quot;x is negative or zero&quot;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
  <span class="n">y</span><span class="o">^</span><span class="n">x</span>
<span class="p">}</span>

<span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;call1 returns an ordered factor&quot;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nf">expect_s3_class</span><span class="p">(</span><span class="nf">call1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;factor&quot;</span><span class="p">,</span> <span class="s">&quot;ordered&quot;</span><span class="p">))</span>
<span class="p">})</span>

<span class="nf">tryCatch</span><span class="p">(</span>
  <span class="p">{</span>
    <span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">scan</span><span class="p">()</span>
    <span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Total: &quot;</span><span class="p">,</span> <span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&quot;\n&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="n">interrupt</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">message</span><span class="p">(</span><span class="s">&quot;Aborted by user&quot;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Bad</span>
<span class="nf">if </span><span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="n">debug</span><span class="p">)</span> <span class="p">{</span>
<span class="nf">message</span><span class="p">(</span><span class="s">&quot;Y is negative&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">if </span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
  <span class="nf">message</span><span class="p">(</span><span class="s">&quot;x is negative or zero&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">else</span> <span class="p">{</span> <span class="n">y</span> <span class="o">^</span> <span class="n">x</span> <span class="p">}</span>
</code></pre></div>


<h3>折行</h3>
<p>每行长度原则不超过80个字符，如果一个函数调用太长，写成每行一个参数的形式：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">do_something_very_complicated</span><span class="p">(</span>
  <span class="n">something</span> <span class="o">=</span> <span class="ss">&quot;that&quot;</span><span class="p">,</span>
  <span class="n">requires</span> <span class="o">=</span> <span class="n">many</span><span class="p">,</span>
  <span class="n">arguments</span> <span class="o">=</span> <span class="ss">&quot;some of which may be long&quot;</span>
<span class="p">)</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">do_something_very_complicated</span><span class="p">(</span><span class="ss">&quot;that&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">many</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span>
                              <span class="ss">&quot;some of which may be long&quot;</span>
                              <span class="p">)</span>
</code></pre></div>


<h3>赋值</h3>
<p>使用 <code>&lt;-</code> 给变量赋值，不要使用 <code>=</code>：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Good</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="m">5</span>

<span class="c1"># Bad</span>
<span class="n">x</span> <span class="o">=</span> <span class="m">5</span>
</code></pre></div>


<h3>分号</h3>
<p>不要在语句之间和语句结尾使用分号。</p>
<h3>引号</h3>
<p>当文本内没有双引号时，使用双引号引用文本，否则使用单引号：</p>
<div class="highlight"><pre><span></span><code># Good
&quot;Text&quot;
&#39;Text with &quot;quotes&quot;&#39;
&#39;<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://style.tidyverse.org&quot;</span><span class="nt">&gt;</span>A link<span class="nt">&lt;/a&gt;</span>&#39;

# Bad
&#39;Text&#39;
&#39;Text with &quot;double&quot; and \&#39;single\&#39; quotes&#39;
</code></pre></div>


<h3>注释</h3>
<p>在数据分析代码中，使用注释重要的发现和分析结果。
如果需要通过注释表达代码的意图，尝试改写代码，尽量将意图体现在代码中。
如果某些 why 不能很好地以代码的形式表达，可以记录在注释中，但不要在注释中写 what 和 how。
如果注释比代码多，用 Rmarkdown 代替 R 脚本文件。</p>
<h2>函数返回</h2>
<p>只在提前返回时使用 <code>return()</code> 函数，否则使用 R 的“返回最后一个表达式”规则，不显式使用 <code>return()</code>：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Good</span>
<span class="n">find_abs</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">x</span> <span class="o">*</span> <span class="m">-1</span>
<span class="p">}</span>
<span class="n">add_two</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">}</span>

<span class="c1"># Bad</span>
<span class="n">add_two</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">return</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p><code>return()</code> 语句单独写一行：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Good</span>
<span class="n">find_abs</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">x</span> <span class="o">*</span> <span class="m">-1</span>
<span class="p">}</span>

<span class="c1"># Bad</span>
<span class="n">find_abs</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">x</span> <span class="o">*</span> <span class="m">-1</span>
<span class="p">}</span>
</code></pre></div>


<h2>管道操作符</h2>
<p>管道操作符左侧有一个空格，右侧是行尾，不要加空格，原则上每行一个管道操作：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">iris</span> <span class="o">%&gt;%</span>
  <span class="n">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">summarize_if</span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="nb">numeric</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">gather</span><span class="p">(</span><span class="n">measure</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="n">Species</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">arrange</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">iris</span> <span class="o">%&gt;%</span> <span class="n">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">summarize_all</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="n">ungroup</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">measure</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="n">Species</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="n">arrange</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>


<p>如果一个表达式中只有一个管道操作，且后续不存在扩展的可能，改成普通函数形式：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">arrange</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">Species</span><span class="p">)</span>

<span class="o">#</span> <span class="n">Bad</span> <span class="p">(</span><span class="k">when</span> <span class="k">no</span> <span class="n">plan</span> <span class="k">to</span> <span class="n">expand</span> <span class="n">it</span> <span class="n">later</span> <span class="k">on</span><span class="p">)</span>
<span class="n">iris</span> <span class="o">%&gt;%</span> 
  <span class="n">arrange</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span>
</code></pre></div>


<p>参与管道操作的函数如果没有参数，<code>magrittr</code> 允许不写括号，不要使用这一特性：</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Good</span>
<span class="n">x</span> <span class="o">%&gt;%</span> 
  <span class="k">unique</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">sort</span><span class="p">()</span>

<span class="o">#</span> <span class="n">Bad</span>
<span class="n">x</span> <span class="o">%&gt;%</span> 
  <span class="k">unique</span> <span class="o">%&gt;%</span>
  <span class="n">sort</span>
</code></pre></div>


<p>通过管道为变量赋值：</p>
<div class="highlight"><pre><span></span><code><span class="n">iris_long</span> <span class="o">&lt;-</span> <span class="n">iris</span> <span class="o">%&gt;%</span>
  <span class="nf">gather</span><span class="p">(</span><span class="n">measure</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="n">Species</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">arrange</span><span class="p">(</span><span class="o">-</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>


<p>不要使用 <code>%&lt;&gt;%</code> 操作符：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Good</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">x</span> <span class="o">%&gt;%</span> 
  <span class="nf">abs</span><span class="p">()</span> <span class="o">%&gt;%</span> 
  <span class="nf">sort</span><span class="p">()</span>

<span class="c1"># Bad</span>
<span class="n">x</span> <span class="o">%&lt;&gt;%</span>
  <span class="nf">abs</span><span class="p">()</span> <span class="o">%&gt;%</span> 
  <span class="nf">sort</span><span class="p">()</span>
</code></pre></div>


<h2>文档</h2>
<p>R 的 <a href="https://github.com/klutometis/roxygen">roxygen2</a> 类似于 Java 的 JavaDoc，
将代码中符合指定格式的代码注释转换为 HTML 格式文档。</p>
<h2>环境和依赖管理</h2>
<p>R 的 <a href="https://rstudio.github.io/packrat/">packrat</a> 大致相当于 Java 的 Maven 和 Python 的 pipenv。</p>
<p>最简工作流程：</p>
<div class="highlight"><pre><span></span><code><span class="err">library(packrat)</span>
<span class="err">init(&quot;~/docs/myproject&quot;)  # initialize project scaffold</span>
<span class="err">install.packages(&#39;rmarkdown&#39;)</span>
<span class="err">install.packages(&#39;tidyverse&#39;)</span>
<span class="err">status()</span>
<span class="err">snapshot()   # download package source code into packrat/src</span>
</code></pre></div>


<p><code>packrat/src</code> 目录下保存依赖库的源码压缩包，库版本保存在 <code>packrat/packrat.lock</code> 文件中，
配置信息保存在 <code>packrat/packrat.opts</code> 文件中。</p>
<p><code>packrat</code> 默认会把压缩的源码包提交到版本控制系统中，当在新环境中 clone 出这个代码库并用 RStudio 打开这个 R Project 时，
会自动在项目私有环境中安装 packrat，在 RStudio 中执行下面的命令重建环境：</p>
<div class="highlight"><pre><span></span><code><span class="err">library(packrat)</span>
<span class="err">status()  # optional</span>
<span class="err">restore()</span>
</code></pre></div>


<p>使用 <code>install.packages()</code> 安装新的依赖库后，
执行 <code>snapshot()</code> 会下载这些依赖库的源码压缩包到 <code>packrat/src</code> 目录下。
并更新 <code>packrat/packrat.lock</code> 文件。</p>
<p>如果当前环境中不包含所有被 snapshot 的 package，<code>status()</code> 会报告，
如果新安装的包还没有 snapshot，<code>status()</code> 不会报告。</p>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2019-07-15T15:13:08+08:00">Jul 15, 2019</time>

<h4>Last Updated</h4>
<time datetime="2019-07-15T15:13:08+08:00">Jul 15, 2019</time>

            <h4>Category</h4>
            <a class="category-link" href="http://leetschau.github.io/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://leetschau.github.io/tags.html#rlang-ref">rlang
                    <span>17</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#znbt-ref">znbt
                    <span>6</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>