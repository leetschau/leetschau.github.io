
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>用python发送各种形式的邮件 - Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="分别是发送纯文本邮件、html格式邮件，以及带附件的html格式邮件。纯文本邮件消息体是普通字符串，html格式邮件中消息体是MIMEText型对象，这种对象的特点是不能加附件；带附件的html格式邮件中消息体是MIMEMultipart型对象，正文和附件都用attach()方法添加。 代码如下（ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leetschau.github.io/blog/2011/01/12/153209/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">用python发送各种形式的邮件</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-01-12T15:32:09+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>3:32 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>分别是发送纯文本邮件、html格式邮件，以及带附件的html格式邮件。纯文本邮件消息体是普通字符串，html格式邮件中消息体是MIMEText型对象，这种对象的特点是不能加附件；带附件的html格式邮件中消息体是MIMEMultipart型对象，正文和附件都用attach()方法添加。</p>

<p>代码如下（红色字体部分是一个html格式文本的示例，可跳过不看）：</p>

<p> import smtplib</p>

<p> from email.mime.text import MIMEText</p>

<p> from email.mime.multipart import MIMEMultipart</p>

<p> if <strong>name</strong>==&lsquo;<strong>main</strong>&rsquo;:</p>

<p>  msg_body=&lsquo;&rsquo;&lsquo; &lt;!DOCTYPE HTML PUBLIC &ldquo;-//W3C//DTD HTML 4.01 Transitional//EN&rdquo;> <html xmlns:lxslt="http://xml.apache.org/xslt" xmlns:stringutils="xalan://org.apache.tools.ant.util.StringUtils"></p>

<p> <head></p>

<p> <META http-equiv="Content-Type" content="text/html; charset=US-ASCII"> <title>BVT Report</title> <style type="text/css"></p>

<p>  body {</p>

<p>   font:normal 68% verdana,arial,helvetica;</p>

<p>   color:#000000;</p>

<p>  }</p>

<p>  table tr td, table tr th {</p>

<p>   font-size: 68%;</p>

<p>  }</p>

<p>  table.details tr th{</p>

<p>   font-weight: bold;</p>

<p>   text-align:left;</p>

<p>   background:#a6caf0;</p>

<p>  }</p>

<p>  table.details tr td{</p>

<p>   background:#eeeee0;</p>

<p>  }</p>

<p>  p {</p>

<p>   line-height:1.5em;</p>

<p>   margin-top:0.5em; margin-bottom:1.0em;</p>

<p>  }</p>

<p>  h1 {</p>

<p>   margin: 0px 0px 5px; font: 165% verdana,arial,helvetica</p>

<p>  }</p>

<p>  h2 {</p>

<p>   margin-top: 1em; margin-bottom: 0.5em; font: bold 125% verdana,arial,helvetica</p>

<p>  }</p>

<p>  h3 {</p>

<p>   margin-bottom: 0.5em; font: bold 115% verdana,arial,helvetica</p>

<p>  }</p>

<p>  h4 {</p>

<p>   margin-bottom: 0.5em; font: bold 100% verdana,arial,helvetica</p>

<p>  }</p>

<p>  h5 {</p>

<p>   margin-bottom: 0.5em; font: bold 100% verdana,arial,helvetica</p>

<p>  }</p>

<p>  h6 {</p>

<p>   margin-bottom: 0.5em; font: bold 100% verdana,arial,helvetica</p>

<p>  }</p>

<p>  .Error {</p>

<p>   font-weight:bold; color:red;</p>

<p>  }</p>

<p>  .Failure {</p>

<p>   font-weight:bold; color:purple;</p>

<p>  }</p>

<p>  .Properties {</p>

<p>   text-align:right;</p>

<p>  }</p>

<p>  </style></p>

<p> </head></p>

<p> <body></p>

<p> <h1>Unit Test Results Summary</h1></p>

<p> <table class="details" border="0" cellpadding="5" cellspacing="2" width="95%"> <tr valign="top"> <th>Tests</th><th>Failures</th><th>Errors</th><th>Success rate</th><th>Time</th> </tr> <tr valign="top" class="Error"> <td>382</td><td>3</td><td>382</td><td>36.0466666667%</td><td>1.65</td></p>

<p> </tr></p>

<p> </table></p>

<p> <hr/></p>

<p> <h1>Diffcount Report</h1></p>

<p> <h2>GODU SERVER</h2></p>

<p> <table class="details" border="0" cellpadding="5" cellspacing="2" width="95%"> <tr valign="top"> <th>LANG</th><th>ADD</th><th>MOD</th><th>DEL</th><th>A&amp;M</th><th>BLK</th><th>CMT</th><th>NBNC</th><th>RATE</th></p>

<p> </tr></p>

<p> <tr valign="top" class="Error"><td>Java</td><td>52774</td><td>0</td><td>0</td><td>52774</td><td>5501</td><td>8036</td><td>39344</td><td>0.41</td></tr><tr valign="top" class="Error"><td>XML</td><td>399</td><td>0</td><td>0</td><td>399</td><td>0</td><td>0</td><td>399</td><td>0.12</td></tr></p>

<p> </table></p>

<p> <h2>GAPI</h2></p>

<p> <table class="details" border="0" cellpadding="5" cellspacing="2" width="95%"> <tr valign="top"> <th>LANG</th><th>ADD</th><th>MOD</th><th>DEL</th><th>A&amp;M</th><th>BLK</th><th>CMT</th><th>NBNC</th><th>RATE</th></p>

<p> </tr></p>

<p> <tr valign="top" class="Error"><td>Java</td><td>52774</td><td>0</td><td>0</td><td>52774</td><td>5501</td><td>8036</td><td>39344</td><td>0.41</td></tr><tr valign="top" class="Error"><td>XML</td><td>399</td><td>0</td><td>0</td><td>399</td><td>0</td><td>0</td><td>399</td><td>0.12</td></tr></p>

<p> </table></p>

<p> <h2>GODU WEB</h2></p>

<p> <table class="details" border="0" cellpadding="5" cellspacing="2" width="95%"> <tr valign="top"> <th>LANG</th><th>ADD</th><th>MOD</th><th>DEL</th><th>A&amp;M</th><th>BLK</th><th>CMT</th><th>NBNC</th><th>RATE</th></p>

<p> </tr></p>

<p> <tr valign="top" class="Error"><td>Java</td><td>52774</td><td>0</td><td>0</td><td>52774</td><td>5501</td><td>8036</td><td>39344</td><td>0.41</td></tr><tr valign="top" class="Error"><td>XML</td><td>399</td><td>0</td><td>0</td><td>399</td><td>0</td><td>0</td><td>399</td><td>0.12</td></tr></p>

<p> </table></p>

<p> </body></p>

<p> </html></p>

<p> &lsquo;&rsquo;'</p>

<p>  mail_server = smtplib.SMTP(&lsquo;124.127.106.5&rsquo;) # use &lsquo;smtp.163.com&rsquo; to send email with 163</p>

<p>  mail_server.set_debuglevel(1)</p>

<p>  mail_server.login(&lsquo;lichao1&rsquo;, &lsquo;abaqus67&rsquo;)</p>

<p>  #发送纯文本邮件</p>

<p>  #from_addr = &lsquo;LiChao<a href="&#109;&#97;&#x69;&#x6c;&#x74;&#111;&#x3a;&#108;&#105;&#99;&#104;&#97;&#111;&#49;&#x40;&#98;&#x6f;&#x63;&#x6f;&#x2e;&#99;&#x6f;&#109;&#46;&#x63;&#110;">&#108;&#105;&#x63;&#x68;&#x61;&#111;&#49;&#64;&#x62;&#x6f;&#x63;&#111;&#x2e;&#x63;&#111;&#x6d;&#x2e;&#x63;&#x6e;</a>&rsquo;</p>

<p>  #to_addr = &lsquo;LiChao<a href="&#109;&#x61;&#105;&#108;&#116;&#111;&#58;&#x6c;&#105;&#99;&#104;&#97;&#111;&#x31;&#64;&#98;&#111;&#99;&#111;&#46;&#x63;&#x6f;&#x6d;&#46;&#99;&#110;">&#108;&#x69;&#99;&#x68;&#97;&#111;&#49;&#64;&#98;&#111;&#99;&#111;&#46;&#x63;&#111;&#109;&#x2e;&#x63;&#x6e;</a>&rsquo;</p>

<p>  #subj = &lsquo;hello&rsquo;</p>

<p>  #date = datetime.datetime.now().strftime(&ldquo;%d/%m/%Y %H:%M&rdquo;)</p>

<p>  #msg = &ldquo;From: %s\nTo: %s\nSubject: %s\nDate: %s\n\n%s&rdquo; % (from_addr, to_addr, subj, date, message_body)</p>

<p>  #mail_server.sendmail(from_addr, to_addr, msg)</p>

<p>  #发送html格式邮件</p>

<p>  #msg = MIMEText (msg_body, &lsquo;html&rsquo;)</p>

<p>  #msg[&lsquo;From&rsquo;] = &lsquo;LiChao<a href="&#x6d;&#x61;&#x69;&#x6c;&#x74;&#111;&#x3a;&#108;&#x69;&#x63;&#104;&#97;&#x6f;&#x31;&#64;&#x62;&#x6f;&#99;&#x6f;&#x2e;&#x63;&#111;&#109;&#x2e;&#99;&#x6e;">&#108;&#105;&#99;&#x68;&#97;&#111;&#49;&#x40;&#x62;&#x6f;&#x63;&#111;&#x2e;&#x63;&#x6f;&#x6d;&#x2e;&#x63;&#110;</a>&rsquo;</p>

<p>  #msg[&lsquo;To&rsquo;] = &lsquo;LiChao<a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#111;&#58;&#x6c;&#105;&#99;&#x68;&#x61;&#111;&#49;&#64;&#x62;&#111;&#99;&#x6f;&#x2e;&#x63;&#111;&#x6d;&#46;&#x63;&#110;">&#x6c;&#105;&#x63;&#104;&#97;&#111;&#49;&#x40;&#x62;&#111;&#x63;&#111;&#x2e;&#99;&#111;&#x6d;&#x2e;&#99;&#x6e;</a>&rsquo;</p>

<p>  #msg[&lsquo;Subject&rsquo;] = &lsquo;hello&rsquo;</p>

<p>  #mail_server.sendmail(&lsquo;LiChao<a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#111;&#x3a;&#108;&#x69;&#x63;&#x68;&#x61;&#111;&#x31;&#64;&#x62;&#x6f;&#99;&#x6f;&#46;&#99;&#x6f;&#x6d;&#46;&#x63;&#x6e;">&#108;&#105;&#x63;&#104;&#x61;&#111;&#x31;&#64;&#98;&#x6f;&#99;&#x6f;&#x2e;&#99;&#111;&#109;&#x2e;&#99;&#x6e;</a>&rsquo;, &lsquo;LiChao<a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#58;&#108;&#x69;&#99;&#x68;&#x61;&#111;&#x31;&#64;&#98;&#111;&#99;&#x6f;&#46;&#99;&#111;&#x6d;&#x2e;&#x63;&#x6e;">&#x6c;&#x69;&#99;&#104;&#97;&#111;&#x31;&#64;&#x62;&#111;&#99;&#x6f;&#x2e;&#99;&#111;&#109;&#x2e;&#99;&#110;</a>&rsquo;, msg.as_string())</p>

<p>  #发送带附件的html格式邮件</p>

<p>  msg = MIMEMultipart ()</p>

<p>  part2 = MIMEText(msg_body, &lsquo;html&rsquo;)</p>

<p>  msg. attach (part2)</p>

<p>  att = MIMEText(open(&lsquo;e:\BVT\GODU-BVT\GCIF\build\2011-01-12\GAPI\build\result\junit\junit-noframes.html&rsquo;, &lsquo;rt&rsquo;).read())</p>

<p>  att[&ldquo;Content-Type&rdquo;] = &lsquo;application/octet-stream&rsquo;</p>

<p>  att[&ldquo;Content-Disposition&rdquo;] = &lsquo;attachment; filename=&ldquo;JUnitReport.html&rdquo;&rsquo;</p>

<p>  msg. attach (att)</p>

<p>  msg[&lsquo;From&rsquo;] = &lsquo;LiChao<a href="&#x6d;&#x61;&#105;&#x6c;&#116;&#x6f;&#58;&#x6c;&#105;&#x63;&#104;&#x61;&#x6f;&#49;&#x40;&#x62;&#111;&#99;&#111;&#x2e;&#x63;&#x6f;&#x6d;&#46;&#99;&#x6e;">&#108;&#105;&#99;&#x68;&#97;&#x6f;&#49;&#x40;&#x62;&#111;&#99;&#x6f;&#x2e;&#99;&#111;&#109;&#x2e;&#x63;&#110;</a>&rsquo;</p>

<p>  msg[&lsquo;To&rsquo;] = &lsquo;LiChao<a href="&#109;&#97;&#105;&#108;&#x74;&#x6f;&#x3a;&#108;&#x69;&#99;&#104;&#97;&#111;&#49;&#x40;&#x62;&#x6f;&#99;&#x6f;&#46;&#x63;&#111;&#109;&#46;&#x63;&#110;">&#x6c;&#x69;&#x63;&#104;&#x61;&#x6f;&#x31;&#64;&#98;&#111;&#x63;&#x6f;&#46;&#99;&#x6f;&#109;&#x2e;&#99;&#110;</a>&rsquo;</p>

<p>  msg[&lsquo;Subject&rsquo;] = &lsquo;hello&rsquo;</p>

<p>  mail_server.sendmail(&lsquo;LiChao<a href="&#109;&#x61;&#x69;&#108;&#x74;&#x6f;&#58;&#x6c;&#x69;&#99;&#104;&#x61;&#x6f;&#49;&#64;&#98;&#x6f;&#99;&#x6f;&#x2e;&#99;&#x6f;&#x6d;&#x2e;&#x63;&#x6e;">&#x6c;&#x69;&#99;&#x68;&#x61;&#111;&#49;&#x40;&#x62;&#x6f;&#99;&#x6f;&#46;&#99;&#x6f;&#x6d;&#x2e;&#x63;&#x6e;</a>&rsquo;, &lsquo;LiChao<a href="&#109;&#x61;&#105;&#108;&#116;&#111;&#58;&#x6c;&#x69;&#x63;&#104;&#97;&#111;&#x31;&#x40;&#x62;&#111;&#x63;&#111;&#x2e;&#99;&#x6f;&#109;&#x2e;&#99;&#110;">&#x6c;&#x69;&#x63;&#104;&#97;&#x6f;&#x31;&#64;&#x62;&#x6f;&#99;&#x6f;&#46;&#x63;&#x6f;&#109;&#46;&#x63;&#x6e;</a>&rsquo;, msg.as_string())</p>

<p>  mail_server.quit()</p>

<p> 注意：sendmail()发送邮件时，如果收件人有多个，必须放在一个list中作为参数，如果是字符串，则只发给第一个人，似乎只有python2.6要求是list型参数。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Li Chao</span></span>

      




<time class='entry-date' datetime='2011-01-12T15:32:09+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2011</span></span> <span class='time'>3:32 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/html/'>html</a>, <a class='category' href='/blog/categories/mime/'>mime</a>, <a class='category' href='/blog/categories/python/'>python</a>, <a class='category' href='/blog/categories/smtp/'>smtp</a>, <a class='category' href='/blog/categories/you-jian/'>邮件</a>, <a class='category' href='/blog/categories/fu-jian/'>附件</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://leetschau.github.io/blog/2011/01/12/153209/" data-via="" data-counturl="http://leetschau.github.io/blog/2011/01/12/153209/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/01/11/100823/" title="Previous Post: 用lxml模块解析JUnit生成的测试报告">&laquo; 用lxml模块解析JUnit生成的测试报告</a>
      
      
        <a class="basic-alignment right" href="/blog/2011/01/13/152557/" title="Next Post: python的ConfigParser模块使用方法">python的ConfigParser模块使用方法 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/10/05/131004/">Meteor Development Environment on Windows</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/05/110947/">Use Git in Vim With Fugitive</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/03/095227/">A Meteor Package Test Demo</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/01/202107/">Notes of Learn You a Haskell for Great Good</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/29/121847/">Meteor Test With Velocity and Jasmine</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
