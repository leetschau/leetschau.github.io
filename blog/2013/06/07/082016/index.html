
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Install Postgresql Database for Sonar - Dark Matter in Cyberspace</title>
  <meta name="author" content="Li Chao">

  
  <meta name="description" content="Setup Postgresql Server Use &ldquo;cross distribution packages&rdquo; postgres_9.2.4-1.i386.openscg.deb and install it on Mint 14. This kind of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
<<<<<<< HEAD
  <link rel="canonical" href="http://leetschau.github.io/blog/2013/06/07/082016/">
=======
  <link rel="canonical" href="http://leetschau.github.io/blog/2013/06/07/082016">
>>>>>>> 07ed3639e773b839d5491a4f5cd36dc20296d73c
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dark Matter in Cyberspace" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<<<<<<< HEAD
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
=======
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
>>>>>>> 07ed3639e773b839d5491a4f5cd36dc20296d73c
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dark Matter in Cyberspace</a></h1>
  
<<<<<<< HEAD
    <h2>A notes repository for Meteor.js, data mining, Linux, etc.</h2>
=======
    <h2>A note repository aims at Data Mining, Spark, Linux, Python.</h2>
>>>>>>> 07ed3639e773b839d5491a4f5cd36dc20296d73c
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
<<<<<<< HEAD
    <input type="hidden" name="sitesearch" value="leetschau.github.io">
=======
    <input type="hidden" name="q" value="site:leetschau.github.io" />
>>>>>>> 07ed3639e773b839d5491a4f5cd36dc20296d73c
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Install Postgresql Database for Sonar</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-06-07T08:20:16+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:20 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><h1>Setup Postgresql Server</h1>

<p>Use &ldquo;cross distribution packages&rdquo; postgres_9.2.4-1.i386.openscg.deb and install it on Mint 14. This kind of installer can be installed without GUI environment, suitable for Ubuntu Server. Installer of Postgresql is much smaller than its mysql counterpart.</p>

<p>You can follow <a href="http://wiki.openscg.com/index.php/Postgres_9.1_DEB">the instructions at OpenSCG</a> to setup server and manipulate data.</p>

<ol>
<li><p>Download &ldquo;cross distribution packages&rdquo; postgres_9.2.4-1.i386.openscg.deb;</p></li>
<li><p>install it with <code>dpkg -i</code>;</p></li>
<li><p>start service: <code>/etc/init.d/postgres-9.2-openscg start</code>;</p></li>
<li><p>verify service: <code>invoke-rc.d postgres-9.2-openscg status</code>, and <code>su postgres</code> to verify if user postgres has been created;</p></li>
<li><p><code>. /opt/postgres/9.2/pg92-openscg.env</code></p></li>
<li><p>verify connection: <code>psql</code>, then you can see the postgresql prompt &ldquo;postgres=#&rdquo;, use &ldquo;\l&rdquo; to list all databases;</p></li>
</ol>


<h1>Setup Connection between Sonar and Postgresql database</h1>

<ol>
<li><p>build sonar database in Postgresql</p>

<ol type="a">
<li>create user sonar: <code>postgres=# create user sonar with password 'sonar';</code>, notice you must &ldquo;;&rdquo; at end of command,</li>
<li>verify: <code>postgres=# \du</code>;</li>
<li>create database: <code>postgres-# create database sonar with owner sonar encoding 'UTF8';</code></li>
<li>verify: <code>postgres=# \l</code>;</li>
</ol>
</li>
<li><p>modify sonar jdbc url: modify &ldquo;sonar.jdbc.url&rdquo; as &ldquo;jdbc:postgresql://localhost/sonar&rdquo; in file $SONAR_HOME/conf/sonar.properties (remember comment out default h2 jdbc url);</p></li>
<li><p>start sonar server: <code>$SONAR_HOME/bin/sonar.sh console</code>;</p></li>
<li><p>verify: <code>psql -h localhost -d sonar -U sonar</code>, then <code>sonar=&gt; select table_name from information_schema.tables where table_schema='public';</code>, you can see &ldquo;49 rows&rdquo; at the bottom of the output;</p></li>
</ol>


<p>Note 2: When upgrade or reinstall SonarQube, and after modifying configuration file, you have to goto <a href="http://10.0.2.74:9000/setup">http://10.0.2.74:9000/setup</a> to upgrade database manually, or you will see &ldquo;sonar is under maintenance. please check back later&rdquo;.</p>

<h1>Enable Remote Access to Postgresql Server(unnecessary for Sonar)</h1>

<p>(updated at 2013.12.23: The following operation is very <strong>dangerous</strong> and not preferred.</p>

<p>Ref: <a href="http://serverfault.com/questions/110154/whats-the-default-superuser-username-password-for-postgres-after-a-new-install/325596#325596">http://serverfault.com/questions/110154/whats-the-default-superuser-username-password-for-postgres-after-a-new-install/325596#325596</a></p>

<ol>
<li><p>setup password for user postgres: <code>sudo passwd postgres</code>;</p></li>
<li><p>login as postgres: <code>su postgres</code> (the $HOME on Ubuntu should be /etc/postgres/9.2);</p></li>
<li><p>add a line in data/pg_hba.conf: &ldquo;host all all 0.0.0.0/0 md5&rdquo;;</p></li>
<li><p>modify listen_addresses=&ldquo;127.0.0.1&rdquo; to &ldquo;*&rdquo; in data/postgresql.conf;</p></li>
<li><p>verify(on client machine): <code>psql -h 10.21.3.31 -U postgres -d postgres</code> (-U means username, -d means database);</p></li>
</ol>


<p>or use squirrel-sql client: download driver jar postgresql-9.2-1002.jdbc4.jar at jdbc.postgresql.org and copy to $SQUIRREL_HOME/lib, start squirrel-sql, create a connection with url=&ldquo;jdbc:postgresql://10.21.3.31/postgres&rdquo;, username=&ldquo;postgres&rdquo; and password=&ldquo;&hellip;&rdquo;;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Li Chao</span></span>

      




<time class='entry-date' datetime='2013-06-07T08:20:16+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:20 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/postgresql/'>postgresql</a>, <a class='category' href='/blog/categories/ubuntu-server/'>ubuntu server</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://leetschau.github.io/blog/2013/06/07/082016/" data-via="" data-counturl="http://leetschau.github.io/blog/2013/06/07/082016/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/06/06/201203/" title="Previous Post: Reuse Sonar Checkstyle Violation Report for Custom Data Analysis">&laquo; Reuse Sonar Checkstyle Violation Report for Custom Data Analysis</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/06/07/101540/" title="Next Post: Package Repository for Ubuntu Offline Installation">Package Repository for Ubuntu Offline Installation &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
<<<<<<< HEAD
        <a href="/blog/2015/05/28/102822/">Penetrate GFW With Sshuttle</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/27/180718/">Store Small Images in MongoDB via Base64</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/26/174257/">Meteor基础知识之系统篇</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/15/142023/">Run MongoDB Server on Docker in VPS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/091733/">Git初体验</a>
=======
        <a href="/blog/2015/05/26/174257/">Meteor基础知识之系统篇</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/15/142023/">Run MongoDB Server on Docker in VPS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/091733/">Git初体验</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/08/155132/">Run Mongo Scripts in Shell</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/07/151147/">Find Verified User in MongoDB</a>
>>>>>>> 07ed3639e773b839d5491a4f5cd36dc20296d73c
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leetschau">@leetschau</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leetschau',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Li Chao -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
