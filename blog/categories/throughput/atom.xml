<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Throughput | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/throughput/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2015-08-05T17:36:08+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[网络流量监控工具]]></title>
    <link href="http://leetschau.github.io/blog/2013/02/21/175453/"/>
    <updated>2013-02-21T17:54:53+08:00</updated>
    <id>http://leetschau.github.io/blog/2013/02/21/175453</id>
    <content type="html"><![CDATA[<p>2014-7-14更新：</p>

<ul>
<li><p>nethogs: 按进程查看流量占用</p></li>
<li><p>iptraf: 按连接/端口查看流量</p></li>
<li><p>ifstat: 按设备查看流量</p></li>
<li><p>ethtool: 诊断工具</p></li>
<li><p>tcpdump: 抓包工具</p></li>
</ul>


<hr />

<p>2014-8-25更新：</p>

<p>iptraf-ng用于监测网络流量很好用，在ArchLinux和Mint中可以直接安装。
其中的"Ip traffic monitor"可以监测网卡的实时接收/发送 (RX/TX) 数据，可以显示对端IP地址和端口，本方接收IP地址和端口，但不能显示实时传输速率，
&ldquo;General interface statistics&rdquo; 可以显示所有网卡实时发送/接收数据的速率，但不能显示对端IP和端口，二者互为补充。
今天测试在同一网段中的两台机器之间用scp传送大文件，速率稳定在99MB/s，比较靠谱的一个结果，间接说明scp传大文件可以用来检测网络的最大传输速率。</p>

<p>Ref: <a href="http://www.tecmint.com/command-line-tools-to-monitor-linux-performance/">20 Command Line Tools to Monitor Linux Performance</a></p>

<hr />

<p>参考：<a href="http://www.dynacont.net/documentation/linux/network_monitoring/">Bandwidth Monitoring Tools For Linux</a></p>

<h1>实时流量监控：pv</h1>

<p>OS: Ubuntu Server 12.04.</p>

<h2>netcat &amp; pv</h2>

<p>apt-get install pv</p>

<p>监控端口5555上的实时网络流量：</p>

<pre><code>nc -l 5555 | pv &gt; /dev/null
</code></pre>

<p>向服务器113上发送数据：</p>

<pre><code>nc 10.31.1.113 5555
</code></pre>

<h1>ifstat</h1>

<p>Homepage: <a href="http://gael.roualland.free.fr/ifstat/">http://gael.roualland.free.fr/ifstat/</a></p>

<h2>使用</h2>

<pre><code>ifstat -i eth0 1 5 // 监测网口eth0的流量，每一秒测试一次，共测试5次
</code></pre>

<p>该工具不需要root权限</p>

<h2>安装</h2>

<p>Ubuntu可以用apt-get直接装，官网上的ifstat-1.1.tar.gz包是源码包，在RedHat上安装需要编译，过程很简单，根据INSTALL文档的说明：</p>

<pre><code>./configure
make
make install
</code></pre>

<h2>atsar</h2>

<p>atsar（Unix的sar指令的Linux移植版，可以用apt-get安装）也有几个选项是用来监控网络情况的，例如每隔2秒显示一次系统当前TCP流量：</p>

<pre><code>atsar -t 2 5
</code></pre>

<h2>iftop</h2>

<p>Ubuntu: apt-get install iftop.</p>

<p>监控与47的交互：</p>

<pre><code>iftop -n -i eth0 -f "host 10.0.2.47" // 监测47与113的双向传输数据
iftop -n -i eth0 -f "src 10.0.2.47" // 只监测47流向113的数据
</code></pre>

<p>目前看来iftop显示的信息最全，但需要好好看手册，每个值都是什么意思；使用它需要root权限；</p>

<p>参考：<a href="https://sickbits.net/iftop-finding-traffic-hogs/">https://sickbits.net/iftop-finding-traffic-hogs/</a></p>

<h2>trafshow</h2>

<p>Ubuntu: apt-get install trafshow</p>

<p>监控与47的交互：<code>trafshow -n -i eth0 host 10.0.2.47</code>;</p>

<h1>网络带宽测试：iperf</h1>

<p>又叫bandwidth或者throughput测试，用来测试Server和Client间的最大传输速率。</p>

<p>iperf是命令行工具，还有一个基于Java的图形界面<a href="https://code.google.com/p/xjperf/">jperf</a>可运行在Windows和linux上；</p>

<p>安装：Ubuntu用apt-get install iperf安装，Redhat需要在"<a href="http://pkgs.repoforge.org/iperf/">http://pkgs.repoforge.org/iperf/</a>&ldquo;上根据操作系统的版本和架构选择一个rpm下载（47服务器系统为Redhat 5.4, x86_64，下载的是iperf-2.0.4-1.el5.rf.x86_64.rpm），然后用rpm -ivh <file_name>安装；</p>

<h2>用法</h2>

<ol>
<li><p>启动服务端：iperf -s；</p></li>
<li><p>启动客户端：iperf -c 10.0.2.47 -i 1 -f M（-c后面跟服务器IP地址，-i表示发送的时间间隔，-f M表示返回结果以MByte为单位）；</p></li>
</ol>


<p>或者启动图像客户端jperf，点击"Run IPerf"按钮就可以测网络带宽了。给出的结果是笔记本电脑与113服务器之间单向单流（1 stream）带宽为1.8MB/s左右；</p>

<p>iperf作为客户端还有两个比较有用的选项分别是-d和-d -r，前者表示测试同时双向传输的速率，后者表示先进行client to server的单向传输测试，完毕后互换角色，反过来进行server to client的单向传输测试，过程如下：</p>

<p>server: iperf -s</p>

<p>client: iperf -c 10.0.2.47 -i 1 -f M -d（或者iperf -c 10.0.2.47 -i 1 -f M -d -r）</p>

<p>参考：</p>

<p><a href="http://www.smallnetbuilder.com/lanwan/lanwan-howto/30408-measuring-network-performance-jperf">http://www.smallnetbuilder.com/lanwan/lanwan-howto/30408-measuring-network-performance-jperf</a></p>

<p><a href="http://openmaniak.com/iperf.php">http://openmaniak.com/iperf.php</a></p>
]]></content>
  </entry>
  
</feed>
