<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ipython | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/ipython/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2016-02-21T11:06:40+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Debug Python Script]]></title>
    <link href="http://leetschau.github.io/blog/2016/02/16/212514/"/>
    <updated>2016-02-16T21:25:14+08:00</updated>
    <id>http://leetschau.github.io/blog/2016/02/16/212514</id>
    <content type="html"><![CDATA[<p>Now I want to dubug a script named <code>filteringdata.py</code>.</p>

<h1>PyCharm Community Edition</h1>

<p>It&rsquo;s editor (with IdeaVim plugin), linter and debugger is
the most powerful and verbose in the 3 candidates.</p>

<p>Add the following lines into ~/.ideavimrc to swap colon and semicolon:</p>

<pre><code>nnoremap ; :
nnoremap : ;
vnoremap ; :
vnoremap : ;
</code></pre>

<h1>pudb</h1>

<p>Comparing with ipdb, pudb needn&rsquo;t add stub in source sccript.</p>

<p>sudo pip install pudb
sudo chown -R leo:leo ~/.config/pudb</p>

<p>pudb filteringdata.py</p>

<p>Use <code>?</code> to list all available commands.</p>

<h1>ipdb</h1>

<p>There are totally 3 steps when debugging a Python script with
ipdb module: install, insert stubs in source codes and debug.</p>

<p>First install with <code>sudo pip install ipdb</code>.</p>

<p>Then add <code>from ipdb import set_trace</code> at the head into the script,
and add <code>set_trace()</code> at the first place you want the dubugger to stop.</p>

<p>Finally start a shell and run:</p>

<pre><code>$ ipython
...
IPython 4.0.1 ...
...
In [1]: %run filteringdata.py
&gt; /home/leo/docs/playground/pg2dm-python/ch2/filteringdata.py(53)recommend()
     52     # first find nearest neighbor
---&gt; 53     nearest = computeNearestNeighbor(username, users)[0][1]
     54 

ipdb&gt; h
</code></pre>

<p>Frequently used commands include:</p>

<pre><code>a: print args of current function;
b: set or list break points;
c: continue to next break points;
n: next;
s: step;
p &amp; pp: evaluate and print value of an expression;
pp locals(): pretty-print all local variables;
q: quit;
</code></pre>

<p>Use <code>h a</code> to see the help information about command <code>a</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Python Interactive Development Workflow]]></title>
    <link href="http://leetschau.github.io/blog/2013/11/20/092952/"/>
    <updated>2013-11-20T09:29:52+08:00</updated>
    <id>http://leetschau.github.io/blog/2013/11/20/092952</id>
    <content type="html"><![CDATA[<p>The key of interactive programming is &ldquo;declarative programming&rdquo;,
which can be expressed as following principles:</p>

<ol>
<li><p>Try to write all business logic in functions or classes,
instead of procedures;</p></li>
<li><p>Express the result as return values of functions,
instead of printing them to console;</p></li>
</ol>


<p>Then you store these functions or classes in your files.
Then you start the REPL shell, load your function file, declare your inputs,
run your functions with the inputs, evaluate the output;
modify the function in file, reload your file in shell,
run your functions again, reevaluate the output,
continue this loop, until you get the expected output.</p>

<p>Between these loops, you have 2 window: an editor and a shell,
the former for write &ldquo;real&rdquo; production code,
the latter for loading file and doing some experiments,
while switching between them with Alt-Tab. You only declare inputs once.
Using shortcuts (Ctrl-p) to reload function file and re-test your function.
So the loop will be very fast,
and you can concentrate on the business logic itself.</p>

<p>emacs-for-python and IPython are the preferred editor and shell,
both have powerful code completion functionality.</p>

<h1>Linux Shell</h1>

<p>Save some fundamental functions in a python file, say &ldquo;myfunc.py&rdquo;.
Then use &ldquo;python -i myfunc.py&rdquo; to load all functions in myfunc.py
and enter interactive shell.</p>

<h1>Python Console</h1>

<p>&ldquo;execfile(&lsquo;filename.py&rsquo;)&rdquo; to load (or reload) file;</p>

<p>&ldquo;dir()&rdquo; to list all variables;</p>

<p>&ldquo;del(variable)&rdquo; to clear a variable;</p>

<p>C-p, C-n to traverse in command history;</p>

<h1>IPython</h1>

<p>Tab autocompletion is awesome in ipython.</p>

<h2>Installation</h2>

<pre><code>sudo apt-get install ipython-notebook
</code></pre>

<h2>Command history traverse and back reference</h2>

<p>History inputs: all in dictionary &ldquo;In&rdquo;, use &ldquo;%hist -n&rdquo; list all previous command;</p>

<p>Output: all in dictionary &ldquo;Out&rdquo;, <em>1, </em>2, &hellip;</p>

<p>C-p, C-n, %rep <command_num></p>

<p>While all shortcuts supported by bash are available in IPython
(See Command Line Shortcuts in Linux Shell for details).</p>

<h2>Command</h2>

<p>To line magic command, &ldquo;%&rdquo; can be omitted.</p>

<p>%pwd: pwd</p>

<p>!<cmd>: run shell command;</p>

<p>%run <file_name>: equals to &ldquo;execfile()&rdquo; in standard python shell;</p>

<p>%reset: clear all user defined variables;</p>

<p>%pycat <file_name>: show file content with syntax coloring;</p>

<p>%edit <file_name>: edit file;</p>

<p>%pdb or %run -d <file_name>: debug file;</p>

<h2>log utility</h2>

<p>%logstate: get the current state of log: on/off</p>

<p>%logstart -o <file_name></p>

<p>%logstop</p>

<h1>Emacs</h1>

<p><a href="https://github.com/gabrielelanaro/emacs-for-python">emacs-for-python</a></p>

<h1>Difference between &ldquo;import&rdquo; and &ldquo;run&rdquo;</h1>

<p>You can put some code after</p>

<pre><code>if __name__ == '__main__':
</code></pre>

<p>in a python file &ldquo;test.py&rdquo;.
Then if you want run these codes, use &ldquo;run test.py&rdquo;
in ipython or &ldquo;execfile(&lsquo;test.py&rsquo;)&rdquo; in python shell.
If you don&rsquo;t want to run these code, use &ldquo;import test&rdquo;.
But this is not a best practice. Try to put all things in functions and classes.</p>
]]></content>
  </entry>
  
</feed>
