<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Decoding | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/decoding/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2016-04-09T20:50:36+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Apache Commons-io的字符串编解码问题]]></title>
    <link href="http://leetschau.github.io/blog/2012/05/28/100022/"/>
    <updated>2012-05-28T10:00:22+08:00</updated>
    <id>http://leetschau.github.io/blog/2012/05/28/100022</id>
    <content type="html"><![CDATA[<p>用Apache org.apache.commons.io.input.Tailer监控日志文件变化很方便，但如果文件中有中文，回调函数TailerListener.handle中参数line是乱码，原因是目前的Tailer是按“西欧语言”（ISO8859-1）对日志文件进行解码的，而日志文件一般是用GBK或者UTF-8编码。解决方法是对line用ISO8859-1再进行一次编码得到原始的字节数组，然后用日志文件的格式进行解码，这样最终得到的字符串就OK了。实现方法如下：</p>

<p>服务类：</p>

<p> &hellip;</p>

<p> LogMonitorListener lml = new LogMonitorListener();</p>

<p> Tailer lmt = new Tailer(logfile, lml, 3000);</p>

<p> &hellip;</p>

<p> lmt.run();</p>

<p>监听器类：</p>

<p>public class LogMonitorListener extends TailerListenerAdapter {</p>

<p> &hellip;</p>

<p> @Override</p>

<p> public void handle(String line) {</p>

<p>  msg = new String(line.getBytes(&ldquo;ISO8859-1&rdquo;), &ldquo;GBK&rdquo;) ; //用来处理GBK格式的日志</p>

<p>   msg = new String(line.getBytes(&ldquo;ISO8859-1&rdquo;), &ldquo;UTF-8&rdquo;) ; //用来处理UTF-8格式的日志</p>

<p>  &hellip;</p>
]]></content>
  </entry>
  
</feed>
