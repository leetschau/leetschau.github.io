<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Office | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/office/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2015-06-04T20:48:19+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Manipulate Word and Excel Files in a Folder]]></title>
    <link href="http://leetschau.github.io/blog/2014/07/03/185755/"/>
    <updated>2014-07-03T18:57:55+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/07/03/185755</id>
    <content type="html"><![CDATA[<p>Ref:
<a href="http://excelexperts.com/VBA-Tips-List-Files-In-A-Folder">21. VBA Tips - List Files In A Folder</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[如何利用VBA嵌入C++ Builder驱动Office]]></title>
    <link href="http://leetschau.github.io/blog/2006/11/24/091815/"/>
    <updated>2006-11-24T09:18:15+08:00</updated>
    <id>http://leetschau.github.io/blog/2006/11/24/091815</id>
    <content type="html"><![CDATA[<p>下面的代码是点击Button1后，新建一个Excel文档，并在指定的单元格上添加一个超链接。</p>

<p>void __fastcall TForm1::Button1Click(TObject *Sender)
{
 Variant vHandleExcelApp, vHandleWorkbook, vHandleSheet, vHandleCell;
 AnsiString ansi,tmpStr;
 tmpStr = &ldquo;file:///E:\aaa\zOut1\sss.txt&rdquo;; //字符串中“\”要写成“\”
 //this->Edit1->Text = ansi;
 try{
 vHandleExcelApp = Variant::CreateObject(&ldquo;Excel.Application&rdquo;);
 } catch(&hellip;) {
 Application->MessageBox(&ldquo;无法启动Excel&rdquo;, &ldquo;错误&rdquo;, MB_ICONSTOP|MB_OK);
 return;
 }
 vHandleExcelApp.OlePropertySet(&ldquo;Visible&rdquo;, true);
 vHandleExcelApp.OlePropertyGet(&ldquo;WorkBooks&rdquo;).OleFunction(&ldquo;Add&rdquo;,1);
 vHandleWorkbook = vHandleExcelApp.OlePropertyGet(&ldquo;ActiveWorkBook&rdquo;);
 vHandleSheet = vHandleWorkbook.OlePropertyGet(&ldquo;ActiveSheet&rdquo;);
 ansi = &ldquo;research for&rdquo;;
 vHandleSheet.OlePropertyGet(&ldquo;Cells&rdquo;, 2, 1).OlePropertySet(&ldquo;Value&rdquo;, ansi);
 vHandleCell = vHandleSheet.OlePropertyGet(&ldquo;Cells&rdquo;, 2, 1);
 vHandleSheet.OlePropertyGet(&ldquo;Hyperlinks&rdquo;).OleFunction(&ldquo;Add&rdquo;,vHandleCell,tmpStr,&ldquo;the caption here&rdquo;);
}</p>

<p>相应的VBA代码是：</p>

<p>ActiveSheet.Hyperlinks.Add Anchor:=ActiveSheet.Cells(2,1), Address:= &ldquo;E:\MyDoc\using_javadoc.doc&rdquo;, TextToDisplay:=&ldquo;some text here&rdquo;</p>

<p>可见使用OlePropertyGet、OlePropertySet、OleFunction三个函数基本上可以实现从VBA到C++代码的转换。</p>
]]></content>
  </entry>
  
</feed>
