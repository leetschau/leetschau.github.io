<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Message Queue | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/message-queue/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2016-11-11T15:03:30+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[A Lightweight Message Queue]]></title>
    <link href="http://leetschau.github.io/blog/2015/12/10/165329/"/>
    <updated>2015-12-10T16:53:29+08:00</updated>
    <id>http://leetschau.github.io/blog/2015/12/10/165329</id>
    <content type="html"><![CDATA[<h1>RSMQ</h1>

<p><a href="http://smrchy.github.io/rsmq/">RSMQ</a> is a lightweight message queue
based on Redis.</p>

<h2>Setup Redis Server on Docker</h2>

<p>Start Redis server on docker:
<code>bash
docker run --name myredis -d redis
                  -------
                     A
</code></p>

<p>Connect to the server with:
<code>bash
docker run -it --link myredis:redis --rm redis bash -c 'redis-cli -h redis'
                      ------- -----                                  -----
                         A      B                                      B
</code>
or the full version:
<code>docker run -it --link myredis:redis --rm redis bash -c 'exec redis-cli -h "$REDIS_PORT_6379_TCP_ADDR" -p "$REDIS_PORT_6379_TCP_PORT"'</code>.</p>

<p>Now in redis console, use <code>info</code> to get the server&rsquo;s version;</p>

<p><code>keys *</code> to list all keys;
<code>set mykey "hello"</code> to add a key/value pair.
<code>get mykey</code> to fetch the key&rsquo;s value.</p>

<p>Note:</p>

<ol>
<li>Names labled with &ldquo;A&rdquo; is the container&rsquo;s name of Redis server.
Names labled with &ldquo;B&rdquo; is the name alias of Redis server container used
by Redis client container.</li>
</ol>


<h2>Setup Redis on Metal Host</h2>

<p>Install Redis on Ubuntu 14.04 with:
<code>bash
apt-get install -y python-software-properties # optional
add-apt-repository -y ppa:rwky/redis
apt-get update
apt-get install -y redis-server
</code></p>

<p>Install rsmq: in project root folder, run<code>npm install rsmq</code>;</p>

<p>Install rsmq-cli: <code>npm install -g rsmq-cli</code>;</p>

<pre><code>rsmq config ls
rsmq create -q payment            // create a new queue named "payment"
rsmq ls                           // list all queues
rsmq stats -q payment             // print stats of queue "payment"
rsmq send "pay $1000" -q payment  // send a message to "payment"
rsmq receive -q payment           // receive a message from "payment"
</code></pre>
]]></content>
  </entry>
  
</feed>
