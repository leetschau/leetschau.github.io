<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 字符串 | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/zi-fu-chuan/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2015-05-26T17:50:21+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    <email><![CDATA[leetschau@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[中文Windows上安装Jython字符串处理异常的解决办法]]></title>
    <link href="http://leetschau.github.io/blog/2010/11/23/152842/"/>
    <updated>2010-11-23T15:28:42+08:00</updated>
    <id>http://leetschau.github.io/blog/2010/11/23/152842</id>
    <content type="html"><![CDATA[<p>The Jython console didn&rsquo;t work properly on my Chinese version Windows XP. It can not interprete the strings properly.</p>

<p>e.g.</p>

<blockquote><blockquote><blockquote><p>print &ldquo;hello world&rdquo;</p></blockquote></blockquote></blockquote>

<p>&hellip;.</p>

<p>Looks like it&rsquo;s looking for a futher input. After I input a &lsquo;\n&rsquo;, ther console crashed and complains</p>

<p>LookupError: unknown encoding &lsquo;gb18030&rsquo;.</p>

<p>This error never happens on the English version Windows XP. So, this problem definitely caused by the system default encoding.</p>

<p>With a few hours study for the JVM &amp; the Jython encoding setting, I found 2 solutions.</p>

<p>1) Change the JVM default character encoding</p>

<p>Start up the jython with option -Dfile.encoding=UTF8,then the Jython console&rsquo;s encoding will be UTF8 as well.</p>

<p>e.g.</p>

<pre><code>jython -Dfile.encoding=UTF8 
</code></pre>

<p>For change the JVM encoding automatically, you can also create one environment variable JAVA_TOOL_OPTIONS to -Dfile.encoding=UTF8.</p>

<p>e.g.</p>

<pre><code>set JAVA_TOOL_OPTIONS="-Dfile.encoding=UTF8" 
</code></pre>

<p>2) Change the Jython console character encoding</p>

<p>Start up the jython with option -Dpython.console.encoding=UTF8</p>

<p>e.g.</p>

<pre><code>jython -Dpython.console.encoding=UTF8
</code></pre>

<p>Or add this setting in the Jython registry file. On my laptop, the file is C:\jython25\registry</p>

<p>Now, you enjoy.</p>

<hr />

<p>2013-03-19更新</p>

<h1>命令行输出</h1>

<p>java -jar -Dpython.console.encoding=UTF-8 jython-2.5.3.jar</p>

<h1>执行文件</h1>

<p>java -jar -Dfile.encoding=UTF-8 jython-2.5.3.jar test.txt</p>

<p>目前都不能输入汉字</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[将队列转换为字符串]]></title>
    <link href="http://leetschau.github.io/blog/2010/08/11/085442/"/>
    <updated>2010-08-11T08:54:42+08:00</updated>
    <id>http://leetschau.github.io/blog/2010/08/11/085442</id>
    <content type="html"><![CDATA[<p>LinkedBlockingQueue<Byte> inputQ = new LinkedBlockingQueue<Byte>();</p>

<p> Byte[] destArr = inputQ.toArray( new Byte[0]);</p>

<p> byte [] resultArr = new  byte [destArr. length ];</p>

<p> for ( int i = 0; i &lt; resultArr. length ; i++) {</p>

<p>  resultArr[i] = destArr[i].byteValue();</p>

<p> }</p>

<p> strRes = new String(resultArr);</p>

<p> 转换过程是：队列==>Byte数组==>byte数组==>字符串。下面是应用了此一转换的完整的Result类实现。</p>

<p> /**</p>

<ul>
<li><p>通过字节队列创建一个新的返回结果实例</p></li>
<li></li>
<li><p>@param inputQ</p></li>
<li><p> 结果字节队列</p></li>
<li><p>@param cmdType</p></li>
<li><p> 命令返回类型</p></li>
</ul>


<p> */</p>

<p> public Result( final LinkedBlockingQueue<Byte> inputQ, final  int cmdType) {</p>

<p>  cmdReturnType = cmdType;</p>

<p>  Byte[] destArr = inputQ.toArray( new Byte[0]);</p>

<p>  byte [] resultArr = new  byte [destArr. length ];</p>

<p>  for ( int i = 0; i &lt; resultArr. length ; i ++) {</p>

<p>   resultArr[ i ] = destArr[ i ].byteValue();</p>

<p>  }</p>

<p>  strRes = new String(resultArr);</p>

<p> }</p>
]]></content>
  </entry>
  
</feed>
