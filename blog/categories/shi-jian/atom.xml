<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 时间 | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/shi-jian/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2015-04-30T16:15:37+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    <email><![CDATA[leetschau@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[自动生成srt格式的脚本（Python实现）]]></title>
    <link href="http://leetschau.github.io/blog/2010/12/09/180259/"/>
    <updated>2010-12-09T18:02:59+08:00</updated>
    <id>http://leetschau.github.io/blog/2010/12/09/180259</id>
    <content type="html"><![CDATA[<p>用威力导演制作短片，这个软件有个导入srt字幕的功能，可以写好文本后一次性导入短片的字幕，比手工在威力导演里写快多了，srt文本中，每一条字幕的格式是：
 序号
 起止时间
 字幕内容</p>

<p>例如：
 1
 00:00:08,0 &ndash;> 00:00:13,0
 发展历程</p>

<p> 2
 00:00:13,0 &ndash;> 00:00:18,0
 2006年
 通用产品线正式成立
 &hellip;</p>

<p>这种格式在字幕的条数发生变化时修改起来很麻烦，比如一共有50条字幕，在第3条后加一条新字幕，则后面47条的序号、起止时间点都要修改，简直是噩梦，为此编写了下面的Python脚本，现在只要将字幕写成如下格式，用脚本处理后就能生成上面要求的格式了：</p>

<p> 发展历程</p>

<p> 2006年
 通用产品线正式成立
 &hellip;</p>

<p>其中主要的技术点有（Python 3.1）：
 时间偏移用timedelta对象，时间点用datetime对象，不能用time对象，因为time对象和timedelta对象不能做和； 时间转换为字符串的方法是strftime() 地址字符串要用“/”代替“\”；
将待处理文件保存为ANSI格式文本，在脚本里配好地址（这里是“f:/视频制作”）就可以了。</p>

<p>下面是脚本内容：</p>

<p> #!/usr/bin/env python</p>

<p> from datetime import datetime, timedelta</p>

<p> if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:</p>

<p>  #读原始文件</p>

<p>  oriScript = open(&lsquo;f:/视频制作/rawScript.srt&rsquo;,&lsquo;rt&rsquo;)</p>

<p>  #写目标文件</p>

<p>  destScript = open(&lsquo;f:/视频制作/destScript.srt&rsquo;,&lsquo;wt&rsquo;)</p>

<p>  try:</p>

<p>   block = &lsquo;&rsquo;</p>

<p>   seqNo = 1</p>

<p>   startTime = datetime(1980,1,1,0,0,8)</p>

<p>   for curLine in oriScript:</p>

<pre><code>#print(len(curLine)) 

if curLine.isspace() and len(block)&gt;0: #本行是空行 

 destScript.write(str(seqNo)+'\n') #写字幕序号 

 endTime = startTime+timedelta(seconds=5) 

 #写起止时间： 

 destScript.write(startTime.strftime("%X") + ',0 --&gt; '+ endTime.strftime("%X") + ',0\n') 

 destScript.write(block+'\n') 

 block = '' #清空缓存 

 seqNo = seqNo + 1 #序号递增 

 startTime = endTime #本条的终止时间是下一条的起始时间 

else: 

 block = block + curLine #当前行追加到缓存中 
</code></pre>

<p>  finally:</p>

<p>   oriScript.close()</p>

<p>   destScript.close()</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[怎样获取计算机上次启动时间]]></title>
    <link href="http://leetschau.github.io/blog/2010/10/18/082950/"/>
    <updated>2010-10-18T08:29:50+08:00</updated>
    <id>http://leetschau.github.io/blog/2010/10/18/082950</id>
    <content type="html"><![CDATA[<p>有时候需要知道最近一次电脑的启动时间（或者关闭时间），在Windows XP下，有两种方法可以得到这个信息。</p>

<p> 事件查看器方法</p>

<p>【控制面板->管理工具->事件查看器->系统（ 在左边的窗口中，Win7下是在“Windows日志”下 ）->右键->属性】，在打开的【系统属性】窗口中选择【筛选器】，在【事件类型】下面 仅 选中【信息】复选项，并在【事件来源】列表中选择【eventlog】项，【确定】返回事件查看器。右边的窗口中，【事件】下面为6005的表示开机，6006表示关机。基本上可以查看最近3个月以来计算机的开/关机记录。</p>

<p> 日志文件方法</p>

<p>【开始->运行】里输入“schedlgu.txt”，在打开的文件里搜索“任务计划程序服务”，下面的一行就是计算机 开/关机记录。下面是一个样例：</p>

<p> ……</p>

<p> “任务计划程序服务”</p>

<p>  已退出于 2010-10-12 18:21:45</p>

<p> “任务计划程序服务”</p>

<p>  已启动于 2010-10-13 8:11:11
……</p>

<p>注：Notepad++ v5.6/5.7的中文搜索好像有问题，经常出现搜不到的情况，如果搜不到 “任务计划程序服务”这个字符串，可以用其他文本编辑器（如Vim、UE等）试试。</p>
]]></content>
  </entry>
  
</feed>
