<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Curl | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/curl/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2015-11-20T11:01:10+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Elasticsearch Notes]]></title>
    <link href="http://leetschau.github.io/blog/2015/10/24/115416/"/>
    <updated>2015-10-24T11:54:16+08:00</updated>
    <id>http://leetschau.github.io/blog/2015/10/24/115416</id>
    <content type="html"><![CDATA[<h1>Server setup</h1>

<p>Download tar package of <a href="https://www.elastic.co/products/elasticsearch">ealsticSearch</a>
and install:</p>

<pre><code>aptitude update
aptitude install openjdk-7-jdk
wget https://download.elasticsearch.org/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.0.0/elasticsearch-2.0.0.tar.gz
tar zxf elasticsearch-2.0.0.tar.gz
cd elasticsearch-2.0.0
bin/elasticsearch
</code></pre>

<p>Or you can install it as a service with deb package</p>

<pre><code>wget https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-1.7.3.deb
sudo dpkg -i elasticsearch-1.7.3.deb
sudo /etc/init.d/elasticsearch restart
</code></pre>

<p>Start in foreground:
<code>sudo /usr/share/elasticsearch/bin/elasticsearch --default.path.conf=/etc/elasticsearch/</code>.
If you omit the option &ldquo;&ndash;default.path.conf&rdquo;,
you&rsquo;ll get an error:
<code>org.elasticsearch.ElasticsearchException: Failed to load logging configuration</code>.</p>

<p>When you want start the 2nd node in the same machine,
always start it this way with the same command above.</p>

<p>Or run it in background:
<code>/usr/share/elasticsearch/bin/elasticsearch -d --default.path.conf=/etc/elasticsearch/</code>;</p>

<h1>Data manipulation in client</h1>

<p>Create a new index:</p>

<pre><code>curl -XPUT 'localhost:9200/blogs' -d '
{
   "settings" : {
      "number_of_shards" : 3,
      "number_of_replicas" : 1
   }
}'
</code></pre>

<p>List all indexes: <code>curl 'localhost:9200/_cat/indices?v'</code>;</p>

<p>For a index named &ldquo;test&rdquo;:</p>

<p>List all data in an index: <code>curl -XGET 'http://localhost:9200/test/_search?pretty'</code>;</p>

<p>Remove an index: <code>curl -XDELETE 'http://localhost:9200/test/'</code>,
wild card can be used here: <code>curl -XDELETE 'http://localhost:9200/logstash*/'</code>,
or many indexes at once: <code>curl -XDELETE 'http://localhost:9200/website,shakes*/'</code>,
separated by comma.</p>

<p>Put the result as well-formatted json:</p>

<pre><code>npm install -g json
curl 'localhost:9200/megacorp/employee/_search?pretty' | json
</code></pre>

<h1>Notes</h1>

<p>You can use
<code>curl 'localhost:9200/megacorp/employee/_search?pretty' | python -m json.tool</code>
in command line or <code>:%!python -m json.tool</code> in vim to format json string.
But it will sort your keys, and maybe not friendly to Unicode characters.</p>

<p>Do NOT delete &ldquo;mongodb_meta&rdquo; index in ES,
or you will get an error when starting <code>mongo-connector</code>:</p>

<blockquote><p>AttributeError: &lsquo;IndicesClient&rsquo; object has no attribute &lsquo;delete_mapping&rsquo;</p></blockquote>

<p>If you had deleted it, restart ES server to rebuild this index.</p>

<p><code>?petty</code> sometimes will be invalid url.</p>

<p>Format json in vim: <code>:%!json</code>.</p>

<h1>Ref:</h1>

<p><a href="http://stackoverflow.com/questions/352098/how-can-i-pretty-print-json">http://stackoverflow.com/questions/352098/how-can-i-pretty-print-json</a></p>

<p><a href="https://pascalprecht.github.io/2014/07/10/pretty-print-json-in-vim/">https://pascalprecht.github.io/2014/07/10/pretty-print-json-in-vim/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Curl Notes]]></title>
    <link href="http://leetschau.github.io/blog/2014/04/15/160953/"/>
    <updated>2014-04-15T16:09:53+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/04/15/160953</id>
    <content type="html"><![CDATA[<p>Ref:</p>

<p><a href="http://httpkit.com/resources/HTTP-from-the-Command-Line/">9 uses for cURL worth knowing</a></p>
]]></content>
  </entry>
  
</feed>
