<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Auth | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/auth/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2016-11-11T15:03:30+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Setup MongoDB Server on Aliyun]]></title>
    <link href="http://leetschau.github.io/blog/2015/03/06/090609/"/>
    <updated>2015-03-06T09:06:09+08:00</updated>
    <id>http://leetschau.github.io/blog/2015/03/06/090609</id>
    <content type="html"><![CDATA[<p>For version 3.0.</p>

<h1>Install</h1>

<p>On VPS (ip: 123.56.18.18), download MongoDB binary package for Ubuntu 14.04 and extract:</p>

<pre><code>wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-ubuntu1404-3.0.3.tgz
cd /opt
tar zxf ~/mongodb-linux-x86_64-ubuntu1404-3.0.3.tgz
mkdir -p /data/db
</code></pre>

<h1>Authentication Management</h1>

<p>Start mongod without auth on VPS (ip: 123.56.18.18): <code>mongod</code>;</p>

<p>Connect to server with <code>mongo 123.56.18.18</code>;
Create system user administrator:</p>

<pre><code>use admin
db.createUser(
    {
      user: "superuser",
      pwd: "12345678",
      roles: [ "root" ]
    }
)
</code></pre>

<p>Create user in current database:</p>

<pre><code>use products
db.createUser({user: "dba", pwd: "dba", roles: ["readWrite"]})
show users
</code></pre>

<p>Verify with <code>db.getUsers()</code>.</p>

<p>Create a production config file mongo.conf:</p>

<pre><code>net:
  #bindIp: 10.251.212.248
  port: 15515
systemLog:
  destination: file
  path: "mongo.log"
  logAppend: true
security:
  authorization: enabled
</code></pre>

<p>Stop and restart mongod with <code>nohup mongod --config mongo.conf &amp;</code>;</p>

<p>Connect to server as a database user: <code>mongo 123.56.18.18:15515/products -u niufair -p nfsecret</code>.
You can <code>show collections</code>, <code>db.doc.insert()</code>, etc.</p>

<p>Start Meteor app with <code>MONGO_URL="mongodb://niufair:nfsecret@123.56.18.18:15515/products" meteor</code>.</p>

<p>Connect to server as administrator: <code>mongo 123.56.18.18:15515/admin -u leo -p leoisadmin</code>.</p>

<p>Use <code>db.getUsers()</code> (or <code>show users</code>) and <code>db.dropUser("username")</code> to list and remove the user.</p>

<h2>Create a new database under authentication</h2>

<p>Say we want to create a new database named &ldquo;bakdb&rdquo;:</p>

<pre><code>mongo 123.56.18.18:15515/admin -u leo -p leoisadmin
use bakdb
db.createUser({user: "niufair", pwd: "nfsecret", roles: ["readWrite"]})
</code></pre>

<p>Verify: <code>mongo -u niufair -p nfsecret 123.56.18.18:15515/bakdb</code>;</p>

<p>Ref:</p>

<p><a href="http://docs.mongodb.org/manual/tutorial/enable-authentication-without-bypass/">Enable Authentication after Creating the User Administrator</a></p>

<p><a href="http://docs.mongodb.org/manual/tutorial/add-user-to-database/">Add a User to a Database</a></p>

<p><a href="http://docs.mongodb.org/manual/tutorial/add-admin-user/">Create an Administrative User with Unrestricted Access</a></p>

<p><a href="http://docs.mongodb.org/manual/tutorial/enable-authentication/">Enable Client Access Control</a></p>

<p><a href="http://docs.mongodb.org/manual/reference/built-in-roles/">Built-In Roles</a></p>

<p><a href="http://stackoverflow.com/questions/4881208/how-to-put-username-password-in-mongodb">http://stackoverflow.com/questions/4881208/how-to-put-username-password-in-mongodb</a></p>

<h1>MMS</h1>

<p>Connect mongodb server without authentication: <code>mongo &lt;ip&gt;:&lt;port&gt;</code>;</p>
]]></content>
  </entry>
  
</feed>
