<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Tmux | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/tmux/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2015-08-01T16:20:42+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Control Linux Server With Tmux on Windows Client]]></title>
    <link href="http://leetschau.github.io/blog/2015/06/27/085109/"/>
    <updated>2015-06-27T08:51:09+08:00</updated>
    <id>http://leetschau.github.io/blog/2015/06/27/085109</id>
    <content type="html"><![CDATA[<p>I&rsquo;ve tried Kitty as SSH client.
But under tmux, the right &ldquo;Alt&rdquo; key doesn&rsquo;t work,
while it works good with MobaXterm.</p>

<p>Full screen switch: F11;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tmux Configurations for Unity Desktop]]></title>
    <link href="http://leetschau.github.io/blog/2015/06/18/112729/"/>
    <updated>2015-06-18T11:27:29+08:00</updated>
    <id>http://leetschau.github.io/blog/2015/06/18/112729</id>
    <content type="html"><![CDATA[<p>Verified on Ubuntu 14.04, 2015-6-18.</p>

<h1>Prefix</h1>

<p><code>M-f</code> will activate the Unity HUB, so use <code>M-q</code> as tmux prefix:
<code>set -g prefix M-q</code>.</p>

<h1>Get Help</h1>

<ul>
<li><p>List all shortcuts: prefix ?</p></li>
<li><p>List all commands: <code>tmux list-commands</code></p></li>
</ul>


<h1>Open a new Window/Pane</h1>

<p>bind -n M-/ split-window -h
bind -n M&ndash; split-window -v
bind -n M-n new-window</p>

<h1>Resize Pane in a Window</h1>

<p>Use Ctrl- arrow key to resize pane:</p>

<pre><code>bind -n -r ^Left resize-pane -L 5
bind -n -r ^Down resize-pane -D 5
bind -n -r ^Up resize-pane -U 5
bind -n -r ^Right resize-pane -R 5
</code></pre>

<p>Use <code>M-z</code> to maximize/restore a pane:
<code>bind -n M-z resize-pane -Z</code>.</p>

<h1>Rotate Panes in a Window</h1>

<p>Use default settings: prefix + Space</p>

<h1>Jump between Window and Pane</h1>

<p>Alt-(1~9): jump between windows;</p>

<p>Alt-h/j/k/l: jump between panes;</p>

<pre><code>bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

bind -n M-k select-pane -U
bind -n M-j select-pane -D
bind -n M-h select-pane -L
bind -n M-l select-pane -R
</code></pre>

<h1>Move Window</h1>

<p>Moving window behaves different with i3wm.
If the target window exists, you have to use <code>join-pane</code>, otherwise <code>break-pane</code>.</p>

<p>I use <code>if-shell</code> to test if the target window exists.</p>

<p>Then add target window number provided by user (%1, which means the first user-input parameter)
after &ldquo;-t&rdquo; option of <code>join-pane</code>.
The default target format is <code>#{session_name}:#{window_index}.#{pane_index}</code>.
See <code>man tmux</code> for details.</p>

<pre><code>bind -n M-i command-prompt -p "move current pane to window:" "if-shell 'tmux list-windows |grep \"^%1\":' 'join-pane -t:\"%1\"' 'break-pane'"
</code></pre>

<h1>Other helpful resources</h1>

<p>Use <code>^A</code> to represent &ldquo;Ctrl-A&rdquo;.</p>

<p>Shutdown visual alerts:</p>

<pre><code>setw -g monitor-activity on
set -g visual-activity off
</code></pre>

<h2>Commands</h2>

<ul>
<li><code>clock-mode</code>: display a large clock on the terminal</li>
</ul>


<h2>Shortcuts</h2>

<pre><code>bind -n M-a command-prompt
bind -n M-r command-prompt -p "rename window name to:" "rename-window '%%'"
bind r source-file ~/.tmux.conf \; display "Reloaded!"
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Develop With Tmux in Linux]]></title>
    <link href="http://leetschau.github.io/blog/2014/05/23/094625/"/>
    <updated>2014-05-23T09:46:25+08:00</updated>
    <id>http://leetschau.github.io/blog/2014/05/23/094625</id>
    <content type="html"><![CDATA[<p>tmux is a terminal multiplexer. Its 3-level architecture &ldquo;session-window-pane&rdquo; is very flexible and powerful. Sessions are independent. Windows are different &ldquo;tabs&rdquo; in a session. And panes are different parts in a window. The multiplexer means if different hosts <strong>attach</strong> to the same session, they share the same screen, the same input and output, which like they sit together, use the same computer, so making pair-programming a breeze.</p>

<p>You can detach from a session while it&rsquo;s still kept by tmux server in background. This is very useful on servers. You use laptop attaching to a tmux server running a server machine, work for a while, then detach from this server, shutdown your laptop. Next time when you attach to it, all the works are kept from last detach, as if you didn&rsquo;t leave them.</p>

<p>You can move window between sessions, which is convinient for collaboration. For example, Bob works on session &ldquo;bob&rdquo; and Tom works on &ldquo;tom&rdquo;, Bob write some codes and want Tom to complete it. Then he can move his window to Tom&rsquo;s session. If he want pair-programming with Tom, he can tell Tom to detach from his own session &ldquo;tom&rdquo; and attach to &ldquo;bob&rdquo;. When finished, Tom detach from &ldquo;bob&rdquo; and attach to &ldquo;tom&rdquo; to continue his work.</p>

<p>Ref: &ldquo;tmux - Productive Mouse-Free Development&rdquo; by Brian P. Hogan.</p>

<h1>Install</h1>

<p>With internet connected, install tmux with <code>sudo yum install tmux</code> or <code>sudo apt-get install tmux</code>.
Without internet connection, download <a href="http://pkgs.repoforge.org/tmux/tmux-1.6-1.el6.rf.x86_64.rpm">tmux package</a> on <a href="http://repoforge.org/">RepoForge</a>,
then install it with <code>sudo rpm -ivh tmux-1.6-1.el6.rf.x86_64.rpm</code>.</p>

<h1>Getting help</h1>

<h2>List all binding keys</h2>

<p><code>tmux list-keys</code> or use shortcuts: &ldquo;bind-key ?&rdquo;.</p>

<p>So if you know a shortcut, say [prefix]!, and want know the corresponding command, you can run</p>

<pre><code>tmux list-keys|grep !
</code></pre>

<p>then you get</p>

<pre><code>bind-key          ! break-pane 
</code></pre>

<p>So the corresponding command is &ldquo;break-pane&rdquo;.</p>

<h2>List all commands</h2>

<pre><code>tmux list-commands
</code></pre>

<h1>Define tmux startup shortcuts in Xfce, Mint</h1>

<p>Application Finder(Alt-F3) -> Keyboard -> Application shortcuts: Add
    Command: exo-open &ndash;launch TerminalEmulator xfce4-terminal &ndash;fullscreen -x tmux new -s basic
    Shortcut: Alt-[</p>

<h1>Frequently used shortcuts</h1>

<p>According to the defualt shortcuts and above modifications:</p>

<ul>
<li><p>List all shortcuts: prefix ?</p></li>
<li><p>List existing sessions: tmux ls</p></li>
<li><p>Attach to a session: tmux attach -t <session-name>, if there&rsquo;s only one window, you can use <code>tmux a</code> for short;</p></li>
<li><p>Switch to next window: prefix n</p></li>
<li><p>Jump to last window: prefix l (easy for jump between 2 windows)</p></li>
<li><p>Detach from a session: prefix d</p></li>
<li><p>Jump to previous/next session: prefix (/)</p></li>
<li><p>Jump to last session: prefix L (easy for jump between 2 sessions)</p></li>
<li><p>Create new window: prefix c</p></li>
<li><p>Rename current window: prefix <comma></p></li>
<li><p>Jump to a window according to it&rsquo;s number: prefix <num> (see tmux&rsquo;s status line to get its number)</p></li>
<li><p>Split current window horizontally/vertically: prefix -/|</p></li>
<li><p>Jump to another pane(sub-window): prefix h/j/k/l</p></li>
<li><p>Jump to next pane: prefix o</p></li>
<li><p>Maximum/Restore a pane: prefix z (tmux version >= 1.8, use <code>tmux -V</code> to get the version)</p></li>
<li><p>Move window to another session: prefix .(period)</p></li>
<li><p>Switch to next layout: prefix <Space></p></li>
</ul>


<h1>Window-Pane Management</h1>

<p>You can run <code>tmux ...</code> directly within tmux-managed sessions and windows,
no need to detach from tmux environment beforehand.
The only exception is <code>tmux attach</code>,
which will produce a recursive attached tmux session, and messed up things.
All command of tmux has auto-completion, so it&rsquo;s very convenient to run tmux command within tmux window.
The equivalent way of running tmux command without command-line(like that in vi) is using shortcut &ldquo;prefix :&rdquo;.</p>

<h2>Turning a window into a pane</h2>

<ul>
<li><p>In the destination window: <code>tmux join-pane -s [source-window-number]</code>;</p></li>
<li><p>In the source window: <code>tmux join-pane -t [destination-window-number]</code>;</p></li>
<li><p>Specify source and destination windows both: <code>tmux join-pane -s [src-window-number] -t [dst-window-number]</code>;</p></li>
</ul>


<h2>Turning a pane into a window</h2>

<p>Use shortcuts &ldquo;prefix, !&rdquo; in the pane.</p>

<h2>Keep the window name fixed</h2>

<p>Add &ldquo;set-option -g allow-rename off&rdquo; into ~/.tmux.conf.</p>

<h2>Kill zombie window</h2>

<p><code>tmux kill-window -t [n]</code>, where [n] is the window number.</p>

<h1>Clipboard Management</h1>

<h2>Select/copy/paste text with shortcuts</h2>

<ol>
<li><p>Default key of opening copy mode: &ldquo;prefix, [&rdquo;, modify it to Ctrl-J for convenience.</p></li>
<li><p>Move cursor: h/j/k/l;</p></li>
<li><p>Begin select: v</p></li>
<li><p>End select and copy to clipboard: y
or quit copy mode with <Enter>;</p></li>
<li><p>Paste text: prefix, p</p></li>
</ol>


<h2>Path share between windows</h2>

<p>I want to copy all files in window #1 to directory in window #2. The workflow is:</p>

<pre><code>prefix 2
tmux setb $PWD
prefix 1
cp * [prefix p]/
</code></pre>

<p>The trick is using <code>tmux setb</code> to copy working directory to buffer of tmux,
then use [prefix p] to paste the path into the copy command.
Don&rsquo;t forget the trailing slash at the end of cp command, it&rsquo;s necessary.</p>

<p>If parcellite is installed, there is a little simpler way to achieve this:</p>

<pre><code>prefix 2
pwd|parcellite
prefix 1
cp * [Ctrl-Alt-v]/
</code></pre>

<p>You can use <code>ls -l|parcellite</code> to add command output to parcellite buffer.</p>

<h2>Multiple Buffers Copy &amp; Paste</h2>

<p>tmux maintains a stack of copied buffers. So you can copy multiple times, and paste selected buffers in arbitrary order, with the help of following commands: list-buffer, show-buffer, choose-buffer, save-buffer.</p>

<p>Copy all the texts in the current pane with &ldquo;capture-pane&rdquo;(not including scrolled out texts).</p>

<h1>Customize status bar</h1>

<h2>Add battery status in tmux status bar</h2>

<p>Add the following line into ~/.tmux.conf:</p>

<pre><code>set -g status-right "%R #[fg=black bg=white]%Y %b %d#[fg=white bg=black] #(/home/chad/apps/getBatteryStuatus)"
</code></pre>

<p>And create a shell script named &ldquo;getBatteryStuatus&rdquo; under /home/chad/apps:</p>

<pre><code>upower -i /org/freedesktop/UPower/devices/battery_BAT0|awk '/^\s*percentage:/ {print $2}'
</code></pre>

<h1>Disable Mouse Scrolling</h1>

<p>Enable mouse scrolling will copy selected text into tmux clipboard.
So it&rsquo;s impossible to copy text in tmux and paste it outside tmux environment.</p>

<p>To disable it, add &ldquo;set -g mode-mouse off&rdquo; into ~/.tmux.conf.</p>

<p>To scrolling window in tmux, first go into copy mode, then use Ctrl-K/J to move up/down.</p>

<p>To make this smooth, add the following into .tmux.conf:</p>

<pre><code># Copy mode
unbind [
bind -n C-j copy-mode
bind p paste-buffer
bind -t vi-copy 'v' begin-selection
bind -t vi-copy 'y' copy-selection
</code></pre>

<h1>Deal with Nested Tmux Session</h1>

<p>If you run <code>tmux a</code> inside a tmux window, you attach to a nested tmux session.
If the prefix definition of both tmux are the same, you can&rsquo;t send keys to inner session directly.
For example, if you press &ldquo;prefix d&rdquo;, if will detach from the outer session.</p>

<p>How to detach from inner session?
First press &ldquo;prefix :&rdquo;, you get the tmux command prompt of outer session.
Then input &ldquo;send-prefix&rdquo;, press <Enter>,then press d.</p>

<p>Or you can use &ldquo;send-keys&rdquo; command.
First press &ldquo;prefix :&rdquo;, you get the tmux command prompt of outer session, like above.
Then input &ldquo;send-keys M-q d&rdquo;, press <Enter>.
Here we suppose your prefix is &ldquo;M-q&rdquo;.</p>

<p>The format of keys after &ldquo;send-keys&rdquo; is defined in section &ldquo;KEY BINDINGS&rdquo; in <code>man tmux</code>.</p>

<h1>Make tmux more convenient</h1>

<p>Add the follow aliases into ~/.bash_aliases:</p>

<pre><code>alias tl='tmux ls'
alias ta='tmux attach -t'
</code></pre>

<p>You can use <Tab> for session name auto-completion after <code>ta</code>.</p>

<h1>My configuration file</h1>

<pre><code>$ cat ~/.tmux.conf

# Set the default terminal mode to 256color mode
set -g default-terminal "screen-256color"

# run zsh
# set-option -g default-command "reattach-to-user-namespace -l $SHELL -l"

# disable mouse scroll
set -g mode-mouse off

# fix the window name
set-option -g allow-rename off

# Setting the prefix from C-b to Alt-f
set -g prefix M-q

# Free the original Ctrl-b prefix keybinding
unbind C-b

# quick window switching, -n means no need to use prefix
bind -n C-h select-window -t :-
bind -n C-l select-window -t :+

# quick window creation
bind -n C-k new-window

# quick pane expansion
# bind -n M-u break-pane

# quick window joining
bind -n M-i command-prompt "join-pane -s %1"

# enable vi keys.
setw -g mode-keys vi

# Set the base index for windows to 1 instead of 0
set -g base-index 1

# Set the base index for panes to 1 instead of 0
setw -g pane-base-index 1

# setting the delay between prefix and command
set -sg escape-time 1
#set -sg repeat-time 1000

# Reload the file with Prefix r
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Split window
bind | split-window -h
bind - split-window -v

# moving between panes
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Pane resizing, -r means you can repeat this key bindings
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Copy mode
unbind [
bind -n C-j copy-mode
bind p paste-buffer
bind -t vi-copy 'v' begin-selection
bind -t vi-copy 'y' copy-selection

# Update the status bar every sixty seconds
set -g status-interval 60

# set the status line's colors
set -g status-fg white
set -g status-bg black

# Status line left side
set -g status-left-length 40
set -g status-left "#[fg=green]session: #S #[fg=yellow]#I #[fg=cyan]#P"
set -g status-utf8 on

# enable activity alerts
setw -g monitor-activity on
set -g visual-activity off

# Center the window list
set -g status-justify centre

# set the color of the window list
setw -g window-status-fg cyan
setw -g window-status-bg default
setw -g window-status-attr dim

# set colors for the active window tag in window list
setw -g window-status-current-fg white
setw -g window-status-current-bg blue
setw -g window-status-current-attr bright

# Status line right side
set -g status-right "%R #[fg=black bg=white]%F#[fg=white bg=black] #(/home/chad/apps/myscripts/getBatteryStuatus)"
#set -g status-right "%R #[fg=black bg=white]%Y %b %d"
# setw -g status-right-attr bright

# Command / message line
set -g message-fg white
set -g message-bg black
set -g message-attr bright

# Execute a command in a new window
bind C command-prompt "new-window -n %1 '%1'"
bind S command-prompt "new-window -n %1 'ssh %1'"
</code></pre>

<p>The last line shows that you can use parameters in key bindings. When you press prefix S, tmux propmt you to input a parameter, I input &ldquo;47&rdquo; and press <Enter>, it will open a new window named &ldquo;47&rdquo;, and run command &ldquo;ssh 47&rdquo;.</p>

<p>If your .tmux.conf doesn&rsquo;t take effect, run the following command to load config file explicitly (or find errors in file):</p>

<pre><code>tmux new
tmux source-file ~/.tmux.conf
</code></pre>

<p>The format strings in status line are interpreted as the followings:</p>

<ul>
<li><p>%X: date-time sign, such as %R is time, %F is date, etc. See full list in &ldquo;FORMAT controls the output&rdquo; section in <code>man date</code>;</p></li>
<li><h1>&hellip;: maybe the output of a shell command, or color of foreground/background, or an attribute. See full list in &ldquo;status-left&rdquo; of <code>man tmux</code>. These meta-data can be used both in status-left and status-right;</h1></li>
</ul>

]]></content>
  </entry>
  
</feed>
