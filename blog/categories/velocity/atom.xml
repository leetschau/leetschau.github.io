<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Velocity | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/velocity/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2016-04-09T20:50:36+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Meteor Test With Velocity and Jasmine]]></title>
    <link href="http://leetschau.github.io/blog/2015/09/29/121847/"/>
    <updated>2015-09-29T12:18:47+08:00</updated>
    <id>http://leetschau.github.io/blog/2015/09/29/121847</id>
    <content type="html"><![CDATA[<p>Create jasmine tests and run them as the following codes:</p>

<pre><code>$ meteor create jasmineEx
$ cd jasmineEx
$ meteor create --package newfairscommerce:add-number
$ rm packages/add-number/add-number-tests.js
$ mkdir -p packages/add-number/tests/{server,client}
$ cat &lt;&lt; EOF &gt; packages/add-number/tests/example-spec.js
describe('sanjo:jasmine on client and server', function() {
  it('works', function() {
    expect(it).toBeDefined();
  })
})
EOF
$ cat &lt;&lt; EOF &gt; packages/add-number/tests/client/example-spec.js
describe('sanjo:jasmine on client', function() {
  it('works', function() {
    expect(it).toBeDefined();
  })
})
EOF
$ cat &lt;&lt; EOF &gt; packages/add-number/tests/server/example-spec.js
describe('sanjo:jasmine on server', function() {
  it('works', function() {
    expect(it).toBeDefined();
  })
})
EOF
</code></pre>

<p>And replace <code>Package.onTest</code> in packages/add-number/package.js with the following codes:</p>

<pre><code>Package.onTest(function(api) {
  api.use('sanjo:jasmine@0.18.0');
  api.use('velocity:html-reporter@0.9.0');
  api.use('velocity:console-reporter@0.1.3');

  api.addFiles('tests/server/example-spec.js', 'server');
  api.addFiles('tests/client/example-spec.js', 'client');
  api.addFiles('tests/example-spec.js', ['server', 'client']);
});
</code></pre>

<p>Now run <code>VELOCITY_TEST_PACKAGES=1 meteor test-packages --driver-package velocity:html-reporter newfairscommerce:add-number</code>
under the root directory of jasmineEx project,
you can get the following output:</p>

<pre><code>...
=&gt; App running at: http://localhost:3000/
I20151003-18:23:56.465(8)? jasmine-server-integration: 2 tests passed (11ms)
I20151003-18:24:07.849(8)? jasmine-client-integration: 2 tests passed (3ms)
</code></pre>

<p>And you can get the test results in browser with url &ldquo;<a href="http://localhost:3000">http://localhost:3000</a>&rdquo;.</p>

<p>Questions:</p>

<p>When running the following codes, it runs into a interactive shell:</p>

<pre><code>npm install -g velocity-cli
velocity test-package newfairscommerce:add-number
</code></pre>
]]></content>
  </entry>
  
</feed>
