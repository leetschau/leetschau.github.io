<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Escape | Dark Matter in Cyberspace]]></title>
  <link href="http://leetschau.github.io/blog/categories/escape/atom.xml" rel="self"/>
  <link href="http://leetschau.github.io/"/>
  <updated>2016-11-11T15:03:30+08:00</updated>
  <id>http://leetschau.github.io/</id>
  <author>
    <name><![CDATA[Li Chao]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Fabric中向文件写入特殊字符]]></title>
    <link href="http://leetschau.github.io/blog/2016/05/26/001459/"/>
    <updated>2016-05-26T00:14:59+08:00</updated>
    <id>http://leetschau.github.io/blog/2016/05/26/001459</id>
    <content type="html"><![CDATA[<p>场景：需要向/etc/default/docker文件追加一行文字：</p>

<pre><code>DOCKER_OPTS="$DOCKER_OPTS --registry-mirror=http://b53a2938.m.daocloud.io"
</code></pre>

<p>其中双引号和$是特殊字符，难度主要提现在如何转意这两个字符上。</p>

<p>普通用户通过Shell达到目标的方法是：</p>

<pre><code>echo "DOCKER_OPTS=\"\$DOCKER_OPTS --registry-mirror=http://b53a2938.m.daocloud.io\"" | sudo tee -a /etc/default/docker
</code></pre>

<p>root用户使用Shell的方法是：</p>

<pre><code>echo "DOCKER_OPTS=\"\$DOCKER_OPTS --registry-mirror=http://b53a2938.m.daocloud.io\"" &gt;&gt; /etc/default/docker
</code></pre>

<p>Fabric的实现方法是：</p>

<pre><code>sudo('echo "DOCKER_OPTS=\\\\"\\\$DOCKER_OPTS '
     '--registry-mirror=http://b53a2938.m.daocloud.io\\\\"" '
     '&gt;&gt; /etc/default/docker')
</code></pre>

<p>或者用raw string:</p>

<pre><code>sudo(r'echo "DOCKER_OPTS=\\"\\$DOCKER_OPTS --registry-mirror='
     r'http://b53a2938.m.daocloud.io\\"" &gt;&gt; /etc/default/docker')
</code></pre>
]]></content>
  </entry>
  
</feed>
