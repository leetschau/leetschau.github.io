<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Li Chao" />
        <meta name="copyright" content="Li Chao" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="virtualenv, virtualenvwrapper, PyCharm, Tech, " />

<meta property="og:title" content="Virtual Environment in Python"/>
<meta property="og:url" content="http://leetschau.github.io/virtual-environment-in-python.html" />
<meta property="og:description" content="virtualenv virtualenvwrapper is not file based (it depends heavily on workon). And it&#39;s setup is not very easy. While virtualenv can be used like npm (one virtual env in one project). So I prefer virtualenv to virturalenvwrapper for managing Python project environment. Install it with sudo pip install virtualenv. Workflow …" />
<meta property="og:site_name" content="DarkMatter in Cyberspace" />
<meta property="og:article:author" content="Li Chao" />
<meta property="og:article:published_time" content="2014-01-09T18:31:48+08:00" />
<meta property="" content="2014-01-09T18:31:48+08:00" />
<meta name="twitter:title" content="Virtual Environment in Python">
<meta name="twitter:description" content="virtualenv virtualenvwrapper is not file based (it depends heavily on workon). And it&#39;s setup is not very easy. While virtualenv can be used like npm (one virtual env in one project). So I prefer virtualenv to virturalenvwrapper for managing Python project environment. Install it with sudo pip install virtualenv. Workflow …">

        <title>Virtual Environment in Python · DarkMatter in Cyberspace
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://leetschau.github.io/theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://leetschau.github.io/"><span class=site-name>DarkMatter in Cyberspace</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://leetschau.github.io">Home</a></li>
                            <li ><a href="http://leetschau.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://leetschau.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://leetschau.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://leetschau.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://leetschau.github.io/virtual-environment-in-python.html"> Virtual Environment in Python </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <hr>
<h1>virtualenv</h1>
<p>virtualenvwrapper is not file based (it depends heavily on <code>workon</code>).
And it's setup is not very easy.
While virtualenv can be used like npm (one virtual env in one project).
So I prefer virtualenv to virturalenvwrapper
for managing Python project environment.</p>
<p>Install it with <code>sudo pip install virtualenv</code>.</p>
<p>Workflow with virtualenv:</p>
<ol>
<li>
<p>In a Python project root folder, run <code>virtualenv venv</code> to build the home
folder for virtual environment, and add <code>venv</code> into .gitignore.</p>
</li>
<li>
<p>Run <code>. venv/bin/activate</code> to activate the environment;</p>
</li>
<li>
<p><code>pip install -r requirements.txt</code> to install dependent packages;</p>
</li>
<li>
<p>Edit files and test project with <code>python ...</code>;</p>
</li>
<li>
<p>Quit environment with <code>deactivate</code>;</p>
</li>
</ol>
<p>Note:</p>
<p>Add <code>-p &lt;python-bin-path&gt;</code> to use alternative Python executable.
For example, <code>virtualenv -p /usr/bin/python3 venv</code>
to build an environment using Python 3.</p>
<h1>virturalenvwrapper</h1>
<h2>Installation</h2>
<div class="highlight"><pre><span></span><code>$ sudo pip install virtualenvwrapper
</code></pre></div>


<p>Add the following lines into ~/.zshenv:</p>
<div class="highlight"><pre><span></span><code><span class="err">WORKON_HOME=~/docs/workspace/python-workspace/env-home</span>
<span class="err">PROJECT_HOME=~/docs/workspace/python-workspace/project-home</span>
</code></pre></div>


<p>and create the two folders specified above.</p>
<p>Add following lines into ~/.zshrc:</p>
<div class="highlight"><pre><span></span><code><span class="err">source /usr/local/bin/virtualenvwrapper.sh</span>
</code></pre></div>


<h2>Usage</h2>
<h3>For new project</h3>
<p>Create a new project funcPy using Python 3.x (run in any foler):</p>
<div class="highlight"><pre><span></span><code><span class="err">mkproject -p /usr/bin/python3 funcPy</span>
</code></pre></div>


<p>The CWD will be changed into the project root automatically.</p>
<p>Verify:</p>
<div class="highlight"><pre><span></span><code>$ python -V
Python <span class="m">3</span>.4.3
$ deactivate
$ python -V
Python <span class="m">2</span>.7.6
</code></pre></div>


<p>Coming into the project root and virtualenv later: <code>workon funcPy</code>.
Use <tab> key to autocomplete after <code>workon</code>.</p>
<p>If using the default Python version (in Ubuntu 14.04 it is 2.7)
for your virtual environment, create the project with <code>mkproject funcPy</code>.</p>
<p>To debug this project in PyCharm, open the project in PyCharm
(get the project root folder with <code>workon funcPy &amp;&amp; echo $PWD</code>).
In [File -&gt; Settings -&gt; Project: funcPy -&gt; Project Interpreter],
press the gear button on the right side of "Project Interpreter",
choose "Add Local", select the python executable in the corresponding 
virtualenv folder (get it with <code>cdvirtualenv &amp;&amp; echo $PWD/bin/python</code>).</p>
<p>The python intepreter config is persisted in PyCharm project configuration,
so no need to use <code>workon</code> every time open the project in PyCharm.</p>
<p>See
<a href="http://bit.ly/23b30fY">Adding Existing Virtual Environment in PyCharm 2016.1 Help</a>
for reference.</p>
<p>Note:</p>
<p>If the script has command line arguments,
add them in [Run -&gt; Edit Configurations -&gt; Script parameters].</p>
<h3>For existing project</h3>
<div class="highlight"><pre><span></span><code><span class="err">git clone git@github.com:mbr/flask-bootstrap.git</span>
<span class="err">cd flask-bootstrap</span>
<span class="err">mkvirtualenv flask-bootstrap</span>
<span class="err">setvirtualenvproject</span>
<span class="err">cd sample_app</span>
<span class="err">pip install -r requirements.txt</span>
<span class="err">mkvirtualenv testenv2</span>
<span class="err">setvirtualenvproject</span>
</code></pre></div>


<p>Now there are 2 virtualenvs: flask-bootstrap and testenv2 are associated with
project flask-bootstrap.
If you input <code>workon</code> and press TAB, you can see both these 2 virtualenvs.
No matter which one you choose, you will be transmitted to the root folder of
project flask-bootstrap.</p>
<p>Note: use <code>rmvirtualenv testenv2</code> to remove a virtualenv.</p>
<h2>Discussion</h2>
<p>There are two concepts in virturalenvwrapper.
One is "virtual environment", which has its own python executables.
The other is "project", where your source codes resides.
They are n-to-1 relationship.
If you specify a project-virtualenv relation with
<code>setvirtualenvproject path-to-project-A path-to-env-X</code>,
while the virtualenv X already has associated to project B,
the new project A will replace the old project B.</p>
<p>Why not use the same folder for both project and environment, like npm?</p>
<p>Reason 1: 
A project can associate with many virtualenvs (through <code>setvirtualenvproject</code>),
so for example you can test your application under Python 2 and 3
in difference virtual environments.</p>
<p>Reason 2:
Unlike the "node_modules" folder in a node.js project,
Python project can't put packages directly into the source folder.
Use <code>pip install the-package &amp;&amp; pip freeze &gt; requirements.txt</code> to install
a package and save it into dependency document,
like <code>npm install the-package --save</code>.
Activate you virtual env and use <code>pip install -r requirements.txt</code>
to install all dependencies into the virtual environment.</p>
<p>"mkvirtualenv env1" will create a new "virtual environment" in $WORKON_HOME,
regardless your CWD.</p>
<p>"mkproject proj1" will create both a "virtual environment" named "proj1"
in $WORKON_HOME and a "proj1" folder in $PROJECT_HOME.
Then go to $PROJECT_HOME/proj1,
and activate the virtual environment proj1. So "mkproject proj1" equals to:</p>
<div class="highlight"><pre><span></span><code>$ mkvirtualenv proj1
$ mkdir <span class="nv">$PROJECT_HOME</span>/proj1
$ <span class="nb">cd</span> <span class="nv">$PROJECT_HOME</span>/proj1
$ workon proj1
</code></pre></div>


<p>Associate an existing virtualenv and an existing project with command</p>
<div class="highlight"><pre><span></span><code>$ setvirtualenvproject virtualenv_path project_path
</code></pre></div>


<p>Under the hood, virturalenvwrapper create a ".project" file under the root of
the virtualenv, in which is the project path.</p>
<p>List site packages:</p>
<div class="highlight"><pre><span></span><code>$ lssitepackages
</code></pre></div>


<p>Run a command in all virtualenvs under WORKON_HOME:</p>
<div class="highlight"><pre><span></span><code>$ allvirtualenv <span class="nb">command</span> with arguments
</code></pre></div>


<p>Change the current working directory to the site-packages of current virtualenv($VIRTUAL_ENV):</p>
<div class="highlight"><pre><span></span><code>$ cdsitepackages
</code></pre></div>


<p>Remove virtualenv:</p>
<div class="highlight"><pre><span></span><code>$ rmvirtualenv &lt;env_name&gt;
</code></pre></div>


<h2>Verification</h2>
<p>In a virtualenv, all python executables are in $WORKON_HOME.</p>
<div class="highlight"><pre><span></span><code><span class="err">[lichao@lichao480:~] </span>
<span class="err">$ workon </span>
<span class="err">env1 env2 proj1 </span>
<span class="err">[lichao@lichao480:~] </span>
<span class="err">$ which python </span>
<span class="err">/usr/bin/python </span>
<span class="err">[lichao@lichao480:~] </span>
<span class="err">$ workon env1 </span>
<span class="err">(env1)[lichao@lichao480:~] </span>
<span class="err">$ which python </span>
<span class="err">/home/lichao/apps/virenv_home/env1/bin/python </span>
<span class="err">(env1)[lichao@lichao480:~] </span>
<span class="err">$ workon env2 </span>
<span class="err">(env2)[lichao@lichao480:~PROJECT_HOME/proj2] </span>
<span class="err">$ which python </span>
<span class="err">/home/lichao/apps/virenv_home/env2/bin/python</span>
</code></pre></div>
            
            
            <hr/>
            <script src="https://utteranc.es/client.js"
                    repo="leetschau/leetschau.github.io"
                    issue-term="pathname"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>
            </script>
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2014-01-09T18:31:48+08:00">Jan 9, 2014</time>

<h4>Last Updated</h4>
<time datetime="2014-01-09T18:31:48+08:00">Jan 9, 2014</time>

            <h4>Category</h4>
            <a class="category-link" href="http://leetschau.github.io/categories.html#tech-ref">Tech</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://leetschau.github.io/tags.html#pycharm-ref">PyCharm
                    <span>1</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#virtualenv-ref">virtualenv
                    <span>4</span>
</a></li>
                <li><a href="http://leetschau.github.io/tags.html#virtualenvwrapper-ref">virtualenvwrapper
                    <span>1</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="#" title="My You can add links in your config file Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-you can add links in your config file sidebar-social-links"></i></a>
    <a href="#" title="My Another social link Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-another social link sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>